var path,base_cdn;path=window.location.href.split("/"),base_cdn=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_baseCdn\s*\=\s*([^;]*).*$)|^.*$/,"$1")),base_url=path[0]+"//"+path[2]+"/"+path[3];var montoMaxOperaciones,montoMinOperaciones,dobleAutenticacion,claveValida,claveC,montoComision,moneda,montoMasComision,saldo_imp;$(function(){function a(){var a;return $.each($("#tdestino").children(),function(o,t){a=o}),a+1}function o(){$(".dialogDestino").click(function(){$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#close").click(function(){$("#content-destino").dialog("close")})})}function t(){var a,o=0;return $.each($(".dinero"),function(t,e){a=$(e).val().replace(",","."),o+=parseFloat(a),o.toFixed(2)}),isNaN(o)&&(o=0),o}function e(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(a,o){$(o).removeClass("disabled-dashboard-item"),$.each($("#tdestino").children(":not(.obscure-group)"),function(a,t){$(t).find("#tarjetaDestino").val()==$(o).attr("card")&&$(o).addClass("disabled-dashboard-item")})})}function i(a){var o,t;return $.ajaxSetup({async:!1}),$.post(base_url+"/transferencia/operaciones",{clave:hex_md5(a)},function(a){rpta=$.parseJSON(a.response),t=$.parseJSON(a.transferir),0==rpta.rc?o=!0:(o=!1,t=!1)}),t}function n(){$.ajaxSetup({async:!1});var a;return $.post(base_url+"/transferencia/crearClave",function(o){0==o.rc?a=!0:(a=!1,$("#dialog-error-clave").dialog({title:"ContraseÃ±as no coinciden",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#invalido2").click(function(){$("#dialog-error-clave").dialog("close"),$(location).attr("href",base_url+"/transfer/index_tdc")}))}),a}function r(a){$.ajaxSetup({async:!1});var o;return $.post(base_url+"/transferencia/confirmacion",{clave:hex_md5(a)},function(a){0==a.rc?o=!0:(o=!1,$("#dialog-error-correo").dialog({title:"ContraseÃ±as no coinciden",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#invalido").click(function(){$("#dialog-error-correo").dialog("close")}))}),o}function s(a,o,t,e,i,n){var r,s;$.ajaxSetup({async:!1});var c={cuentaOrigen:a,cuentaDestino:o,monto:t,descripcion:e,tipoOpe:"P2C",idUsuario:i,id_afil_terceros:n};return $.ajax({url:base_url+"/transferencia/procesar",data:c,type:"post",dataType:"json",success:function(a){0==a.rc?(s=a.dataTransaccion.referencia,r=s,$("#continue_trans").prop("disabled",!1)):(r=!1,$("#continue_trans").prop("disabled",!1))}}),$.ajaxSetup({async:!0}),r}function c(a,o,t){1==a?($(o).find(".data-resultado").addClass("data-success"),$(o).find(".iconoTransferencia").removeClass("data-indicator icon-refresh icon-spin"),$(o).find(".iconoTransferencia").addClass("icon-ok-sign"),$(o).find("#estatus").empty(),$(o).find("#estatus").text("Transacción exitosa. Nro. Transacción: "+t)):($(o).find(".data-resultado").addClass("data-error"),$(o).find(".iconoTransferencia").removeClass("data-indicator data-indicator icon-refresh icon-spin"),$(o).find(".iconoTransferencia").addClass("icon-cancel-sign"),$(o).find("#estatus").empty(),$(o).find("#estatus").text("Transacción fallida."))}function l(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(a,o){montoMaxDiario==montoAcumDiario?($(o).addClass("disabled-dashboard-item"),alert("Para esta operacion usted supera el monto maximo diario de transferencias")):montoMaxMensual==montoAcumMensual&&($(o).addClass("disabled-dashboard-item"),alert("Para esta operacion usted supera el monto maximo diario de transferencias"))})}var d=$("#content").attr("confirmacion");"1"==d?($("#content-clave").hide(),$("#content_tdc").show()):$("#content-clave").show(),$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")}),$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")}),$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cerrar").click(function(){$("#content-product").dialog("close")}),$.each($(".dashboard-item"),function(a,o){$.post(base_url+"/dashboard/saldo",{tarjeta:$(o).attr("card")},function(a){var t=a.disponible;"string"!=typeof t&&(t="---"),$(o).find(".dashboard-item-balance").html(t)})});var a=$("#dashboard-donor");a.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:!0}});var o=$("#filters-stack .option-set"),t=o.find("a");t.click(function(){var o=$(this);if(o.hasClass("selected"))return!1;var t=o.parents(".option-set");t.find(".selected").removeClass("selected"),o.addClass("selected");var e={},i=t.attr("data-option-key"),n=o.attr("data-option-value");return n="false"!==n&&n,e[i]=n,"layoutMode"===i&&"function"==typeof changeLayoutMode?changeLayoutMode(o,e):a.isotope(e),!1})}),$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item"),$(this).parents("li").addClass("current-stack-item")}),$("#continuar_transfer").click(function(){var a=$("#transpwd").val();i(a)?($("#content-clave").hide(),$("#content_tdc").show()):($("#content_clave").show(),$.balloon.defaults.classname="field-error",$.balloon.defaults.css=null,$("#transpwd").showBalloon({position:"right",contents:"Clave inválida"}),setTimeout(function(){$("#transpwd").hideBalloon()},3e3))}),$(".dashboard-item").click(function(){var i,n,r,s,c,d,p,u;i=$(this).find("img").attr("src"),n=$(this).attr("card"),r=$(this).attr("marca"),s=$(this).attr("mascara"),c=$(this).attr("producto1"),d=$(this).attr("empresa"),u=$(this).attr("nombre"),moneda=$(this).attr("moneda"),pais=$(this).attr("pais"),$("#donor").children().remove(),p='<div class="product-presentation">',p+='<img src="'+i+'" width="200" height="130" alt="" />',p+='<div class="product-network '+r.toLowerCase()+'"></div>',p+='<input id="origin-cardnumber" name="donor-cardnumber" type="hidden" value="'+n+'" />',p+="</div>",p+='<div class="product-info">',p+='<p class="product-cardholder">'+u+"</p>",p+='<p class="product-cardnumber">'+s+"</p>",p+='<p class="product-metadata">'+c+"</p>",p+='<nav class="product-stack">',p+='<ul class="stack">',p+='<li class="stack-item">',p+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>',p+="</li>",p+="</ul>",p+="</nav>",p+="</div>",p+='<div class="product-scheme">',p+='<ul class="product-balance-group">',p+='<li>Disponible <span class="product-balance" id="balance-available" > '+moneda+" 0,00</span></li>",p+='<li>A debitar <span class="product-balance" id="balance-debit"> '+moneda+" 0,00</span></li>",p+="</ul>",p+="</div>",$("#donor").append(p),$.post(base_url+"/dashboard/saldo",{tarjeta:$(this).attr("card")},function(a){var o=a.disponible;"string"!=typeof o&&(o="---"),$("#balance-available").attr("saldo",o),$("#balance-available").html(moneda+o)}),$(".product-button").removeClass("disabled-button"),$("#agregarCuenta").attr("href","#"),$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item"),$.each($(".dashboard-item"),function(a,o){$(this).hasClass("current-dashboard-item")&&$(this).removeClass("current-dashboard-item")}),$(this).addClass("current-dashboard-item"),$("#content-product").dialog("close"),$(".stack-item:not(.modifica)").click(function(){$("#tdestino").children(":not(#btn-destino)").remove(),$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}})}),$.post(base_url+"/transferencia/ctaDestino",{nroTarjeta:$(this).attr("card"),prefijo:$(this).attr("prefix"),operacion:"P2C"},function(i){if(i.rc==-150)$("#content_tdc").children().remove(),$("#tabs-menu").children().remove(),$("#content_tdc").append($("#content-no-afil").html()),$("#content-no-afil").children().remove();else{montoMaxOperaciones=i.parametrosTransferencias[0].montoMaxOperaciones,montoMinOperaciones=i.parametrosTransferencias[0].montoMinOperaciones,montoMaxDiario=i.parametrosTransferencias[0].montoMaxDiario,montoMaxSemanal=i.parametrosTransferencias[0].montoMaxSemanal,montoMaxMensual=i.parametrosTransferencias[0].montoMaxMensual,cantidadOperacionesDiarias=i.parametrosTransferencias[0].cantidadOperacionesDiarias,cantidadOperacionesSemanales=i.parametrosTransferencias[0].cantidadOperacionesSemanales,cantidadOperacionesMensual=i.parametrosTransferencias[0].cantidadOperacionesMensual,montoAcumDiario=i.parametrosTransferencias[0].montoAcumDiario,montoAcumSemanal=i.parametrosTransferencias[0].montoAcumSemanal,montoAcumMensual=i.parametrosTransferencias[0].montoAcumMensual,acumCantidadOperacionesDiarias=i.parametrosTransferencias[0].acumCantidadOperacionesDiarias,acumCantidadOperacionesSemanales=i.parametrosTransferencias[0].acumCantidadOperacionesSemanales,acumCantidadOperacionesMensual=i.parametrosTransferencias[0].acumCantidadOperacionesMensual,dobleAutenticacion=i.parametrosTransferencias[0].dobleAutenticacion,montoComision=i.parametrosTransferencias[0].montoComision,$("#dashboard-beneficiary").empty();$.each(i.tarjetaDestinoTercero,function(a,o){var t,e=Math.floor(5*Math.random())+1,i="card-"+e;t="<li class='dashboard-item muestraDestino' card='"+o.noCuenta+"' marca='"+o.marca+"' nombre='"+o.beneficiario+"' comision='"+montoComision+"' mascara='"+o.noCuentaConMascara+"' banco ='"+o.banco+"' id_afiliacion='"+o.id_afiliacion+"'>",t+="<a rel='section'>",t+="<img src='"+base_cdn+"/img/products/default/"+i+".png' width='200' height='130' alt='' />",t+="<div class=''></div>",t+="<div class='dashboard-item-info'>",t+="<p class='dashboard-item-cardholder'>"+o.beneficiario+"</p>",t+="<p class='dashboard-item-cardnumber'>"+o.noCuentaConMascara+"</p>",t+="<p class='dashboard-item-category'>"+o.banco+"</p>",t+="</div>",t+=" </a>",t+="</li>",$("#dashboard-beneficiary").append(t)})}$(".muestraDestino").click(function(){if(1==$(this).hasClass("disabled-dashboard-item"))$("#content-destino").dialog("close");else{var i,n,r,s,c,l,d;i=$(this).find("img").attr("src"),n=$(this).attr("card"),s=$(this).attr("mascara"),r=$(this).attr("marca"),c=$(this).attr("banco"),d=$(this).attr("nombre"),id_afil=$(this).attr("id_afiliacion"),banco=$(this).attr("banco"),comision=$(this).attr("comision"),$(".edit").remove();var p=a();l='<div class="group"> ',l+='<div class="product-presentation">',l+='<img src="'+i+'" width="200" height="130" alt="" />',l+='<div class=""></div>',l+='<input id="tarjetaDestino" class="tarjetaDestino" id="donor-cardnumber" name="donor-cardnumber" type="hidden" value="'+n+'" />',l+='<input class="id_afiliacion" name="id_afil" type="hidden" value="'+id_afil+'" />',l+='<input class="banco" name="id_afil" type="hidden" value="'+banco+'" /> <input class="comision" name="comision" type="hidden" value="'+comision+'" />',l+="</div>",l+='<div class="product-info">',l+='<p class="product-cardholder">'+d+"</p>",l+='<p class="product-cardnumber">'+s+"</p>",l+='<p class="product-metadata">'+c+"</p>",l+='<nav class="product-stack">',l+='<ul class="stack">',l+='<li class="stack-item modifica">',l+='<a rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>',l+="</li>",l+='<li class="stack-item elimina">',l+='<a rel="section" title="Remover"><span aria-hidden="true" class="icon-cancel"></span></a>',l+="</li>",l+="</ul>",l+="</nav>",l+="</div>",l+='<div class="product-scheme">',l+='<fieldset class="form-inline">',l+='<label for="beneficiary-1x-description" title="Descripción del pago.">Concepto</label>',l+='<input class="field-large" id="beneficiary-'+p+'x-description" maxlength="60" name="beneficiary-'+p+'x-description" type="text"/>',l+='<label for="beneficiary-1x-amount" title="Monto a transferir.">Importe</label>',l+='<div class="field-category"> '+moneda+" ",l+='<input id="beneficiary-1x-coin" name="beneficiary-1x-coin" type="hidden" value="'+moneda+'" />',l+="</div>",l+='<input class="field-small monto dinero" id="beneficiary-'+p+'x-amount" maxlength="12"  name="beneficiary-'+p+'x-amount" type="text" />',l+="</fieldset></div></div>",$("#content_tdc #tdestino").append(l),$("#beneficiary-1x").removeClass("obscure-group"),$("#content-destino").dialog("close"),$("#tdestino").children("#btn-destino").remove(),$("#tdestino").append($("#removerDestino").html()),e();var u=$(".monto").val().replace(",",".");$("#content_tdc").on("keyup",".monto",function(){var a=$(this).val();"Pe"!=pais&&"Usd"!=pais||(expr=/^-?[0-9]+([\.][0-9]{0,2})?$/,saldo_imp=$("#balance-available").attr("saldo").replace(",","")),"Ve"!=pais&&"Co"!=pais||(expr=/^-?[0-9]+([\,][0-9]{0,2})?$/,saldo_imp1=$("#balance-available").attr("saldo").replace(".",""),saldo_imp=saldo_imp1.replace(",",".")),expr.test(a)||("Pe"!=pais&&"Usd"!=pais||($("#dialog-error-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido").click(function(){$("#dialog-error-monto").dialog("close")})),"Ve"!=pais&&"Co"!=pais||($("#dialog-error-monto-vc").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido_vc").click(function(){$("#dialog-error-monto-vc").dialog("close")})),$(this).val("")),u=$(this).val().replace(",","."),parseFloat(u)>saldo_imp&&($("#dialog-max-monto1").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_inv").click(function(){$("#dialog-max-monto1").dialog("close")}),$(this).val("")),parseFloat(u)>parseFloat(montoMaxOperaciones)&&($("#dialog-max-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido1").click(function(){$("#dialog-max-monto").dialog("close")}),$(this).val("")),parseFloat($(this).val())+parseFloat(montoAcumDiario)>parseFloat(montoMaxDiario)?($("#dialog-min-monto2").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido3").click(function(){$("#dialog-min-monto2").dialog("close")}),$(this).val(""),$("#balance-debit").html(m+t().toFixed(2))):parseFloat(u)+parseFloat(montoAcumMensual)>parseFloat(montoMaxMensual)?($("#dialog-min-monto3").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido4").click(function(){$("#dialog-min-monto3").dialog("close")}),$(this).val(""),$("#balance-debit").html(m+t().toFixed(2))):(m=$(".dashboard-item").attr("moneda"),$(this).parents(".group").attr("montInput",$(this).val()),$(this).val().replace(",","."),$("#balance-debit").html(m+t().toFixed(2)))}),a()>=4&&$("#tdestino").children("#btn-destino").remove(),a()>1?$("#continuar").removeAttr("disabled"):$("#continuar").attr("disabled",""),o()}}),$("#content_tdc").on("click",".modifica",function(){$(this).parents(".group").addClass("edit"),$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",beforeClose:function(a,o){$(".group").removeClass("edit")},open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}})}),$("#content_tdc").on("click",".elimina",function(){m=$(".dashboard-item").attr("moneda"),suma=t(),montoRestar=parseFloat($(this).parents(".group").attr("montInput")),saldo=suma-montoRestar,saldo<0?$("#balance-debit").html(m+0):$("#balance-debit").html(m+saldo),$(this).parents(".group").remove(),e(),0==$("#tdestino").find("#btn-destino").length&&$("#tdestino").append($("#removerDestino").html()),a()>=1?$("#continuar").removeAttr("disabled"):$("#continuar").attr("disabled","")}),l()}),o()}),$("#continuar").click(function(){var a=!0,o=0;$("#montoTotal").remove(),$("#tdestino").append("<input id='montoTotal' name='montoTotal' type='hidden' class='checkTotal' value='' />"),$("#montoTotal").val(t()),$("#validate").submit(),total=t(),saldo=saldo_imp,valor_concepto1=$("#beneficiary-1x-description").val(),valor_concepto2=$("#beneficiary-2x-description").val(),valor_concepto3=$("#beneficiary-3x-description").val(),""!=valor_concepto1&&""!=valor_concepto2&&""!=valor_concepto3||($("#campos_vacios").dialog({title:"Error Campos",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_campos").click(function(){$("#campos_vacios").dialog("close")}),a=!1),parseFloat(total)+parseFloat(montoComision)>saldo&&($("#dialog-error-monto9").dialog({title:"Error Monto",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto9").click(function(){$("#dialog-error-monto9").dialog("close")}),a=!1),parseFloat(acumCantidadOperacionesDiarias)+parseFloat(o)>=parseFloat(cantidadOperacionesDiarias)?($("#dialog-cant-ope1").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cant_ope1").click(function(){$("#dialog-cant-ope1").dialog("close")}),a=!1):parseFloat(acumCantidadOperacionesSemanales)+parseFloat(o)>=parseFloat(cantidadOperacionesSemanales)?($("#dialog-cant-ope-sm").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cant_ope_sm").click(function(){$("#dialog-cant-ope-sm").dialog("close")}),a=!1):parseFloat(acumCantidadOperacionesMensual)+parseFloat(o)>parseFloat(cantidadOperacionesMensual)&&($("#dialog-cant-ope2").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cant_ope2").click(function(){$("#dialog-cant-ope2").dialog("close")}),a=!1),valor_monto1=$("#beneficiary-1x-amount").val(),valor_monto2=$("#beneficiary-2x-amount").val(),valor_monto3=$("#beneficiary-3x-amount").val(),(parseFloat(valor_monto1)<parseFloat(montoMinOperaciones)||parseFloat(valor_monto2)<parseFloat(montoMinOperaciones)||parseFloat(valor_monto3)<parseFloat(montoMinOperaciones))&&($("#dialog-min-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido2").click(function(){$("#dialog-min-monto").dialog("close")}),$(this).val(""),a=!1),parseFloat(total)+parseFloat(montoComision)+parseFloat(montoComision)>parseFloat(montoMaxOperaciones)&&($("#dialog-error-monto1").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto1").click(function(){$("#dialog-error-monto1").dialog("close")}),a=!1),parseFloat(total)<=0&&($("#dialog-error-monto2").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto2").click(function(){$("#dialog-error-monto2").dialog("close")}),a=!1),parseFloat(total)+parseFloat(montoAcumDiario)>parseFloat(montoMaxDiario)?($("#dialog-error-monto7").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto7").click(function(){$("#dialog-error-monto7").dialog("close")}),a=!1):parseFloat(total)+parseFloat(montoAcumSemanal)>parseFloat(montoMaxSemanal)?($("#dialog-error-monto-sm").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto_sm").click(function(){$("#dialog-error-monto-sm").dialog("close")}),a=!1):parseFloat(total)+parseFloat(montoAcumMensual)>parseFloat(montoMaxMensual)&&($("#dialog-error-monto8").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto8").click(function(){$("#dialog-error-monto8").dialog("close")}),a=!1);parseFloat(valor_monto1)+parseFloat(valor_monto2)+parseFloat(valor_monto3);if(1==a){var e,i,n,r,s,i,n,c,l,r,d,m;i=$("#donor").find(".product-cardholder").html(),n=$("#donor").find(".product-cardnumber").html(),r=$("#donor").find(".product-metadata").html(),d=$("#origin-cardnumber").val(),m=$("#content").attr("idUsuario"),comision=$("#tdestino").find(".comision").val(),e='<tr id="trorigen" card="'+d+'" idUsuario="'+m+'">',e+='<td class="data-label"><label>Cuenta Origen</label></td>',e+='<td class="data-reference" colspan="2" id="nombreOrigenTransfer">'+i+'<br /><span class="highlight">'+n+'</span><br /><span class="lighten">'+r+"</span></td>",e+="</tr>",$("#tbody").append(e),s='<td class="data-label"><label>Cuentas Destino</label></td>',$("#tbody").append(s);var o=0;$.each($("#tdestino").children(":not(.obscure-group, .checkTotal)"),function(a,e){if(i=$(e).find(".product-cardholder").html(),n=$(e).find(".product-cardnumber").html(),r=$(e).find(".product-metadata").html(),c=$("#beneficiary-"+(a+1)+"x-amount").val(),l=$("#beneficiary-"+(a+1)+"x-description").val(),ctnDestino=$(e).find(".tarjetaDestino").val(),id_afil=$(e).find(".id_afiliacion").val(),banco=$(e).find(".banco").val(),o+=1,suma=t(),montoT=suma,"Ve"==pais||"Co"==pais){var s=$(".product-scheme").find("#balance-debit").html().replace(/Bs./g,"");total1=s.replace(".",",")}else{var s=$(".product-scheme").find("#balance-debit").html().replace(/S./g,"");total1=s}monto_t=total1.replace(",","."),destino='<tr class="trdestino" card="'+ctnDestino+'" id_afil="'+id_afil+'" monto="'+c+'" concepto="'+l+'" banco="'+banco+'" comision="'+comision+'">',destino+='<td class="data-label"> </td>',destino+='<td class="data-reference" id="nombreDestinoTransfer">'+i+'<br /><span class="highlight" id="mascaraDestinoTransfer">'+n+'</span><br /><span class="lighten" id="bancoDestinoTransfer">'+banco+"</span></td>",destino+='<td class="data-metadata data-resultado">',destino+='<div class="data-indicator">',destino+='<span aria-hidden="true" class="iconoTransferencia"></span>',destino+='</div><span class="data-metadata" id="conceptoDestino"><strong>Concepto: </strong>'+l+'<br /><strong>monto: </strong><span class="money-amount" monto="'+c+'" id="montoDestinoTransfer">'+moneda+" "+c+'</span><br /><strong>Estatus: </strong><span class="money-amount" id="estatus">En espera por confirmación.</span></td>',destino+="</td>",destino+="</tr>",destino+="<tr>",destino+='<td class="data-spacing" colspan="3"></td>',destino+="</tr>",$("#tbody").append(destino)}),comision=parseFloat(comision)*o,montoT=suma+comision,montoT=montoT.toString(),montoT=montoT.replace(".",","),montoMasComision=montoT,completar="<tr>",completar+='<td class="data-spacing" colspan="3"></td>',completar+="</tr>",completar+="<tr>",completar+='<td colspan="2"></td>',completar+='<td class="data-metadata">Total+Comisión ('+moneda+" "+comision+')<br /><span class="money-amount">'+moneda+" "+montoT+"</span></td>",completar+="</tr>",$("#tbody").append(completar),$("#content-transfer-P2C").children().remove(),$("#content-transfer-P2C").append($("#confirm-transfer").html()),$("#confirm-transfer").remove()}}),$("#content_tdc").on("click","#continue_trans",function(){if($("#continue_trans").prop("disabled",!0),"S"==dobleAutenticacion)n()&&$("#dialog-confirm").dialog({modal:!0,title:"Verificación requerida.",buttons:{Cancelar:function(){$(this).dialog("close")},Aceptar:function(){var a=$("#transpwd_confirmacion").val();if(r(a)){$("#dialog-confirm").dialog("close");var o,t,e,i,n,l=$("#trorigen").attr("card"),d=$("#trorigen").attr("idUsuario");$(".data-indicator").show(),$.each($(".trdestino"),function(a,r){if(o=$(r).attr("card"),t=$(r).attr("id_afil"),e=$(r).attr("monto").replace(",","."),i=$(r).attr("concepto"),comision=$(r).attr("comision"),transferencia=s(l,o,e,i,d,t),0!=transferencia){n=!0,c(n,r,transferencia);var m;nombre=$("#nombreOrigenTransfer").html(),mascara=$("#mascaraOrigenTransfer").html();var p=new Date;hora=p.getHours()+":"+p.getMinutes()+":"+p.getSeconds();var u=p.getDate(),f=p.getMonth()+1;p.getFullYear();u<10&&(u="0"+u),f<10&&(f="0"+f);m="<tr>",m+='<td class="data-label"><label>Cuenta Origen</label></td>',m+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>",m+="</tr>",$("#bodyConfirm").append(m),$("#progress").children().remove(),cabecera="<ul class='steps'>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>",cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>",cabecera+="</ul>",$("#progress").append(cabecera).html(),$("#titulo").children().remove(),titulo="<h2>Finalización</h2>",$("#titulo").append(titulo).html();var h;h="<tr>",h+='<td colspan="2"></td>',h+='<td class="data-metadata">',h+='Total: <span class="lighten"> ('+moneda+" "+comision+' Comisión) </span> <br /><span class="money-amount"> '+moneda+" "+montoMasComision+" </span>",h+="</td>",h+="</tr>",$("#bodyConfirm").append(h).html(),$("#confimacion_t").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_t").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else n=!1,trans="-",c(n,r,transferencia),$("#confimacion_t").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_t").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})})}}},open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}});else{var a,o,t,e,i,l=$("#trorigen").attr("card"),d=$("#trorigen").attr("idUsuario");$(".data-indicator").show(),$.each($(".trdestino"),function(n,r){if(a=$(r).attr("card"),o=$(r).attr("id_afil"),t=$(r).attr("monto").replace(",","."),e=$(r).attr("concepto"),comision=$(r).attr("comision"),transferencia=s(l,a,t,e,d,o),0!=transferencia){i=!0,c(i,r,transferencia);var m;nombre=$("#nombreOrigenTransfer").html(),mascara=$("#mascaraOrigenTransfer").html();var p=new Date;hora=p.getHours()+":"+p.getMinutes()+":"+p.getSeconds();var u=p.getDate(),f=p.getMonth()+1;p.getFullYear();u<10&&(u="0"+u),f<10&&(f="0"+f);m="<tr>",m+='<td class="data-label"><label>Cuenta Origen</label></td>',m+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>",m+="</tr>",$("#progress").children().remove(),cabecera="<ul class='steps'>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>",cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>",cabecera+="</ul>",$("#progress").append(cabecera).html(),$("#titulo").children().remove(),titulo="<h2>Finalización</h2>",$("#titulo").append(titulo).html(),$("#confimacion_t").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_t").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else i=!1,trans="-",c(i,r,transferencia),$("#confimacion_t").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_t").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})})}}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});