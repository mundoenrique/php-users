var path,base_cdn;path=window.location.href.split("/");base_cdn=path[0]+"//"+path[2].replace("online","cdn")+"/"+path[3];base_url=path[0]+"//"+path[2]+"/"+path[3];var montoMaxOperaciones,montoMinOperaciones,dobleAutenticacion,claveValida,claveC,montoComision,moneda,montoMasComision,saldo_imp;$(function(){var e=$("#content").attr("confirmacion");if(e=="1"){$("#content-clave").hide();$("#content_tdc").show()}else{$("#content-clave").show()}$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")});$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")});$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(p,q){$(".ui-dialog-titlebar-close",q.dialog).hide()}});$("#cerrar").click(function(){$("#content-product").dialog("close")});$.each($(".dashboard-item"),function(q,p){$.post(base_url+"/dashboard/saldo",{tarjeta:$(p).attr("card")},function(s){var r=s.disponible;if(typeof r!="string"){r="---"}$(p).find(".dashboard-item-balance").html(r)})});var n=$("#dashboard-donor");n.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:true}});var l=$("#filters-stack .option-set"),o=l.find("a");o.click(function(){var t=$(this);if(t.hasClass("selected")){return false}var r=t.parents(".option-set");r.find(".selected").removeClass("selected");t.addClass("selected");var p={},q=r.attr("data-option-key"),s=t.attr("data-option-value");s=s==="false"?false:s;p[q]=s;if(q==="layoutMode"&&typeof changeLayoutMode==="function"){changeLayoutMode(t,p)}else{n.isotope(p)}return false})});$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item");$(this).parents("li").addClass("current-stack-item")});$("#continuar_transfer").click(function(){var l=$("#transpwd").val();if((i(l))){$("#content-clave").hide();$("#content_tdc").show()}else{$("#content_clave").show();$.balloon.defaults.classname="field-error";$.balloon.defaults.css=null;$("#transpwd").showBalloon({position:"right",contents:"Clave inválida"});setTimeout(function(){$("#transpwd").hideBalloon()},3000)}});$(".dashboard-item").click(function(){var o,t,r,q,l,p,n,s;o=$(this).find("img").attr("src");t=$(this).attr("card");r=$(this).attr("marca");q=$(this).attr("mascara");l=$(this).attr("producto1");p=$(this).attr("empresa");s=$(this).attr("nombre");moneda=$(this).attr("moneda");pais=$(this).attr("pais");$("#donor").children().remove();n='<div class="product-presentation">';n+='<img src="'+o+'" width="200" height="130" alt="" />';n+='<div class="product-network '+r.toLowerCase()+'"></div>';n+='<input id="origin-cardnumber" name="donor-cardnumber" type="hidden" value="'+t+'" />';n+="</div>";n+='<div class="product-info">';n+='<p class="product-cardholder">'+s+"</p>";n+='<p class="product-cardnumber">'+q+"</p>";n+='<p class="product-metadata">'+l+"</p>";n+='<nav class="product-stack">';n+='<ul class="stack">';n+='<li class="stack-item">';n+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';n+="</li>";n+="</ul>";n+="</nav>";n+="</div>";n+='<div class="product-scheme">';n+='<ul class="product-balance-group">';n+='<li>Disponible <span class="product-balance" id="balance-available" > '+moneda+" 0,00</span></li>";n+='<li>A debitar <span class="product-balance" id="balance-debit"> '+moneda+" 0,00</span></li>";n+="</ul>";n+="</div>";$("#donor").append(n);$.post(base_url+"/dashboard/saldo",{tarjeta:$(this).attr("card")},function(v){var u=v.disponible;if(typeof u!="string"){u="---"}$("#balance-available").attr("saldo",u);$("#balance-available").html(moneda+u)});$(".product-button").removeClass("disabled-button");$("#agregarCuenta").attr("href","#");$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item");$.each($(".dashboard-item"),function(v,u){if($(this).hasClass("current-dashboard-item")){$(this).removeClass("current-dashboard-item")}});$(this).addClass("current-dashboard-item");$("#content-product").dialog("close");$(".stack-item:not(.modifica)").click(function(){$("#tdestino").children(":not(#btn-destino)").remove();$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(u,v){$(".ui-dialog-titlebar-close",v.dialog).hide()}})});$.post(base_url+"/transferencia/ctaDestino",{nroTarjeta:$(this).attr("card"),prefijo:$(this).attr("prefix"),operacion:"P2C"},function(v){if(v.rc==-150){$("#content_tdc").children().remove();$("#tabs-menu").children().remove();$("#content_tdc").append($("#content-no-afil").html());$("#content-no-afil").children().remove()}else{montoMaxOperaciones=v.parametrosTransferencias[0].montoMaxOperaciones;montoMinOperaciones=v.parametrosTransferencias[0].montoMinOperaciones;montoMaxDiario=v.parametrosTransferencias[0].montoMaxDiario;montoMaxSemanal=v.parametrosTransferencias[0].montoMaxSemanal;montoMaxMensual=v.parametrosTransferencias[0].montoMaxMensual;cantidadOperacionesDiarias=v.parametrosTransferencias[0].cantidadOperacionesDiarias;cantidadOperacionesSemanales=v.parametrosTransferencias[0].cantidadOperacionesSemanales;cantidadOperacionesMensual=v.parametrosTransferencias[0].cantidadOperacionesMensual;montoAcumDiario=v.parametrosTransferencias[0].montoAcumDiario;montoAcumSemanal=v.parametrosTransferencias[0].montoAcumSemanal;montoAcumMensual=v.parametrosTransferencias[0].montoAcumMensual;acumCantidadOperacionesDiarias=v.parametrosTransferencias[0].acumCantidadOperacionesDiarias;acumCantidadOperacionesSemanales=v.parametrosTransferencias[0].acumCantidadOperacionesSemanales;acumCantidadOperacionesMensual=v.parametrosTransferencias[0].acumCantidadOperacionesMensual;dobleAutenticacion=v.parametrosTransferencias[0].dobleAutenticacion;$("#dashboard-beneficiary").empty();var u;$.each(v.tarjetaDestinoTercero,function(A,z){var x=Math.floor(Math.random()*5)+1;var y="card-"+x;var w;w="<li class='dashboard-item muestraDestino' card='"+z.noCuenta+"' marca='"+z.marca+"' nombre='"+z.beneficiario+"' comision='"+montoComision+"' mascara='"+z.noCuentaConMascara+"' banco ='"+z.banco+"' id_afiliacion='"+z.id_afiliacion+"'>";w+="<a rel='section'>";w+="<img src='"+base_cdn+"/img/products/default/"+y+".png' width='200' height='130' alt='' />";w+="<div class=''></div>";w+="<div class='dashboard-item-info'>";w+="<p class='dashboard-item-cardholder'>"+z.beneficiario+"</p>";w+="<p class='dashboard-item-cardnumber'>"+z.noCuentaConMascara+"</p>";w+="<p class='dashboard-item-category'>"+z.banco+"</p>";w+="</div>";w+=" </a>";w+="</li>";$("#dashboard-beneficiary").append(w)})}$(".muestraDestino").click(function(){if($(this).hasClass("disabled-dashboard-item")==true){$("#content-destino").dialog("close")}else{var E,B,z,x,F,C,A,D;E=$(this).find("img").attr("src");B=$(this).attr("card");x=$(this).attr("mascara");z=$(this).attr("marca");F=$(this).attr("banco");D=$(this).attr("nombre");id_afil=$(this).attr("id_afiliacion");banco=$(this).attr("banco");comision=$(this).attr("comision");$(".edit").remove();var y=k();A='<div class="group"> ';A+='<div class="product-presentation">';A+='<img src="'+E+'" width="200" height="130" alt="" />';A+='<div class=""></div>';A+='<input id="tarjetaDestino" class="tarjetaDestino" id="donor-cardnumber" name="donor-cardnumber" type="hidden" value="'+B+'" />';A+='<input class="id_afiliacion" name="id_afil" type="hidden" value="'+id_afil+'" />';A+='<input class="banco" name="id_afil" type="hidden" value="'+banco+'" /> <input class="comision" name="comision" type="hidden" value="'+comision+'" />';A+="</div>";A+='<div class="product-info">';A+='<p class="product-cardholder">'+D+"</p>";A+='<p class="product-cardnumber">'+x+"</p>";A+='<p class="product-metadata">'+F+"</p>";A+='<nav class="product-stack">';A+='<ul class="stack">';A+='<li class="stack-item modifica">';A+='<a rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';A+="</li>";A+='<li class="stack-item elimina">';A+='<a rel="section" title="Remover"><span aria-hidden="true" class="icon-cancel"></span></a>';A+="</li>";A+="</ul>";A+="</nav>";A+="</div>";A+='<div class="product-scheme">';A+='<fieldset class="form-inline">';A+='<label for="beneficiary-1x-description" title="DescripciÃ³n de la transferencia.">Concepto</label>';A+='<input class="field-large" id="beneficiary-'+y+'x-description" maxlength="60" name="beneficiary-'+y+'x-description" type="text" />';A+='<label for="beneficiary-1x-amount" title="Monto a transferir.">Importe</label>';A+='<div class="field-category"> '+moneda+" ";A+='<input id="beneficiary-1x-coin" name="beneficiary-1x-coin" type="hidden" value="'+moneda+'" />';A+="</div>";A+='<input class="field-small monto dinero" id="beneficiary-'+y+'x-amount" maxlength="12"  name="beneficiary-'+y+'x-amount" type="text" />';A+="</fieldset></div></div>";$("#content_tdc #tdestino").append(A);$("#beneficiary-1x").removeClass("obscure-group");$("#content-destino").dialog("close");$("#tdestino").children("#btn-destino").remove();$("#tdestino").append($("#removerDestino").html());g();var w=$(".monto").val().replace(",",".");$("#content_tdc").on("keyup",".monto",function(){var G=$(this).val();if((pais=="Pe")||(pais=="Usd")){expr=/^-?[0-9]+([\.][0-9]{0,2})?$/;saldo_imp=$("#balance-available").attr("saldo").replace(",","")}if((pais=="Ve")||(pais=="Co")){expr=/^-?[0-9]+([\,][0-9]{0,2})?$/;saldo_imp1=$("#balance-available").attr("saldo").replace(".","");saldo_imp=saldo_imp1.replace(",",".")}if(!expr.test(G)){if((pais=="Pe")||(pais=="Usd")){$("#dialog-error-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(H,I){$(".ui-dialog-titlebar-close",I.dialog).hide()}});$("#monto_invalido").click(function(){$("#dialog-error-monto").dialog("close")})}if((pais=="Ve")||(pais=="Co")){$("#dialog-error-monto-vc").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(H,I){$(".ui-dialog-titlebar-close",I.dialog).hide()}});$("#monto_invalido_vc").click(function(){$("#dialog-error-monto-vc").dialog("close")})}$(this).val("")}w=$(this).val().replace(",",".");if((parseFloat(w))>saldo_imp){$("#dialog-max-monto1").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(H,I){$(".ui-dialog-titlebar-close",I.dialog).hide()}});$("#monto_inv").click(function(){$("#dialog-max-monto1").dialog("close")});$(this).val("")}if((parseFloat(w))>parseFloat(montoMaxOperaciones)){$("#dialog-max-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(H,I){$(".ui-dialog-titlebar-close",I.dialog).hide()}});$("#monto_invalido1").click(function(){$("#dialog-max-monto").dialog("close")});$(this).val("")}if((parseFloat($(this).val())+parseFloat(montoAcumDiario))>parseFloat(montoMaxDiario)){$("#dialog-min-monto2").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(H,I){$(".ui-dialog-titlebar-close",I.dialog).hide()}});$("#monto_invalido3").click(function(){$("#dialog-min-monto2").dialog("close")});$(this).val("");$("#balance-debit").html(m+d().toFixed(2))}else{if((parseFloat(w)+parseFloat(montoAcumMensual))>parseFloat(montoMaxMensual)){$("#dialog-min-monto3").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(H,I){$(".ui-dialog-titlebar-close",I.dialog).hide()}});$("#monto_invalido4").click(function(){$("#dialog-min-monto3").dialog("close")});$(this).val("");$("#balance-debit").html(m+d().toFixed(2))}else{m=$(".dashboard-item").attr("moneda");$(this).parents(".group").attr("montInput",$(this).val());$(this).val().replace(",",".");$("#balance-debit").html(m+d().toFixed(2))}}});if(k()>=4){$("#tdestino").children("#btn-destino").remove()}if(k()>1){$("#continuar").removeAttr("disabled")}else{$("#continuar").attr("disabled","")}c()}});$("#content_tdc").on("click",".modifica",function(){$(this).parents(".group").addClass("edit");$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",beforeClose:function(w,x){$(".group").removeClass("edit")},open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}})});$("#content_tdc").on("click",".elimina",function(){m=$(".dashboard-item").attr("moneda");suma=d();montoRestar=parseFloat($(this).parents(".group").attr("montInput"));saldo=suma-montoRestar;if(saldo<0){$("#balance-debit").html(m+0)}else{$("#balance-debit").html(m+saldo)}$(this).parents(".group").remove();g();if($("#tdestino").find("#btn-destino").length==0){$("#tdestino").append($("#removerDestino").html())}if(k()>=1){$("#continuar").removeAttr("disabled")}else{$("#continuar").attr("disabled","")}});b()});c()});$("#continuar").click(function(){var q=true;var w=0;$("#montoTotal").remove();$("#tdestino").append("<input id='montoTotal' name='montoTotal' type='hidden' class='checkTotal' value='' />");$("#montoTotal").val(d());$("#validate").submit();total=d();saldo=saldo_imp;valor_concepto1=$("#beneficiary-1x-description").val();valor_concepto2=$("#beneficiary-2x-description").val();valor_concepto3=$("#beneficiary-3x-description").val();if((valor_concepto1=="")||(valor_concepto2=="")||(valor_concepto3=="")){$("#campos_vacios").dialog({title:"Error Campos",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#error_campos").click(function(){$("#campos_vacios").dialog("close")});q=false}if((parseFloat(total)+parseFloat(montoComision))>saldo){$("#dialog-error-monto9").dialog({title:"Error Monto",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#error_monto9").click(function(){$("#dialog-error-monto9").dialog("close")});q=false}if(parseFloat(acumCantidadOperacionesDiarias)+parseFloat(w)>=parseFloat(cantidadOperacionesDiarias)){$("#dialog-cant-ope1").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#cant_ope1").click(function(){$("#dialog-cant-ope1").dialog("close")});q=false}else{if(parseFloat(acumCantidadOperacionesSemanales)+parseFloat(w)>=parseFloat(cantidadOperacionesSemanales)){$("#dialog-cant-ope-sm").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#cant_ope_sm").click(function(){$("#dialog-cant-ope-sm").dialog("close")});q=false}else{if(parseFloat(acumCantidadOperacionesMensual)+parseFloat(w)>parseFloat(cantidadOperacionesMensual)){$("#dialog-cant-ope2").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#cant_ope2").click(function(){$("#dialog-cant-ope2").dialog("close")});q=false}}}valor_monto1=$("#beneficiary-1x-amount").val();valor_monto2=$("#beneficiary-2x-amount").val();valor_monto3=$("#beneficiary-3x-amount").val();if((parseFloat(valor_monto1)<parseFloat(montoMinOperaciones))||(parseFloat(valor_monto2)<parseFloat(montoMinOperaciones))||(parseFloat(valor_monto3)<parseFloat(montoMinOperaciones))){$("#dialog-min-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#monto_invalido2").click(function(){$("#dialog-min-monto").dialog("close")});$(this).val("");q=false}if((parseFloat(total)+parseFloat(montoComision)+parseFloat(montoComision))>parseFloat(montoMaxOperaciones)){$("#dialog-error-monto1").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#error_monto1").click(function(){$("#dialog-error-monto1").dialog("close")});q=false}if(parseFloat(total)<=0){$("#dialog-error-monto2").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#error_monto2").click(function(){$("#dialog-error-monto2").dialog("close")});q=false}if((parseFloat(total)+parseFloat(montoAcumDiario))>parseFloat(montoMaxDiario)){$("#dialog-error-monto7").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#error_monto7").click(function(){$("#dialog-error-monto7").dialog("close")});q=false}else{if((parseFloat(total)+parseFloat(montoAcumSemanal))>parseFloat(montoMaxSemanal)){$("#dialog-error-monto-sm").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#error_monto_sm").click(function(){$("#dialog-error-monto-sm").dialog("close")});q=false}else{if((parseFloat(total)+parseFloat(montoAcumMensual))>parseFloat(montoMaxMensual)){$("#dialog-error-monto8").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(A,B){$(".ui-dialog-titlebar-close",B.dialog).hide()}});$("#error_monto8").click(function(){$("#dialog-error-monto8").dialog("close")});q=false}}}var s=parseFloat(valor_monto1)+parseFloat(valor_monto2)+parseFloat(valor_monto3);if(q==true){var l,y,o,z,v,u,r,y,o,n,p,z,t,x;y=$("#donor").find(".product-cardholder").html();o=$("#donor").find(".product-cardnumber").html();z=$("#donor").find(".product-metadata").html();t=$("#origin-cardnumber").val();x=$("#content").attr("idUsuario");comision=$("#tdestino").find(".comision").val();l='<tr id="trorigen" card="'+t+'" idUsuario="'+x+'">';l+='<td class="data-label"><label>Cuenta Origen</label></td>';l+='<td class="data-reference" colspan="2" id="nombreOrigenTransfer">'+y+'<br /><span class="highlight">'+o+'</span><br /><span class="lighten">'+z+"</span></td>";l+="</tr>";$("#tbody").append(l);v='<td class="data-label"><label>Cuentas Destino</label></td>';$("#tbody").append(v);var w=0;$.each($("#tdestino").children(":not(.obscure-group, .checkTotal)"),function(C,B){y=$(B).find(".product-cardholder").html();o=$(B).find(".product-cardnumber").html();z=$(B).find(".product-metadata").html();n=$("#beneficiary-"+(C+1)+"x-amount").val();p=$("#beneficiary-"+(C+1)+"x-description").val();ctnDestino=$(B).find(".tarjetaDestino").val();id_afil=$(B).find(".id_afiliacion").val();banco=$(B).find(".banco").val();w=w+1;suma=d();montoT=suma;if((pais=="Ve")||(pais=="Co")){var A=$(".product-scheme").find("#balance-debit").html().replace(/Bs./g,"");total1=A.replace(".",",")}else{var A=$(".product-scheme").find("#balance-debit").html().replace(/S./g,"");total1=A}monto_t=total1.replace(",",".");destino='<tr class="trdestino" card="'+ctnDestino+'" id_afil="'+id_afil+'" monto="'+n+'" concepto="'+p+'" banco="'+banco+'" comision="'+comision+'">';destino+='<td class="data-label"> </td>';destino+='<td class="data-reference" id="nombreDestinoTransfer">'+y+'<br /><span class="highlight" id="mascaraDestinoTransfer">'+o+'</span><br /><span class="lighten" id="bancoDestinoTransfer">'+banco+"</span></td>";destino+='<td class="data-metadata data-resultado">';destino+='<div class="data-indicator">';destino+='<span aria-hidden="true" class="iconoTransferencia"></span>';destino+='</div><span class="data-metadata" id="conceptoDestino"><strong>Concepto: </strong>'+p+'<br /><strong>monto: </strong><span class="money-amount" monto="'+n+'" id="montoDestinoTransfer">'+moneda+" "+n+'</span><br /><strong>Estatus: </strong><span class="money-amount" id="estatus">En espera por confirmación.</span></td>';destino+="</td>";destino+="</tr>";destino+="<tr>";destino+='<td class="data-spacing" colspan="3"></td>';destino+="</tr>";$("#tbody").append(destino)});comision=parseFloat(comision)*w;montoT=suma+comision;montoT=montoT.toString();montoT=montoT.replace(".",",");montoMasComision=montoT;completar="<tr>";completar+='<td class="data-spacing" colspan="3"></td>';completar+="</tr>";completar+="<tr>";completar+='<td colspan="2"></td>';completar+='<td class="data-metadata">Total+Comisión ('+moneda+" "+comision+')<br /><span class="money-amount">'+moneda+" "+montoT+"</span></td>";completar+="</tr>";$("#tbody").append(completar);$("#content-transfer-P2C").children().remove();$("#content-transfer-P2C").append($("#confirm-transfer").html());$("#confirm-transfer").remove()}});$("#content_tdc").on("click","#continue_trans",function(){$("#continue_trans").prop("disabled",true);if(dobleAutenticacion=="S"){if(j()){$("#dialog-confirm").dialog({modal:true,title:"Verificación requerida.",buttons:{Cancelar:function(){$(this).dialog("close")},Aceptar:function(){var u=$("#transpwd_confirmacion").val();if(h(u)){$("#dialog-confirm").dialog("close");var x=$("#trorigen").attr("card");var y=$("#trorigen").attr("idUsuario");var A,t,v,w,z;$(".data-indicator").show();$.each($(".trdestino"),function(H,K){A=$(K).attr("card");t=$(K).attr("id_afil");v=$(K).attr("monto").replace(",",".");w=$(K).attr("concepto");comision=$(K).attr("comision");transferencia=f(x,A,v,w,y,t);if(transferencia!=false){z=true;a(z,K,transferencia);var C,D;nombre=$("#nombreOrigenTransfer").html();mascara=$("#mascaraOrigenTransfer").html();var G=new Date();hora=(G.getHours())+":"+G.getMinutes()+":"+G.getSeconds();var I=G.getDate();var E=G.getMonth()+1;var F=G.getFullYear();if(I<10){I="0"+I}if(E<10){E="0"+E}var J=I+"/"+E+"/"+F;C="<tr>";C+='<td class="data-label"><label>Cuenta Origen</label></td>';C+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>";C+="</tr>";$("#bodyConfirm").append(C);$("#progress").children().remove();cabecera="<ul class='steps'>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>";cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>";cabecera+="</ul>";$("#progress").append(cabecera).html();$("#titulo").children().remove();titulo="<h2>Finalización</h2>";$("#titulo").append(titulo).html();var B;B="<tr>";B+='<td colspan="2"></td>';B+='<td class="data-metadata">';B+='Total: <span class="lighten"> ('+moneda+" "+comision+' Comisión) </span> <br /><span class="money-amount"> '+moneda+" "+montoMasComision+" </span>";B+="</td>";B+="</tr>";$("#bodyConfirm").append(B).html();$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else{z=false;trans="-";a(z,K,transferencia);$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}})}},},open:function(t,u){$(".ui-dialog-titlebar-close",u.dialog).hide()}})}}else{var p=$("#trorigen").attr("card");var q=$("#trorigen").attr("idUsuario");var s,l,n,o,r;$(".data-indicator").show();$.each($(".trdestino"),function(y,B){s=$(B).attr("card");l=$(B).attr("id_afil");n=$(B).attr("monto");o=$(B).attr("concepto");comision=$(B).attr("comision");transferencia=f(p,s,n,o,q,l);if(transferencia!=false){r=true;a(r,B,transferencia);var t,u;nombre=$("#nombreOrigenTransfer").html();mascara=$("#mascaraOrigenTransfer").html();var x=new Date();hora=(x.getHours())+":"+x.getMinutes()+":"+x.getSeconds();var z=x.getDate();var v=x.getMonth()+1;var w=x.getFullYear();if(z<10){z="0"+z}if(v<10){v="0"+v}var A=z+"/"+v+"/"+w;t="<tr>";t+='<td class="data-label"><label>Cuenta Origen</label></td>';t+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>";t+="</tr>";$("#progress").children().remove();cabecera="<ul class='steps'>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>";cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>";cabecera+="</ul>";$("#progress").append(cabecera).html();$("#titulo").children().remove();titulo="<h2>Finalización</h2>";$("#titulo").append(titulo).html();$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else{r=false;trans="-";a(r,B,transferencia);$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}})}});function k(){var l;$.each($("#tdestino").children(),function(o,n){l=o});return l+1}function c(){$(".dialogDestino").click(function(){$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",open:function(l,n){$(".ui-dialog-titlebar-close",n.dialog).hide()}});$("#close").click(function(){$("#content-destino").dialog("close")})})}function d(){var n=0;var l;$.each($(".dinero"),function(p,o){l=$(o).val().replace(",",".");n=n+parseFloat(l);n.toFixed(2)});if(isNaN(n)){n=0}return n}function g(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(n,l){$(l).removeClass("disabled-dashboard-item");$.each($("#tdestino").children(":not(.obscure-group)"),function(p,o){if($(o).find("#tarjetaDestino").val()==$(l).attr("card")){$(l).addClass("disabled-dashboard-item")}})})}function i(l){var o;var n;$.ajaxSetup({async:false});$.post(base_url+"/transferencia/operaciones",{clave:hex_md5(l)},function(p){rpta=$.parseJSON(p.response);n=$.parseJSON(p.transferir);if(rpta.rc==0){o=true}else{o=false;n=false}});return n}function j(){$.ajaxSetup({async:false});var l;$.post(base_url+"/transferencia/crearClave",function(n){if(n.rc==0){l=true}else{l=false;$("#dialog-error-clave").dialog({title:"ContraseÃ±as no coinciden",modal:"true",width:"440px",open:function(o,p){$(".ui-dialog-titlebar-close",p.dialog).hide()}});$("#invalido2").click(function(){$("#dialog-error-clave").dialog("close");$(location).attr("href",base_url+"/transfer/index_tdc")})}});return l}function h(l){$.ajaxSetup({async:false});var n;$.post(base_url+"/transferencia/confirmacion",{clave:hex_md5(l)},function(o){if(o.rc==0){n=true}else{n=false;$("#dialog-error-correo").dialog({title:"ContraseÃ±as no coinciden",modal:"true",width:"440px",open:function(p,q){$(".ui-dialog-titlebar-close",q.dialog).hide()}});$("#invalido").click(function(){$("#dialog-error-correo").dialog("close")})}});return n}function f(n,l,p,o,t,s){var r;var u;$.ajaxSetup({async:false});var q={cuentaOrigen:n,cuentaDestino:l,monto:p,descripcion:o,tipoOpe:"P2C",idUsuario:t,id_afil_terceros:s};$.ajax({url:base_url+"/transferencia/procesar",data:q,type:"post",dataType:"json",success:function(v){if(v.rc==0){u=v.dataTransaccion.referencia;r=u;$("#continue_trans").prop("disabled",false)}else{r=false;$("#continue_trans").prop("disabled",false)}}});$.ajaxSetup({async:true});return r}function a(o,l,n){if(o==true){$(l).find(".data-resultado").addClass("data-success");$(l).find(".iconoTransferencia").removeClass("data-indicator icon-refresh icon-spin");$(l).find(".iconoTransferencia").addClass("icon-ok-sign");$(l).find("#estatus").empty();$(l).find("#estatus").text("Transacción exitosa. Nro. Transacción: "+n)}else{$(l).find(".data-resultado").addClass("data-error");$(l).find(".iconoTransferencia").removeClass("data-indicator data-indicator icon-refresh icon-spin");$(l).find(".iconoTransferencia").addClass("icon-cancel-sign");$(l).find("#estatus").empty();$(l).find("#estatus").text("Transacción fallida.")}}function b(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(n,l){if(montoMaxDiario==montoAcumDiario){$(l).addClass("disabled-dashboard-item");alert("Para esta operacion usted supera el monto maximo diario de transferencias")}else{if(montoMaxMensual==montoAcumMensual){$(l).addClass("disabled-dashboard-item");alert("Para esta operacion usted supera el monto maximo diario de transferencias")}}})}$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(l,n){$(".ui-dialog-titlebar-close",n.dialog).hide()}});$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});