var path,base_cdn;path=window.location.href.split("/");base_cdn=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_baseCdn\s*\=\s*([^;]*).*$)|^.*$/,"$1"));base_url=path[0]+"//"+path[2]+"/"+path[3];var montoMaxOperaciones,montoMinOperaciones,dobleAutenticacion,claveValida,claveC,moneda,totaldef,pais,saldo_imp,trans;$(function(){var e=$("#content").attr("confirmacion");if(e=="1"){$("#content-clave").hide();$("#tabs-menu").show();$("#content_plata").show()}else{$("#content-clave").show()}$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")});$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")});$("#continuar_transfer").click(function(){var o=$("#transpwd").val();if((j(o))){$("#content-clave").hide();$("#content_plata").show()}else{$("#content_clave").show();$.balloon.defaults.classname="field-error";$.balloon.defaults.css=null;$("#transpwd").showBalloon({position:"right",contents:"Clave inválida"});setTimeout(function(){$("#transpwd").hideBalloon()},3000)}});$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(r,s){$(".ui-dialog-titlebar-close",s.dialog).hide()}});$("#cerrar").click(function(){$("#content-product").dialog("close")});$.each($(".dashboard-item"),function(s,r){$.post(base_url+"/dashboard/saldo",{tarjeta:$(r).attr("card")},function(v){var u=$(".dashboard-item").attr("moneda");var t=v.disponible;if(typeof t!="string"){t="---"}$(r).find(".dashboard-item-balance").html(u+t)})});var p=$("#dashboard-donor");p.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:true}});var o=$("#filters-stack .option-set"),q=o.find("a");q.click(function(){var v=$(this);if(v.hasClass("selected")){return false}var t=v.parents(".option-set");t.find(".selected").removeClass("selected");v.addClass("selected");var r={},s=t.attr("data-option-key"),u=v.attr("data-option-value");u=u==="false"?false:u;r[s]=u;if(s==="layoutMode"&&typeof changeLayoutMode==="function"){changeLayoutMode(v,r)}else{p.isotope(r)}return false})});$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item");$(this).parents("li").addClass("current-stack-item")});$(".dashboard-item").click(function(){var A,u,q,p,B,v,r,z,o,y,w,D,C,t,s,x=[];w=new Date();D=w.getFullYear();C=D-5;t=D+5;for(s=C;s<=t;s++){x.push(s)}A=$(this).find("img").attr("src");u=$(this).attr("card");q=$(this).attr("marca").toLowerCase();p=$(this).attr("mascara");B=$(this).attr("producto1");v=$(this).attr("empresa");z=$(this).attr("nombre");o=$(this).attr("moneda");pais=$(this).attr("pais");$("#donor").children().remove();r='<div class="product-presentation" producto="'+B+'">';r+='<img src="'+A+'" width="200" height="130" alt="" />';r+='<div class="product-network '+q+'"></div>';r+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" cardOrigen="'+u+'" />';r+="</div>";r+='<div class="product-info">';r+='<p class="product-cardholder" id="nombreCtaOrigen">'+z+"</p>";r+='<p class="product-cardnumber">'+p+"</p>";r+='<p class="product-metadata">'+B+"</p>";r+='<nav class="product-stack">';r+='<ul class="stack">';r+='<li class="stack-item">';r+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';r+="</li>";r+="</ul>";r+="</nav>";r+="</div>";r+='<div class="product-scheme">';r+='<ul class="product-balance-group" style="margin: 10px 0">';r+='<li>Disponible <span class="product-balance" id="balance-available">'+o+" 0.00</span></li>";r+='<li>A debitar <span class="product-balance debitar" id="balance-debit">'+o+" 0.00</span></li>";r+="</ul>";r+="<ul class='field-group'>";r+="<li class='field-group-item'>";r+="<label for='dayExp'>Fecha de Vencimiento</label>";r+="<select id='MonthExp' name='MonthExp'>";r+="<option value=''>Mes</option>";r+="<option value='01'>01</option>";r+="<option value='02'>02</option>";r+="<option value='03'>03</option>";r+="<option value='04'>04</option>";r+="<option value='05'>05</option>";r+="<option value='06'>06</option>";r+="<option value='07'>07</option>";r+="<option value='08'>08</option>";r+="<option value='09'>09</option>";r+="<option value='10'>10</option>";r+="<option value='11'>11</option>";r+="<option value='12'>12</option>";r+="</select>";r+="<select id='yearExp' name='yearExp'>";r+="<option value=''>Año</option>";r+="</select>";r+="</li>";r+="</ul>";r+="</div>";$("#donor").append(r);$.each(x,function(E,G){var F=G.toString().substring(2,4);var H="<option value='"+F+"'>"+G+"</option>";$("#yearExp").append(H)});$.post(base_url+"/dashboard/saldo",{tarjeta:$(this).attr("card")},function(F){var E=F.disponible;if(typeof E!="string"){E="---"}$("#balance-available").html(o+E);$("#balance-available").attr("saldo",E)});$(".product-button").removeClass("disabled-button");$("#agregarCuenta").attr("href","#");$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item");$.each($(".dashboard-item"),function(F,E){if($(this).hasClass("current-dashboard-item")){$(this).removeClass("current-dashboard-item")}});$(this).addClass("current-dashboard-item");$("#content-product").dialog("close");$(".stack-item").click(function(){$("#tdestino").children().remove();$("#tdestino").append($("#removerDestino").html());$("#continuar").attr("disabled",true);$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(E,F){$(".ui-dialog-titlebar-close",F.dialog).hide()}})});$.post("transferencia/ctaDestino",{nroTarjeta:$(this).attr("card"),prefijo:$(this).attr("prefix"),operacion:"P2P"},function(E){if(E.rc==-150){$("#content_plata").children().remove();$("#tabs-menu").children().remove();$("#content_plata").append($("#content-no-afil").html());$("#content-no-afil").children().remove();$("#content-destino").dialog("close")}if(E.rc==-0){montoMaxOperaciones=E.parametrosTransferencias[0].montoMaxOperaciones;montoMinOperaciones=E.parametrosTransferencias[0].montoMinOperaciones;montoMaxDiario=E.parametrosTransferencias[0].montoMaxDiario;montoMaxSemanal=E.parametrosTransferencias[0].montoMaxSemanal;montoMaxMensual=E.parametrosTransferencias[0].montoMaxMensual;cantidadOperacionesDiarias=E.parametrosTransferencias[0].cantidadOperacionesDiarias;cantidadOperacionesSemanales=E.parametrosTransferencias[0].cantidadOperacionesSemanales;cantidadOperacionesMensual=E.parametrosTransferencias[0].cantidadOperacionesMensual;montoAcumDiario=E.parametrosTransferencias[0].montoAcumDiario;montoAcumSemanal=E.parametrosTransferencias[0].montoAcumSemanal;montoAcumMensual=E.parametrosTransferencias[0].montoAcumMensual;acumCantidadOperacionesDiarias=E.parametrosTransferencias[0].acumCantidadOperacionesDiarias;acumCantidadOperacionesSemanales=E.parametrosTransferencias[0].acumCantidadOperacionesSemanales;acumCantidadOperacionesMensual=E.parametrosTransferencias[0].acumCantidadOperacionesMensual;dobleAutenticacion=E.parametrosTransferencias[0].dobleAutenticacion;$("#dashboard-beneficiary").empty();$.each(E.cuentaDestinoPlata,function(G,F){imagen1=F.nombre_producto.toLowerCase();imagen2=h(imagen1);imagen3=imagen2.replace(" ","-");imagen4=imagen3.replace(" ","-");A=imagen4.replace("/","-");r=" <li class='dashboard-item "+F.nomEmp+" muestraDestino' card='"+F.noTarjeta+"' nombre='"+F.NombreCliente+"' marca='"+F.marca+"' mascara='"+F.noTarjetaConMascara+"' empresa='"+F.nomEmp+"' producto='"+F.nombre_producto+"'>";r+="<a rel='section' class='escogerDestino'>";r+="<img src='"+base_cdn+"/img/products/"+pais+"/"+A+".png' width='200' height='130' alt='' />";r+="<div class='dashboard-item-network "+F.marca.toLowerCase()+"'>"+F.marca+"</div>";r+="<div class='dashboard-item-info'>";r+="<p class='dashboard-item-cardholder'>"+F.NombreCliente+"</p>";r+="<p class='dashboard-item-cardnumber'>"+F.noTarjetaConMascara+"</p>";r+="<p class='dashboard-item-category'>"+F.nombre_producto+"</p>";r+="</div>";r+=" </a>";r+="</li>";$("#dashboard-beneficiary").append(r)})}if(E.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}$(".muestraDestino").click(function(){if($(this).hasClass("disabled-dashboard-item")==true){$("#content-destino").dialog("close")}else{var N,K,I,G,O,L,J,M;N=$(this).find("img").attr("src");K=$(this).attr("card");I=$(this).attr("marca");G=$(this).attr("mascara");O=$(this).attr("producto");L=$(this).attr("empresa");M=$(this).attr("nombre");$(".edit").remove();var H=l();J='<div class="group"> ';J+='<div class="product-presentation">';J+='<img src="'+N+'" width="200" height="130" alt="" />';J+='<div class="product-network '+I.toLowerCase()+'"></div>';J+='<input id="tarjetaDestino" name="tarjetaDestino" type="hidden" value="'+K+'" />';J+='<input id="marcaDestino" name="marcaDestino" type="hidden" value="'+o+'" />';J+='<input id="marca" name="marcaDestino" type="hidden" value="'+O+'" />';J+="</div>";J+='<div class="product-info">';J+='<p class="product-cardholder">'+M+"</p>";J+='<p class="product-cardnumber">'+G+"</p>";J+='<p class="product-metadata">'+O+"</p>";J+='<nav class="product-stack">';J+='<ul class="stack">';J+='<li class="stack-item modifica">';J+='<a rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';J+="</li>";J+='<li class="stack-item elimina">';J+='<a rel="section" title="Remover"><span aria-hidden="true" class="icon-cancel"></span></a>';J+="</li>";J+="</ul>";J+="</nav>";J+="</div>";J+='<div class="product-scheme">';J+='<fieldset class="form-inline">';J+='<label for="beneficiary-1x-description" title="Descripción de la transferencia.">Concepto</label>';J+='<input class="field-large mont" id="beneficiary-'+H+'x-description" maxlength="60" name="beneficiary-1x-description" type="text" />';J+='<label for="beneficiary-1x-amount" title="Monto a transferir.">Importe</label>';J+='<div class="field-category"> '+o+" ";J+='<input id="beneficiary-1x-coin" name="beneficiary-1x-coin" type="hidden" value="'+o+'."/>';J+="</div>";J+='<input class="field-small monto dinero" id="beneficiary-'+H+'-amount" maxlength="12" name="beneficiary-1x-amount"/> <br/>';J+="</fieldset></div></div>";$("#content_plata #tdestino").append(J);$("#beneficiary-1x").removeClass("obscure-group");$("#content-destino").dialog("close");$("#tdestino").children("#btn-destino").remove();$("#tdestino").append($("#removerDestino").html());g();var F=$(".monto").val().replace(",",".");$("#content_plata").on("keyup",".monto",function(){var P=$(this).val();if((pais=="Pe")||(pais=="Usd")){expr=/^-?[0-9]+([\.][0-9]{0,2})?$/;saldo_imp=$("#balance-available").attr("saldo").replace(",","")}if((pais=="Ve")||(pais=="Co")){expr=/^-?[0-9]+([\,][0-9]{0,2})?$/;saldo_imp1=$("#balance-available").attr("saldo").replace(".","");saldo_imp=saldo_imp1.replace(",",".")}if(!expr.test(P)){if((pais=="Pe")||(pais=="Usd")){$("#dialog-error-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(Q,R){$(".ui-dialog-titlebar-close",R.dialog).hide()}});$("#monto_invalido").click(function(){$("#dialog-error-monto").dialog("close")})}if((pais=="Ve")||(pais=="Co")){$("#dialog-error-monto-vc").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(Q,R){$(".ui-dialog-titlebar-close",R.dialog).hide()}});$("#monto_invalido_vc").click(function(){$("#dialog-error-monto-vc").dialog("close")})}$(this).val("")}F=$(this).val().replace(",",".");if((parseFloat(F))>saldo_imp){$("#dialog-max-monto1").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(Q,R){$(".ui-dialog-titlebar-close",R.dialog).hide()}});$("#monto_inv").click(function(){$("#dialog-max-monto1").dialog("close")});$(this).val("")}if((parseFloat(F))>parseFloat(montoMaxOperaciones)){$("#dialog-max-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(Q,R){$(".ui-dialog-titlebar-close",R.dialog).hide()}});$("#monto_invalido1").click(function(){$("#dialog-max-monto").dialog("close")});$(this).val("")}if((parseFloat(F)+parseFloat(montoAcumMensual))>parseFloat(montoMaxMensual)){$("#dialog-min-monto2").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(Q,R){$(".ui-dialog-titlebar-close",R.dialog).hide()}});$("#monto_invalido3").click(function(){$("#dialog-min-monto2").dialog("close")});$(this).val("");$("#balance-debit").html(m+d().toFixed(2))}else{if((parseFloat($(this).val())+parseFloat(montoAcumDiario))>parseFloat(montoMaxDiario)){$("#dialog-min-monto3").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(Q,R){$(".ui-dialog-titlebar-close",R.dialog).hide()}});$("#monto_invalido4").click(function(){$("#dialog-min-monto3").dialog("close")});$(this).val("");$("#balance-debit").html(m+d().toFixed(2))}else{m=$(".dashboard-item").attr("moneda");$(this).parents(".group").attr("montInput",$(this).val());$(this).val().replace(",",".");$("#balance-debit").html(m+d().toFixed(2))}}});c();if(H>=3){$("#tdestino").children("#btn-destino").remove()}if(H>=1){$("#continuar").removeAttr("disabled")}else{$("#continuar").attr("disabled","")}}})});$(".modifica").click(function(){$(this).parents(".group").addClass("edit");$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",beforeClose:function(E,F){$(".group").removeClass("edit")},open:function(E,F){$(".ui-dialog-titlebar-close",F.dialog).hide()}})});$("#content_plata").on("click",".elimina",function(){m=$(".dashboard-item").attr("moneda");suma=d();if(suma!=0){montoR1=$(this).parents(".group").attr("montInput").replace(",",".");montoRestar=parseFloat(montoR1)}else{montoRestar=0}saldo1=suma-montoRestar;saldo=saldo1.toFixed(2);if((saldo<0)||isNaN(saldo)){$("#balance-debit").html(m+0)}else{$("#balance-debit").html(m+saldo)}$(this).parents(".group").remove();g();if($("#tdestino").find("#btn-destino").length==0){$("#tdestino").append($("#removerDestino").html());c()}if(l()>1){$("#continuar").removeAttr("disabled")}else{$("#continuar").attr("disabled","")}});c()});$("#content_plata").on("click",".confir",function(){var s=true;var v=0;$("#validate").submit();$("#montoTotal").remove();$("#tdestino").append("<input id='montoTotal' name='montoTotal' type='hidden' class='checkTotal' value='' />");$("#montoTotal").val(d());total=d();saldo=saldo_imp;valor_concepto1=$("#beneficiary-1x-description").val();valor_concepto2=$("#beneficiary-2x-description").val();valor_concepto3=$("#beneficiary-3x-description").val();var x;var y=[];var q=[{"1":"El campo concepto no debe estar vacío. Por favor, verifique e intente nuevamente.","2":"El monto total excede su saldo disponible. Por favor, verifique e intente nuevamente.","3":"La cantidad de operaciones no esta permitida. Usted excede el límite diario permitido. Por favor, verifique e intente nuevamente.","4":"La cantidad de operaciones no esta permitida. Usted excede el límite semanal permitido. Por favor, verifique e intente nuevamente.","5":"La cantidad de operaciones no esta permitida. Usted excede el límite mensual permitido.  Por favor, verifique e intente nuevamente.","6":"El monto a debitar es mayor al monto maximo semanal permitido. Por favor, verifique e intente nuevamente.","7":"El monto a total a debitar supera el monto máximo de operaciones . Por favor, verifique e intente nuevamente.","8":"El monto total a debitar es menor al monto mínimo de operaciones. Por favor, verifique e intente nuevamente.","9":"se requiere dia.","10":"se requiere año.","11":"El monto total a debitar es mayor al monto maximo diario permitido. Por favor, verifique e intente nuevamente.","12":"El monto total a debitar es mayor al monto maximo semanal permitido. Por favor, verifique e intente nuevamente.","13":"El monto total a debitar es mayor al monto maximo mensual permitido. Por favor, verifique e intente nuevamente.",}];if((valor_concepto1=="")||(valor_concepto2=="")||(valor_concepto3=="")){x=1;y.push(x)}if(parseFloat(total)>saldo){x=2;y.push(x)}if(parseFloat(acumCantidadOperacionesDiarias)+parseFloat(v)>=parseFloat(cantidadOperacionesDiarias)){x=3;y.push(x)}if(parseFloat(acumCantidadOperacionesSemanales)+parseFloat(v)>=parseFloat(cantidadOperacionesSemanales)){x=4;y.push(x)}if(parseFloat(acumCantidadOperacionesMensual)+parseFloat(v)>parseFloat(cantidadOperacionesMensual)){x=5;y.push(x)}valor_monto1=$("#beneficiary-1-amount").val();valor_monto2=$("#beneficiary-2-amount").val();valor_monto3=$("#beneficiary-3-amount").val();if((parseFloat(valor_monto1)<parseFloat(montoMinOperaciones))||(parseFloat(valor_monto2)<parseFloat(montoMinOperaciones))||(parseFloat(valor_monto3)<parseFloat(montoMinOperaciones))){x=6;y.push(x)}if(parseFloat(total)>parseFloat(montoMaxOperaciones)){x=7;y.push(x)}if(parseFloat(total)<parseFloat(montoMinOperaciones)){x=8;y.push(x)}if(parseFloat(total)<parseFloat(montoMinOperaciones)){x=9;y.push(x)}if(parseFloat(total)<parseFloat(montoMinOperaciones)){x=10;y.push(x)}if((parseFloat(total)+parseFloat(montoAcumDiario))>parseFloat(montoMaxDiario)){x=11;y.push(x)}else{if((parseFloat(total)+parseFloat(montoAcumSemanal))>parseFloat(montoMaxSemanal)){x=12;y.push(x)}else{if((parseFloat(total)+parseFloat(montoAcumMensual))>parseFloat(montoMaxMensual)){x=13;y.push(x)}}}console.log(y);totaldef=parseFloat(valor_monto1)+parseFloat(valor_monto2)+parseFloat(valor_monto3);if(y.length!=""){console.log("hay errores");$("#errorsFormat").dialog({title:"Error",modal:"true",width:"440px",open:function(z,A){$(".ui-dialog-titlebar-close",A.dialog).hide()}});$("#errorModal").click(function(){$("#errorsFormat").dialog("close")});s=false;$.each(y,function(z,A){console.log(A);$.each(q,function(B,C){if(C=B){result=B;console.log(B)}})})}if(s==true){var p,w,r;w=$("#donor").find(".product-cardholder").html();r=$("#donor").find(".product-cardnumber").html();numeroCtaOrigen=$("#donor").find("#donor-cardnumber-origen").attr("cardOrigen");nombreCtaOrigen=$("#donor").find("#nombreCtaOrigen").html();banco=$("#donor").find(".banco").html();marca=$("#donor").find(".product-metadata").html();p="<tr>";p+='<td class="data-label"><label>Cuenta Origen</label></td>';p+='<td class="data-reference" id="nombreOrigenTransfer" colspan="2" numeroCtaOrigen="'+numeroCtaOrigen+'" nombreCtaOrigen="'+nombreCtaOrigen+'">'+w+'<br /><span class="highlight" id="mascaraOrigenTransfer">'+r+'</span><br /><span class="lighten"> '+marca+" </span></td>";p+="</tr>";$("#cargarConfirmacion").append(p);var u;var t=0;montodef=0;$.each($("#tdestino").children(":not(.obscure-group, .checkTotal)"),function(G,C){var A,E,D,z,F;t=t+1;E=$(C).find(".product-cardholder").html();D=$(C).find(".product-cardnumber").html();z=$(C).find("#beneficiary-"+t+"-amount").val();montodef=parseFloat($(C).find("#beneficiary-"+t+"-amount").val())+montodef;F=$(C).find("#beneficiary-"+t+"x-description").val();marcad=$(C).find("#marca").val();ctnDestino=$(C).find("#tarjetaDestino").val();id_afil=$(C).find(".id_afiliacion").val();if((pais=="Ve")||(pais=="Co")){var B=$(".product-scheme").find(".debitar").html().replace(/Bs./g,"");total1=B.replace(".",",")}else{var B=$(".product-scheme").find(".debitar").html().replace(/S../g,"");total1=B}moneda=$(".dashboard-item").attr("moneda");v=v+1;A='<tr class="trdestino" card="'+ctnDestino+'" id_afil="'+id_afil+'" nombre="'+E+'" monto="'+z+'" concepto="'+F+'" moneda="'+moneda+'" mascara="'+D+'" marca="'+marcad+'">';A+='<td class="data-label"><label>Cuentas Destino</label></td>';A+='<td class="data-reference" id="nombreDestinoTransfer">'+E+'<br /><span class="highlight" id="mascaraDestinoTransfer">'+D+'</span><br /><span class="lighten"> '+marcad+" </span></td>";A+='<td class="data-metadata data-resultado">';A+='<div class="data-indicator">';A+='<span aria-hidden="true" class="iconoTransferencia"></span>';A+='</div><span class="data-metadata" id="conceptoDestino"><strong>Concepto: </strong>'+F+'<br /><strong>Monto: </strong> <span class="money-amount" monto="'+z+'" id="montoDestinoTransfer"> '+moneda+" "+z+'<br /> </span><strong>Estatus: </strong><span class="money-amount" id="estatus">En espera por confirmación.</span></td>';A+="</td>";A+="</tr>";A+="<tr>";A+='<td class="data-spacing" colspan="3"></td>';A+="</tr>";$("#cargarConfirmacion").append(A)});$("#content_plata").children().remove();$("#content_plata").append($("#contentConfirmacion").html());$("#contentConfirmacion").remove();var o;o="<tr>";o+='<td class="data-spacing" colspan="3"></td>';o+="</tr>";o+="<tr>";o+='<td colspan="2"></td>';o+='<td class="data-metadata">Total<br /><span class="money-amount" id="mm">'+moneda+" "+total1+'</span></td> <input id="montoTotal" name="montoTotal" type="hidden" total="'+total+'" />';o+="</tr>";$("#cargarConfirmacion").append(o).html()}});$("#content_plata").on("click","#confTransfer",function(){$("#confTransfer").prop("disabled",true);var t=$("#transpwd").val();if(dobleAutenticacion=="S"){if(k()){$("#dialog-confirm").dialog({modal:true,title:"Verificación requerida.",buttons:{Cancelar:function(){$(this).dialog("close")},Aceptar:function(){var x=$("#transpwd_confirmacion").val();if(i(x)){$("#dialog-confirm").dialog("close");var A=$("#nombreOrigenTransfer").attr("numeroCtaOrigen");var B=$("#nombreOrigenTransfer").attr("nombreCtaOrigen");var D,w,y,z,C;$(".data-indicator").show();$.each($(".trdestino"),function(J,M){D=$(M).attr("card");w="";nombre1=$(M).attr("nombre");y=$(M).attr("monto").replace(",",".");z=$(M).attr("concepto");trans=f(A,D,y,z,B,w);if(trans!=false){C=true;a(C,M,trans);var E,F;nombre=$("#nombreOrigenTransfer").html();mascara=$("#mascaraOrigenTransfer").html();var I=new Date();hora=(I.getHours())+":"+I.getMinutes()+":"+I.getSeconds();var K=I.getDate();var G=I.getMonth()+1;var H=I.getFullYear();if(K<10){K="0"+K}if(G<10){G="0"+G}var L=K+"/"+G+"/"+H;E="<tr>";E+='<td class="data-label"><label>Cuenta Origen</label></td>';E+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>";E+="</tr>";$("#progress").children().remove();cabecera="<ul class='steps'>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>";cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>";cabecera+="</ul>";$("#progress").append(cabecera).html();$("#titulo").children().remove();titulo="<h2>Finalización</h2>";$("#titulo").append(titulo).html();$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else{C=false;trans="-";a(C,M,trans);$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#transfer-success").show();$("#exit").click(function(){$(location).attr("href",base_url+"/transferencia")})}})}},},open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}})}}else{var r=$("#nombreOrigenTransfer").attr("numeroCtaOrigen");var s=$("#nombreOrigenTransfer").attr("nombreCtaOrigen");var v,o,p,q,u;$(".data-indicator").show();$.each($(".trdestino"),function(B,E){v=$(E).attr("card");o="";nombre1=$(E).attr("nombre");p=$(E).attr("monto").replace(",",".");q=$(E).attr("concepto");trans=f(r,v,p,q,s,o);if(trans!=false){u=true;a(u,E,trans);var w,x;nombre=$("#nombreOrigenTransfer").html();mascara=$("#mascaraOrigenTransfer").html();var A=new Date();hora=(A.getHours())+":"+A.getMinutes()+":"+A.getSeconds();var C=A.getDate();var y=A.getMonth()+1;var z=A.getFullYear();if(C<10){C="0"+C}if(y<10){y="0"+y}var D=C+"/"+y+"/"+z;w="<tr>";w+='<td class="data-label"><label>Cuenta Origen</label></td>';w+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>";w+="</tr>";$("#progress").children().remove();cabecera="<ul class='steps'>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>";cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>";cabecera+="</ul>";$("#progress").append(cabecera).html();$("#titulo").children().remove();titulo="<h2>Finalización</h2>";$("#titulo").append(titulo).html();$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#transfer-success").show();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else{u=false;trans="-";a(u,E,trans);$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/transferencia")})}})}});function l(){var o;$.each($("#tdestino").children(),function(q,p){o=q});return o+1}function c(){$(".dialogDestino").click(function(){$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",open:function(o,p){$(".ui-dialog-titlebar-close",p.dialog).hide()}});$("#close").click(function(){$("#content-destino").dialog("close")})})}function n(){var o;$.each($(".dashboard-item"),function(q,p){o=q});tarjetas=o+1;return tarjetas}function g(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(p,o){$(o).removeClass("disabled-dashboard-item");$.each($("#tdestino").children(":not(.obscure-group)"),function(r,q){if($(q).find("#tarjetaDestino").val()==$(o).attr("card")){$(o).addClass("disabled-dashboard-item")}})})}function d(){var p=0;var o;$.each($(".dinero"),function(r,q){o=$(q).val().replace(",",".");p=p+parseFloat(o);p.toFixed(2)});if(isNaN(p)){p=0}return p}function j(p){var r;var q;$.ajaxSetup({async:false});var o={clave:hex_md5(p),};$.ajax({url:base_url+"/transferencia/operaciones",data:o,type:"post",dataType:"json",success:function(s){rpta=$.parseJSON(s.response);q=$.parseJSON(s.transferir);if(rpta.rc==0){r=true}else{r=false;q=false}if(rpta.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}}});$.ajaxSetup({async:true});return q}function k(){$.ajaxSetup({async:false});var o;$.post(base_url+"/transferencia/crearClave",function(p){if(p.rc==0){o=true}else{o=false;$("#dialog-error-clave").dialog({modal:"true",width:"440px",open:function(q,r){$(".ui-dialog-titlebar-close",r.dialog).hide()}});$("#invalido2").click(function(){$("#dialog-error-clave").dialog("close");$(location).attr("href",base_url+"/transfer")})}if(p.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}});return o}function i(o){$.ajaxSetup({async:false});var p;$.post(base_url+"/transferencia/confirmacion",{clave:hex_md5(o)},function(q){if(q.rc==0){p=true}else{p=false;$("#dialog-error-correo").dialog({title:"Contraseñas no coinciden",modal:"true",width:"440px",open:function(r,s){$(".ui-dialog-titlebar-close",s.dialog).hide()}});$("#invalido").click(function(){$("#dialog-error-correo").dialog("close")})}if(q.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}});return p}function f(p,o,r,q,v,u){var t;var w;$.ajaxSetup({async:false});var s={cuentaOrigen:p,cuentaDestino:o,monto:r,descripcion:q,tipoOpe:"P2P",idUsuario:v,id_afil_terceros:u};$.ajax({url:base_url+"/transferencia/procesar",data:s,type:"post",dataType:"json",success:function(x){if(x.rc==0){w=x.dataTransaccion.referencia;t=w;$("#confTransfer").prop("disabled",false)}else{t=false;$("#confTransfer").prop("disabled",false)}if(x.rc==-61){$(location).attr("href",base_url+"/users/error_gral");$("#confTransfer").prop("disabled",false)}}});$.ajaxSetup({async:true});return t}function a(q,p,o){if(q==true){$(p).find(".data-resultado").addClass("data-success");$(p).find(".iconoTransferencia").removeClass("data-indicator icon-refresh icon-spin");$(p).find(".iconoTransferencia").addClass("icon-ok-sign");$(p).find("#estatus").empty();$(p).find("#estatus").text("Transacción exitosa. No. de Referencia: "+o)}else{$(p).find(".data-resultado").addClass("data-error");$(p).find(".iconoTransferencia").removeClass("data-indicator data-indicator icon-refresh icon-spin");$(p).find(".iconoTransferencia").addClass("icon-cancel-sign");$(p).find("#estatus").empty();$(p).find("#estatus").text("Transacción fallida.")}}function b(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(p,o){if(montoMaxDiario==montoAcumDiario){$(o).addClass("disabled-dashboard-item");alert("Para esta operacion usted supera el monto maximo diario de transferencias")}else{if(montoMaxMensual==montoAcumMensual){$(o).addClass("disabled-dashboard-item");alert("Para esta operacion usted supera el monto maximo diario de transferencias")}}})}function h(r){var q="ÃÀÁÄÂÈÉËÊÌÍÏÎÒÓÖÔÙÚÜÛãàáäâèéëêìíïîòóöôùúüûÑñÇç";var p="AAAAAEEEEIIIIOOOOUUUUaaaaaeeeeiiiioooouuuunncc";for(var o=0;o<q.length;o++){r=r.replace(q.charAt(o),p.charAt(o))}return r}$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(o,p){$(".ui-dialog-titlebar-close",p.dialog).hide()}});$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});