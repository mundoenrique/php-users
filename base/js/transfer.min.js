var path,base_cdn;path=window.location.href.split("/");base_cdn=path[0]+"//"+path[2].replace("online","cdn")+"/"+path[3];base_url=path[0]+"//"+path[2]+"/"+path[3];var montoMaxOperaciones,montoMinOperaciones,dobleAutenticacion,claveValida,claveC,moneda,totaldef,pais,saldo_imp,trans;$(function(){var e=$("#content").attr("confirmacion");if(e=="1"){$("#content-clave").hide();$("#tabs-menu").show();$("#content_plata").show()}else{$("#content-clave").show()}$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")});$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")});$("#continuar_transfer").click(function(){var o=$("#transpwd").val();if((j(o))){$("#content-clave").hide();$("#content_plata").show()}else{$("#content_clave").show();$.balloon.defaults.classname="field-error";$.balloon.defaults.css=null;$("#transpwd").showBalloon({position:"right",contents:"Clave inválida"});setTimeout(function(){$("#transpwd").hideBalloon()},3000)}});$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(r,s){$(".ui-dialog-titlebar-close",s.dialog).hide()}});$("#cerrar").click(function(){$("#content-product").dialog("close")});$.each($(".dashboard-item"),function(s,r){$.post(base_url+"/dashboard/saldo",{tarjeta:$(r).attr("card")},function(v){var u=$(".dashboard-item").attr("moneda");var t=v.disponible;if(typeof t!="string"){t="---"}$(r).find(".dashboard-item-balance").html(u+t)})});var p=$("#dashboard-donor");p.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:true}});var o=$("#filters-stack .option-set"),q=o.find("a");q.click(function(){var v=$(this);if(v.hasClass("selected")){return false}var t=v.parents(".option-set");t.find(".selected").removeClass("selected");v.addClass("selected");var r={},s=t.attr("data-option-key"),u=v.attr("data-option-value");u=u==="false"?false:u;r[s]=u;if(s==="layoutMode"&&typeof changeLayoutMode==="function"){changeLayoutMode(v,r)}else{p.isotope(r)}return false})});$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item");$(this).parents("li").addClass("current-stack-item")});$(".dashboard-item").click(function(){var v,s,q,p,w,t,r,u,o;v=$(this).find("img").attr("src");s=$(this).attr("card");q=$(this).attr("marca").toLowerCase();p=$(this).attr("mascara");w=$(this).attr("producto1");t=$(this).attr("empresa");u=$(this).attr("nombre");o=$(this).attr("moneda");pais=$(this).attr("pais");$("#donor").children().remove();r='<div class="product-presentation" producto="'+w+'">';r+='<img src="'+v+'" width="200" height="130" alt="" />';r+='<div class="product-network '+q+'"></div>';r+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" cardOrigen="'+s+'" />';r+="</div>";r+='<div class="product-info">';r+='<p class="product-cardholder" id="nombreCtaOrigen">'+u+"</p>";r+='<p class="product-cardnumber">'+p+"</p>";r+='<p class="product-metadata">'+w+"</p>";r+='<nav class="product-stack">';r+='<ul class="stack">';r+='<li class="stack-item">';r+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';r+="</li>";r+="</ul>";r+="</nav>";r+="</div>";r+='<div class="product-scheme">';r+='<ul class="product-balance-group">';r+='<li>Disponible <span class="product-balance" id="balance-available">'+o+" 0.00</span></li>";r+='<li>A debitar <span class="product-balance debitar" id="balance-debit">'+o+" 0.00</span></li>";r+="</ul>";r+="</div>";$("#donor").append(r);$.post(base_url+"/dashboard/saldo",{tarjeta:$(this).attr("card")},function(y){var x=y.disponible;if(typeof x!="string"){x="---"}$("#balance-available").html(o+x);$("#balance-available").attr("saldo",x)});$(".product-button").removeClass("disabled-button");$("#agregarCuenta").attr("href","#");$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item");$.each($(".dashboard-item"),function(y,x){if($(this).hasClass("current-dashboard-item")){$(this).removeClass("current-dashboard-item")}});$(this).addClass("current-dashboard-item");$("#content-product").dialog("close");$(".stack-item").click(function(){$("#tdestino").children().remove();$("#tdestino").append($("#removerDestino").html());$("#continuar").attr("disabled",true);$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(x,y){$(".ui-dialog-titlebar-close",y.dialog).hide()}})});$.post("transferencia/ctaDestino",{nroTarjeta:$(this).attr("card"),prefijo:$(this).attr("prefix"),operacion:"P2P"},function(x){if(x.rc==-150){$("#content_plata").children().remove();$("#tabs-menu").children().remove();$("#content_plata").append($("#content-no-afil").html());$("#content-no-afil").children().remove();$("#content-destino").dialog("close")}if(x.rc==-0){montoMaxOperaciones=x.parametrosTransferencias[0].montoMaxOperaciones;montoMinOperaciones=x.parametrosTransferencias[0].montoMinOperaciones;montoMaxDiario=x.parametrosTransferencias[0].montoMaxDiario;montoMaxSemanal=x.parametrosTransferencias[0].montoMaxSemanal;montoMaxMensual=x.parametrosTransferencias[0].montoMaxMensual;cantidadOperacionesDiarias=x.parametrosTransferencias[0].cantidadOperacionesDiarias;cantidadOperacionesSemanales=x.parametrosTransferencias[0].cantidadOperacionesSemanales;cantidadOperacionesMensual=x.parametrosTransferencias[0].cantidadOperacionesMensual;montoAcumDiario=x.parametrosTransferencias[0].montoAcumDiario;montoAcumSemanal=x.parametrosTransferencias[0].montoAcumSemanal;montoAcumMensual=x.parametrosTransferencias[0].montoAcumMensual;acumCantidadOperacionesDiarias=x.parametrosTransferencias[0].acumCantidadOperacionesDiarias;acumCantidadOperacionesSemanales=x.parametrosTransferencias[0].acumCantidadOperacionesSemanales;acumCantidadOperacionesMensual=x.parametrosTransferencias[0].acumCantidadOperacionesMensual;dobleAutenticacion=x.parametrosTransferencias[0].dobleAutenticacion;$("#dashboard-beneficiary").empty();$.each(x.cuentaDestinoPlata,function(z,y){imagen1=y.nombre_producto.toLowerCase();imagen2=h(imagen1);imagen3=imagen2.replace(" ","-");imagen4=imagen3.replace(" ","-");v=imagen4.replace("/","-");r=" <li class='dashboard-item "+y.nomEmp+" muestraDestino' card='"+y.noTarjeta+"' nombre='"+y.NombreCliente+"' marca='"+y.marca+"' mascara='"+y.noTarjetaConMascara+"' empresa='"+y.nomEmp+"' producto='"+y.nombre_producto+"'>";r+="<a rel='section' class='escogerDestino'>";r+="<img src='"+base_cdn+"/img/products/"+pais+"/"+v+".png' width='200' height='130' alt='' />";r+="<div class='dashboard-item-network "+y.marca.toLowerCase()+"'>"+y.marca+"</div>";r+="<div class='dashboard-item-info'>";r+="<p class='dashboard-item-cardholder'>"+y.NombreCliente+"</p>";r+="<p class='dashboard-item-cardnumber'>"+y.noTarjetaConMascara+"</p>";r+="<p class='dashboard-item-category'>"+y.nombre_producto+"</p>";r+="</div>";r+=" </a>";r+="</li>";$("#dashboard-beneficiary").append(r)})}if(x.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}$(".muestraDestino").click(function(){if($(this).hasClass("disabled-dashboard-item")==true){$("#content-destino").dialog("close")}else{var G,D,B,z,H,E,C,F;G=$(this).find("img").attr("src");D=$(this).attr("card");B=$(this).attr("marca");z=$(this).attr("mascara");H=$(this).attr("producto");E=$(this).attr("empresa");F=$(this).attr("nombre");$(".edit").remove();var A=l();C='<div class="group"> ';C+='<div class="product-presentation">';C+='<img src="'+G+'" width="200" height="130" alt="" />';C+='<div class="product-network '+B.toLowerCase()+'"></div>';C+='<input id="tarjetaDestino" name="tarjetaDestino" type="hidden" value="'+D+'" />';C+='<input id="marcaDestino" name="marcaDestino" type="hidden" value="'+o+'" />';C+='<input id="marca" name="marcaDestino" type="hidden" value="'+H+'" />';C+="</div>";C+='<div class="product-info">';C+='<p class="product-cardholder">'+F+"</p>";C+='<p class="product-cardnumber">'+z+"</p>";C+='<p class="product-metadata">'+H+"</p>";C+='<nav class="product-stack">';C+='<ul class="stack">';C+='<li class="stack-item modifica">';C+='<a rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';C+="</li>";C+='<li class="stack-item elimina">';C+='<a rel="section" title="Remover"><span aria-hidden="true" class="icon-cancel"></span></a>';C+="</li>";C+="</ul>";C+="</nav>";C+="</div>";C+='<div class="product-scheme">';C+='<fieldset class="form-inline">';C+='<label for="beneficiary-1x-description" title="Descripción de la transferencia.">Concepto</label>';C+='<input class="field-large mont" id="beneficiary-'+A+'x-description" maxlength="60" name="beneficiary-1x-description" type="text" />';C+='<label for="beneficiary-1x-amount" title="Monto a transferir.">Importe</label>';C+='<div class="field-category"> '+o+" ";C+='<input id="beneficiary-1x-coin" name="beneficiary-1x-coin" type="hidden" value="'+o+'."/>';C+="</div>";C+='<input class="field-small monto dinero" id="beneficiary-'+A+'-amount" maxlength="12" name="beneficiary-1x-amount"/> <br/>';C+="</fieldset></div></div>";$("#content_plata #tdestino").append(C);$("#beneficiary-1x").removeClass("obscure-group");$("#content-destino").dialog("close");$("#tdestino").children("#btn-destino").remove();$("#tdestino").append($("#removerDestino").html());g();var y=$(".monto").val().replace(",",".");$("#content_plata").on("keyup",".monto",function(){var I=$(this).val();if((pais=="Pe")||(pais=="Usd")){expr=/^-?[0-9]+([\.][0-9]{0,2})?$/;saldo_imp=$("#balance-available").attr("saldo").replace(",","")}if((pais=="Ve")||(pais=="Co")){expr=/^-?[0-9]+([\,][0-9]{0,2})?$/;saldo_imp1=$("#balance-available").attr("saldo").replace(".","");saldo_imp=saldo_imp1.replace(",",".")}if(!expr.test(I)){if((pais=="Pe")||(pais=="Usd")){$("#dialog-error-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(J,K){$(".ui-dialog-titlebar-close",K.dialog).hide()}});$("#monto_invalido").click(function(){$("#dialog-error-monto").dialog("close")})}if((pais=="Ve")||(pais=="Co")){$("#dialog-error-monto-vc").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(J,K){$(".ui-dialog-titlebar-close",K.dialog).hide()}});$("#monto_invalido_vc").click(function(){$("#dialog-error-monto-vc").dialog("close")})}$(this).val("")}y=$(this).val().replace(",",".");if((parseFloat(y))>saldo_imp){$("#dialog-max-monto1").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(J,K){$(".ui-dialog-titlebar-close",K.dialog).hide()}});$("#monto_inv").click(function(){$("#dialog-max-monto1").dialog("close")});$(this).val("")}if((parseFloat(y))>parseFloat(montoMaxOperaciones)){$("#dialog-max-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(J,K){$(".ui-dialog-titlebar-close",K.dialog).hide()}});$("#monto_invalido1").click(function(){$("#dialog-max-monto").dialog("close")});$(this).val("")}if((parseFloat(y)+parseFloat(montoAcumMensual))>parseFloat(montoMaxMensual)){$("#dialog-min-monto2").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(J,K){$(".ui-dialog-titlebar-close",K.dialog).hide()}});$("#monto_invalido3").click(function(){$("#dialog-min-monto2").dialog("close")});$(this).val("");$("#balance-debit").html(m+d().toFixed(2))}else{if((parseFloat($(this).val())+parseFloat(montoAcumDiario))>parseFloat(montoMaxDiario)){$("#dialog-min-monto3").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(J,K){$(".ui-dialog-titlebar-close",K.dialog).hide()}});$("#monto_invalido4").click(function(){$("#dialog-min-monto3").dialog("close")});$(this).val("");$("#balance-debit").html(m+d().toFixed(2))}else{m=$(".dashboard-item").attr("moneda");$(this).parents(".group").attr("montInput",$(this).val());$(this).val().replace(",",".");$("#balance-debit").html(m+d().toFixed(2))}}});c();if(A>=3){$("#tdestino").children("#btn-destino").remove()}if(A>=1){$("#continuar").removeAttr("disabled")}else{$("#continuar").attr("disabled","")}}})});$(".modifica").click(function(){$(this).parents(".group").addClass("edit");$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",beforeClose:function(x,y){$(".group").removeClass("edit")},open:function(x,y){$(".ui-dialog-titlebar-close",y.dialog).hide()}})});$("#content_plata").on("click",".elimina",function(){m=$(".dashboard-item").attr("moneda");suma=d();if(suma!=0){montoR1=$(this).parents(".group").attr("montInput").replace(",",".");montoRestar=parseFloat(montoR1)}else{montoRestar=0}saldo1=suma-montoRestar;saldo=saldo1.toFixed(2);if((saldo<0)||isNaN(saldo)){$("#balance-debit").html(m+0)}else{$("#balance-debit").html(m+saldo)}$(this).parents(".group").remove();g();if($("#tdestino").find("#btn-destino").length==0){$("#tdestino").append($("#removerDestino").html());c()}if(l()>1){$("#continuar").removeAttr("disabled")}else{$("#continuar").attr("disabled","")}});c()});$("#content_plata").on("click",".confir",function(){var o=true;var q=0;$("#validate").submit();$("#montoTotal").remove();$("#tdestino").append("<input id='montoTotal' name='montoTotal' type='hidden' class='checkTotal' value='' />");$("#montoTotal").val(d());total=d();console.info(total);saldo=saldo_imp;valor_concepto1=$("#beneficiary-1x-description").val();valor_concepto2=$("#beneficiary-2x-description").val();valor_concepto3=$("#beneficiary-3x-description").val();if((valor_concepto1=="")||(valor_concepto2=="")||(valor_concepto3=="")){$("#campos_vacios").dialog({title:"Error Campos",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#error_campos").click(function(){$("#campos_vacios").dialog("close")});o=false}if(parseFloat(total)>saldo){$("#dialog-error-monto9").dialog({title:"Error Monto",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#error_monto9").click(function(){$("#dialog-error-monto9").dialog("close")});o=false}if(parseFloat(acumCantidadOperacionesDiarias)+parseFloat(q)>=parseFloat(cantidadOperacionesDiarias)){$("#dialog-cant-ope1").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#cant_ope1").click(function(){$("#dialog-cant-ope1").dialog("close")});o=false}if(parseFloat(acumCantidadOperacionesSemanales)+parseFloat(q)>=parseFloat(cantidadOperacionesSemanales)){$("#dialog-cant-ope-sm").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#cant_ope_sm").click(function(){$("#dialog-cant-ope-sm").dialog("close")});o=false}if(parseFloat(acumCantidadOperacionesMensual)+parseFloat(q)>parseFloat(cantidadOperacionesMensual)){$("#dialog-cant-ope2").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#cant_ope2").click(function(){$("#dialog-cant-ope2").dialog("close")});o=false}valor_monto1=$("#beneficiary-1-amount").val();valor_monto2=$("#beneficiary-2-amount").val();valor_monto3=$("#beneficiary-3-amount").val();if((parseFloat(valor_monto1)<parseFloat(montoMinOperaciones))||(parseFloat(valor_monto2)<parseFloat(montoMinOperaciones))||(parseFloat(valor_monto3)<parseFloat(montoMinOperaciones))){$("#dialog-min-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#monto_invalido2").click(function(){$("#dialog-min-monto").dialog("close")});$(this).val("");o=false}if(parseFloat(total)>parseFloat(montoMaxOperaciones)){$("#dialog-error-monto1").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#error_monto1").click(function(){$("#dialog-error-monto1").dialog("close")});o=false}if(parseFloat(total)<parseFloat(montoMinOperaciones)){$("#dialog-error-monto2").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#error_monto2").click(function(){$("#dialog-error-monto2").dialog("close")});o=false}if((parseFloat(total)+parseFloat(montoAcumDiario))>parseFloat(montoMaxDiario)){$("#dialog-error-monto7").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#error_monto7").click(function(){$("#dialog-error-monto7").dialog("close")});o=false}else{if((parseFloat(total)+parseFloat(montoAcumSemanal))>parseFloat(montoMaxSemanal)){$("#dialog-error-monto-sm").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#error_monto_sm").click(function(){$("#dialog-error-monto-sm").dialog("close")});o=false}else{if((parseFloat(total)+parseFloat(montoAcumMensual))>parseFloat(montoMaxMensual)){$("#dialog-error-monto8").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}});$("#error_monto8").click(function(){$("#dialog-error-monto8").dialog("close")});o=false}}}totaldef=parseFloat(valor_monto1)+parseFloat(valor_monto2)+parseFloat(valor_monto3);if(o==true){var s,v,u;v=$("#donor").find(".product-cardholder").html();u=$("#donor").find(".product-cardnumber").html();numeroCtaOrigen=$("#donor").find("#donor-cardnumber-origen").attr("cardOrigen");nombreCtaOrigen=$("#donor").find("#nombreCtaOrigen").html();banco=$("#donor").find(".banco").html();marca=$("#donor").find(".product-metadata").html();s="<tr>";s+='<td class="data-label"><label>Cuenta Origen</label></td>';s+='<td class="data-reference" id="nombreOrigenTransfer" colspan="2" numeroCtaOrigen="'+numeroCtaOrigen+'" nombreCtaOrigen="'+nombreCtaOrigen+'">'+v+'<br /><span class="highlight" id="mascaraOrigenTransfer">'+u+'</span><br /><span class="lighten"> '+marca+" </span></td>";s+="</tr>";$("#cargarConfirmacion").append(s);var t;var p=0;montodef=0;$.each($("#tdestino").children(":not(.obscure-group, .checkTotal)"),function(D,z){var x,B,A,w,C;p=p+1;B=$(z).find(".product-cardholder").html();A=$(z).find(".product-cardnumber").html();w=$(z).find("#beneficiary-"+p+"-amount").val();montodef=parseFloat($(z).find("#beneficiary-"+p+"-amount").val())+montodef;C=$(z).find("#beneficiary-"+p+"x-description").val();marcad=$(z).find("#marca").val();ctnDestino=$(z).find("#tarjetaDestino").val();id_afil=$(z).find(".id_afiliacion").val();if((pais=="Ve")||(pais=="Co")){var y=$(".product-scheme").find(".debitar").html().replace(/Bs./g,"");total1=y.replace(".",",")}else{var y=$(".product-scheme").find(".debitar").html().replace(/S../g,"");total1=y}moneda=$(".dashboard-item").attr("moneda");q=q+1;x='<tr class="trdestino" card="'+ctnDestino+'" id_afil="'+id_afil+'" nombre="'+B+'" monto="'+w+'" concepto="'+C+'" moneda="'+moneda+'" mascara="'+A+'" marca="'+marcad+'">';x+='<td class="data-label"><label>Cuentas Destino</label></td>';x+='<td class="data-reference" id="nombreDestinoTransfer">'+B+'<br /><span class="highlight" id="mascaraDestinoTransfer">'+A+'</span><br /><span class="lighten"> '+marcad+" </span></td>";x+='<td class="data-metadata data-resultado">';x+='<div class="data-indicator">';x+='<span aria-hidden="true" class="iconoTransferencia"></span>';x+='</div><span class="data-metadata" id="conceptoDestino"><strong>Concepto: </strong>'+C+'<br /><strong>Monto: </strong> <span class="money-amount" monto="'+w+'" id="montoDestinoTransfer"> '+moneda+" "+w+'<br /> </span><strong>Estatus: </strong><span class="money-amount" id="estatus">En espera por confirmación.</span></td>';x+="</td>";x+="</tr>";x+="<tr>";x+='<td class="data-spacing" colspan="3"></td>';x+="</tr>";$("#cargarConfirmacion").append(x)});$("#content_plata").children().remove();$("#content_plata").append($("#contentConfirmacion").html());$("#contentConfirmacion").remove();var r;r="<tr>";r+='<td class="data-spacing" colspan="3"></td>';r+="</tr>";r+="<tr>";r+='<td colspan="2"></td>';r+='<td class="data-metadata">Total<br /><span class="money-amount" id="mm">'+moneda+" "+total1+'</span></td> <input id="montoTotal" name="montoTotal" type="hidden" total="'+total+'" />';r+="</tr>";$("#cargarConfirmacion").append(r).html()}});$("#content_plata").on("click","#confTransfer",function(){$("#confTransfer").prop("disabled",true);var t=$("#transpwd").val();if(dobleAutenticacion=="S"){if(k()){$("#dialog-confirm").dialog({modal:true,title:"Verificación requerida.",buttons:{Cancelar:function(){$(this).dialog("close")},Aceptar:function(){var x=$("#transpwd_confirmacion").val();if(i(x)){$("#dialog-confirm").dialog("close");var A=$("#nombreOrigenTransfer").attr("numeroCtaOrigen");var B=$("#nombreOrigenTransfer").attr("nombreCtaOrigen");var D,w,y,z,C;$(".data-indicator").show();$.each($(".trdestino"),function(J,M){D=$(M).attr("card");w="";nombre1=$(M).attr("nombre");y=$(M).attr("monto").replace(",",".");z=$(M).attr("concepto");trans=f(A,D,y,z,B,w);if(trans!=false){C=true;a(C,M,trans);var E,F;nombre=$("#nombreOrigenTransfer").html();mascara=$("#mascaraOrigenTransfer").html();var I=new Date();hora=(I.getHours())+":"+I.getMinutes()+":"+I.getSeconds();var K=I.getDate();var G=I.getMonth()+1;var H=I.getFullYear();if(K<10){K="0"+K}if(G<10){G="0"+G}var L=K+"/"+G+"/"+H;E="<tr>";E+='<td class="data-label"><label>Cuenta Origen</label></td>';E+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>";E+="</tr>";$("#progress").children().remove();cabecera="<ul class='steps'>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>";cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>";cabecera+="</ul>";$("#progress").append(cabecera).html();$("#titulo").children().remove();titulo="<h2>Finalización</h2>";$("#titulo").append(titulo).html();$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else{C=false;trans="-";a(C,M,trans);$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/transferencia")})}})}},},open:function(w,x){$(".ui-dialog-titlebar-close",x.dialog).hide()}})}}else{var r=$("#nombreOrigenTransfer").attr("numeroCtaOrigen");var s=$("#nombreOrigenTransfer").attr("nombreCtaOrigen");var v,o,p,q,u;$(".data-indicator").show();$.each($(".trdestino"),function(B,E){v=$(E).attr("card");o="";nombre1=$(E).attr("nombre");p=$(E).attr("monto").replace(",",".");q=$(E).attr("concepto");trans=f(r,v,p,q,s,o);if(trans!=false){u=true;a(u,E,trans);var w,x;nombre=$("#nombreOrigenTransfer").html();mascara=$("#mascaraOrigenTransfer").html();var A=new Date();hora=(A.getHours())+":"+A.getMinutes()+":"+A.getSeconds();var C=A.getDate();var y=A.getMonth()+1;var z=A.getFullYear();if(C<10){C="0"+C}if(y<10){y="0"+y}var D=C+"/"+y+"/"+z;w="<tr>";w+='<td class="data-label"><label>Cuenta Origen</label></td>';w+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>";w+="</tr>";$("#progress").children().remove();cabecera="<ul class='steps'>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>";cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>";cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>";cabecera+="</ul>";$("#progress").append(cabecera).html();$("#titulo").children().remove();titulo="<h2>Finalización</h2>";$("#titulo").append(titulo).html();$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else{u=false;trans="-";a(u,E,trans);$("#confimacion_t").children().remove();completar1='<button id="exit">Finalizar</button>';$("#confimacion_t").append(completar1).html();$("#exit").click(function(){$(location).attr("href",base_url+"/transferencia")})}})}});function l(){var o;$.each($("#tdestino").children(),function(q,p){o=q});return o+1}function c(){$(".dialogDestino").click(function(){$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",open:function(o,p){$(".ui-dialog-titlebar-close",p.dialog).hide()}});$("#close").click(function(){$("#content-destino").dialog("close")})})}function n(){var o;$.each($(".dashboard-item"),function(q,p){o=q});tarjetas=o+1;return tarjetas}function g(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(p,o){$(o).removeClass("disabled-dashboard-item");$.each($("#tdestino").children(":not(.obscure-group)"),function(r,q){if($(q).find("#tarjetaDestino").val()==$(o).attr("card")){$(o).addClass("disabled-dashboard-item")}})})}function d(){var p=0;var o;$.each($(".dinero"),function(r,q){o=$(q).val().replace(",",".");p=p+parseFloat(o);p.toFixed(2)});if(isNaN(p)){p=0}return p}function j(p){var r;var q;$.ajaxSetup({async:false});var o={clave:hex_md5(p),};$.ajax({url:base_url+"/transferencia/operaciones",data:o,type:"post",dataType:"json",success:function(s){rpta=$.parseJSON(s.response);q=$.parseJSON(s.transferir);if(rpta.rc==0){r=true}else{r=false;q=false}if(rpta.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}}});$.ajaxSetup({async:true});return q}function k(){$.ajaxSetup({async:false});var o;$.post(base_url+"/transferencia/crearClave",function(p){if(p.rc==0){o=true}else{o=false;$("#dialog-error-clave").dialog({modal:"true",width:"440px",open:function(q,r){$(".ui-dialog-titlebar-close",r.dialog).hide()}});$("#invalido2").click(function(){$("#dialog-error-clave").dialog("close");$(location).attr("href",base_url+"/transfer")})}if(p.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}});return o}function i(o){$.ajaxSetup({async:false});var p;$.post(base_url+"/transferencia/confirmacion",{clave:hex_md5(o)},function(q){if(q.rc==0){p=true}else{p=false;$("#dialog-error-correo").dialog({title:"Contraseñas no coinciden",modal:"true",width:"440px",open:function(r,s){$(".ui-dialog-titlebar-close",s.dialog).hide()}});$("#invalido").click(function(){$("#dialog-error-correo").dialog("close")})}if(q.rc==-61){$(location).attr("href",base_url+"/users/error_gral")}});return p}function f(p,o,r,q,v,u){var t;var w;$.ajaxSetup({async:false});var s={cuentaOrigen:p,cuentaDestino:o,monto:r,descripcion:q,tipoOpe:"P2P",idUsuario:v,id_afil_terceros:u};$.ajax({url:base_url+"/transferencia/procesar",data:s,type:"post",dataType:"json",success:function(x){if(x.rc==0){w=x.dataTransaccion.referencia;t=w;$("#confTransfer").prop("disabled",false)}else{t=false;$("#confTransfer").prop("disabled",false)}if(x.rc==-61){$(location).attr("href",base_url+"/users/error_gral");$("#confTransfer").prop("disabled",false)}}});$.ajaxSetup({async:true});return t}function a(q,p,o){if(q==true){$(p).find(".data-resultado").addClass("data-success");$(p).find(".iconoTransferencia").removeClass("data-indicator icon-refresh icon-spin");$(p).find(".iconoTransferencia").addClass("icon-ok-sign");$(p).find("#estatus").empty();$(p).find("#estatus").text("Transacción exitosa. Nro. Transacción: "+o)}else{$(p).find(".data-resultado").addClass("data-error");$(p).find(".iconoTransferencia").removeClass("data-indicator data-indicator icon-refresh icon-spin");$(p).find(".iconoTransferencia").addClass("icon-cancel-sign");$(p).find("#estatus").empty();$(p).find("#estatus").text("Transacción fallida.")}}function b(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(p,o){if(montoMaxDiario==montoAcumDiario){$(o).addClass("disabled-dashboard-item");alert("Para esta operacion usted supera el monto maximo diario de transferencias")}else{if(montoMaxMensual==montoAcumMensual){$(o).addClass("disabled-dashboard-item");alert("Para esta operacion usted supera el monto maximo diario de transferencias")}}})}function h(r){var q="ÃÀÁÄÂÈÉËÊÌÍÏÎÒÓÖÔÙÚÜÛãàáäâèéëêìíïîòóöôùúüûÑñÇç";var p="AAAAAEEEEIIIIOOOOUUUUaaaaaeeeeiiiioooouuuunncc";for(var o=0;o<q.length;o++){r=r.replace(q.charAt(o),p.charAt(o))}return r}$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(o,p){$(".ui-dialog-titlebar-close",p.dialog).hide()}});$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});