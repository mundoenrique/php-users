var path,base_cdn;path=window.location.href.split("/"),base_cdn=path[0]+"//"+path[2].replace("online","cdn")+"/"+path[3],base_url=path[0]+"//"+path[2]+"/"+path[3];var dobleAutenticacion,claveValida,claveC,confirpass,rpta1,montoMaxDiario,montoMaxMensual,montoMasComision,saldo_imp;$(function(){function a(){var a;return $.each($("#tdestino").children(),function(o,t){a=o}),a+1}function o(){$(".dialogDestino").click(function(){$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#close").click(function(){$("#content-destino").dialog("close")})})}function t(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(a,o){$(o).removeClass("disabled-dashboard-item"),$.each($("#tdestino").children(":not(.obscure-group)"),function(a,t){$(t).find(".tarjetaDestino").val()==$(o).attr("card")&&$(o).addClass("disabled-dashboard-item")})})}function e(){$.each($("#dashboard-beneficiary").children(".dashboard-item"),function(a,o){montoMaxDiario==montoAcumDiario?($(o).addClass("disabled-dashboard-item"),alert("Para esta operacion usted supera el monto maximo diario de transferencias")):montoMaxMensual==montoAcumMensual&&($(o).addClass("disabled-dashboard-item"),alert("Para esta operacion usted supera el monto maximo diario de transferencias"))})}function i(){var a,o=0;return $.each($(".monto"),function(t,e){a=$(e).val().replace(",","."),o+=parseFloat(a),o.toFixed(2)}),isNaN(o)&&(o=0),o}function n(a){var o,t;return $.ajaxSetup({async:!1}),$.post(base_url+"/transferencia/operaciones",{clave:hex_md5(a)},function(a){rpta=$.parseJSON(a.response),t=$.parseJSON(a.transferir),0==rpta.rc?o=!0:(o=!1,t=!1),rpta.rc==-61&&$(location).attr("href",base_url+"/users/error_gral")}),t}function r(){$.ajaxSetup({async:!1});var a;return $.post(base_url+"/transferencia/crearClave",function(o){0==o.rc?a=!0:(a=!1,$("#dialog-error-clave").dialog({modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#invalido2").click(function(){$("#dialog-error-clave").dialog("close"),$(location).attr("href",base_url+"/transfer/index_bank")})),o.rc==-61&&$(location).attr("href",base_url+"/users/error_gral")}),a}function s(a){$.ajaxSetup({async:!1});var o;return $.post(base_url+"/transferencia/confirmacion",{clave:hex_md5(a)},function(a){0==a.rc?o=!0:(o=!1,$("#dialog-error-correo").dialog({title:"Contraseñas no coinciden",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#invalido").click(function(){$("#dialog-error-correo").dialog("close")})),a.rc==-61&&$(location).attr("href",base_url+"/users/error_gral")}),o}function c(a,o,t,e,i,n){var r,s;$.ajaxSetup({async:!1});var c={cuentaOrigen:a,cuentaDestino:o,monto:t,descripcion:e,tipoOpe:"P2T",idUsuario:i,id_afil_terceros:n};return $.ajax({url:base_url+"/transferencia/procesar",data:c,type:"post",dataType:"json",success:function(a){0==a.rc?(s=a.dataTransaccion.referencia,r=s,$("#confirmacion_t").prop("disabled",!1)):(r={status:!1,rc:a.rc,msg:a.msg},$("#confirmacion_t").prop("disabled",!1)),a.rc==-61&&($(location).attr("href",base_url+"/users/error_gral"),$("#confirmacion_t").prop("disabled",!1))}}),$.ajaxSetup({async:!0}),r}function l(a,o,t){if(1==a)$(o).find(".data-resultado").addClass("data-success"),$(o).find(".iconoTransferencia").removeClass("data-indicator icon-refresh icon-spin"),$(o).find(".iconoTransferencia").addClass("icon-ok-sign"),$(o).find("#estatus").empty(),$(o).find("#estatus").text("Transacción exitosa. Nro. Transacción: "+t);else{var e,i=t.msg;switch(t.rc){case-340:e="Cantidad de dígitos de la cuenta es invalida.";break;case-341:e="El número de cuenta no corresponde al banco.";break;case-342:e="Número de cuenta invalido.";break;case-343:e="Su tarjeta se encuentra bloqueada, código de bloqueo: "+i.substr(34,35);break;default:e="Transacción fallida."}$(o).find(".data-resultado").addClass("data-error"),$(o).find(".iconoTransferencia").removeClass("data-indicator data-indicator icon-refresh icon-spin"),$(o).find(".iconoTransferencia").addClass("icon-cancel-sign"),$(o).find("#estatus").empty(),$(o).find("#estatus").text(e)}}var d=$("#content").attr("confirmacion");"1"==d?($("#content-clave").hide(),$("#tabs-menu").show(),$("#content_bank").show()):$("#content-clave").show(),$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")}),$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")}),$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cerrar").click(function(){$("#content-product").dialog("close")}),$.each($(".dashboard-item"),function(a,o){$.post(base_url+"/dashboard/saldo",{tarjeta:$(o).attr("card")},function(a){var t=$(".dashboard-item").attr("moneda"),e=a.disponible;"string"!=typeof e&&(e="---"),$(o).find(".dashboard-item-balance").html(t+e)})});var a=$("#dashboard-donor");a.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:!0}});var o=$("#filters-stack .option-set"),t=o.find("a");t.click(function(){var o=$(this);if(o.hasClass("selected"))return!1;var t=o.parents(".option-set");t.find(".selected").removeClass("selected"),o.addClass("selected");var e={},i=t.attr("data-option-key"),n=o.attr("data-option-value");return n="false"!==n&&n,e[i]=n,"layoutMode"===i&&"function"==typeof changeLayoutMode?changeLayoutMode(o,e):a.isotope(e),!1})}),$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item"),$(this).parents("li").addClass("current-stack-item")}),$("#continuar_transfer").click(function(){var a=$("#transpwd").val();n(a)?($("#content-clave").hide(),$("#tabs-menu").show(),$("#content_bank").show()):($("#content_clave").show(),$.balloon.defaults.classname="field-error",$.balloon.defaults.css=null,$("#transpwd").showBalloon({position:"right",contents:"Clave inválida"}),setTimeout(function(){$("#transpwd").hideBalloon()},3e3))}),$(".dashboard-item").click(function(){var n,r,s,c,l,d,p,u,f;n=$(this).find("img").attr("src"),r=$(this).attr("card"),s=$(this).attr("marca"),c=$(this).attr("mascara"),l=$(this).attr("producto1"),d=$(this).attr("empresa"),u=$(this).attr("nombre"),f=$(this).attr("prefix"),moneda=$(this).attr("moneda"),pais=$(this).attr("pais"),$("#donor").children().remove(),p='<div class="product-presentation">',p+='<img src="'+n+'" width="200" height="130" alt="" />',p+='<div class="product-network '+s.toLowerCase()+'"></div>',p+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" cardOrigen="'+r+'" />',p+="</div>",p+='<div class="product-info">',p+='<p class="product-cardholder" id="nombreCtaOrigen">'+u+"</p>",p+='<p class="product-cardnumber">'+c+"</p>",p+='<p class="product-metadata">'+l+"</p>",p+='<nav class="product-stack">',p+='<ul class="stack">',p+='<li class="stack-item">',p+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>',p+="</li>",p+="</ul>",p+="</nav>",p+="</div>",p+='<div class="product-scheme">',p+='<ul class="product-balance-group">',p+='<li>Disponible <span class="product-balance" id="balance-available">'+moneda+" 0,00</span></li>",p+='<li>A debitar <span class="product-balance debitar" id="balance-debit">'+moneda+" 0,00</span></li>",p+="</ul>",p+="</div>",$("#donor").append(p),$.post(base_url+"/dashboard/saldo",{tarjeta:$(this).attr("card")},function(a){var o=a.disponible;"string"!=typeof o&&(o="---"),$("#balance-available").attr("saldo",o),$("#balance-available").html(moneda+o)}),$(".product-button").removeClass("disabled-button"),$("#agregarCuenta").attr("href","#"),$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item"),$.each($(".dashboard-item"),function(a,o){$(this).hasClass("current-dashboard-item")&&$(this).removeClass("current-dashboard-item")}),$(this).addClass("current-dashboard-item"),$("#content-product").dialog("close"),$(".stack-item").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}})}),$.post(base_url+"/transferencia/ctaDestino",{nroTarjeta:$(this).attr("card"),prefijo:$(this).attr("prefix"),operacion:"P2T"},function(n){n.rc==-150&&($("#content_bank").children().remove(),$("#tabs-menu").children().remove(),$("#content_bank").append($("#content-no-afil").html()),$("#content-no-afil").children().remove()),0==n.rc&&(montoMaxOperaciones=n.parametrosTransferencias[0].montoMaxOperaciones,montoMinOperaciones=n.parametrosTransferencias[0].montoMinOperaciones,montoMaxDiario=n.parametrosTransferencias[0].montoMaxDiario,montoMaxSemanal=n.parametrosTransferencias[0].montoMaxSemanal,montoMaxMensual=n.parametrosTransferencias[0].montoMaxMensual,cantidadOperacionesDiarias=n.parametrosTransferencias[0].cantidadOperacionesDiarias,cantidadOperacionesSemanales=n.parametrosTransferencias[0].cantidadOperacionesSemanales,cantidadOperacionesMensual=n.parametrosTransferencias[0].cantidadOperacionesMensual,montoAcumDiario=n.parametrosTransferencias[0].montoAcumDiario,montoAcumSemanal=n.parametrosTransferencias[0].montoAcumSemanal,montoAcumMensual=n.parametrosTransferencias[0].montoAcumMensual,acumCantidadOperacionesDiarias=n.parametrosTransferencias[0].acumCantidadOperacionesDiarias,acumCantidadOperacionesSemanales=n.parametrosTransferencias[0].acumCantidadOperacionesSemanales,acumCantidadOperacionesMensual=n.parametrosTransferencias[0].acumCantidadOperacionesMensual,montoComision=n.parametrosTransferencias[0].montoComision,dobleAutenticacion=n.parametrosTransferencias[0].dobleAutenticacion,console.info(montoAcumSemanal),$("#dashboard-beneficiary").empty(),$.each(n.cuentaDestinoTercero,function(a,o){var t,e=Math.floor(5*Math.random())+1,i="bank-"+e;t=" <li class='dashboard-item muestraDestino' id='datos_ctaD' card='"+o.noCuenta+"' comision='"+montoComision+"' marca='"+o.marca+"' nombre='"+o.beneficiario+"' mascara='"+o.noCuentaConMascara+"' empresa='"+o.nomEmp+"' id_afiliacion='"+o.id_afiliacion+"' producto='"+o.banco.replace(" ","-")+"'>",t+="<a rel='section'>",t+="<img src='"+base_cdn+"/img/products/default/"+i+".png' width='200' height='130' alt='' />",t+="<div class='dashboard-item-info'>",t+="<p class='dashboard-item-cardholder'>"+o.beneficiario+"</p>",t+="<p class='dashboard-item-cardnumber'>"+o.noCuentaConMascara+"</p>",t+="<p class='dashboard-item-category'>"+o.banco+"</p>",t+="</div>",t+=" </a>",t+="</li>",$("#dashboard-beneficiary").append(t)})),n.rc==-61&&$(location).attr("href",base_url+"/users/error_gral"),$(".muestraDestino").click(function(){if(1==$(this).hasClass("disabled-dashboard-item"))$("#content-destino").dialog("close");else{var e,n,r,s,c,l,d,p,u,f;e=$(this).find("img").attr("src"),n=$(this).attr("card"),s=$(this).attr("mascara"),r=$(this).attr("marca"),c=$(this).attr("producto"),l=$(this).attr("empresa"),p=$(this).attr("nombre"),u=$(this).attr("id_afiliacion"),f=$(this).attr("producto"),comision=$(this).attr("comision"),moneda=$(".dashboard-item").attr("moneda"),$(".edit").remove();var h=a();d='<div class="group"> ',d+='<div class="product-presentation">',d+='<img src="'+e+'" width="200" height="130" alt="" />',d+='<div class=""></div>',d+='<input class="tarjetaDestino" name="tarjetaDestino" type="hidden" value="'+n+'" />',d+='<input class="id_afiliacion" name="id_afil" type="hidden" value="'+u+'" />',d+='<input class="banco" name="banco" type="hidden" value="'+f+'" /> <input class="comision" name="comision" type="hidden" value="'+comision+'" /> <input class="marca" name="marca" type="hidden" value="'+r+'" />',d+="</div>",d+='<div class="product-info">',d+='<p class="product-cardholder">'+p+"</p>",d+='<p class="product-cardnumber">'+s+"</p>",d+='<p class="product-metadata">'+c+"</p>",d+='<nav class="product-stack">',d+='<ul class="stack">',d+='<li class="stack-item modifica">',d+='<a rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>',d+="</li>",d+='<li class="stack-item elimina">',d+='<a rel="section" title="Remover"><span aria-hidden="true" class="icon-cancel"></span></a>',d+="</li>",d+="</ul>",d+="</nav>",d+="</div>",d+='<div class="product-scheme">',d+='<fieldset class="form-inline">',d+='<label for="beneficiary-1x-description" title="Descripción de la transferencia.">Concepto</label>',d+='<input class="field-large" id="beneficiary-'+h+'x-description" maxlength="60" name="beneficiary-1x-description" type="text" />',d+='<label for="beneficiary-1x-amount" title="Monto a transferir.">Importe</label>',d+='<div class="field-category" > '+moneda,d+='<input id="beneficiary-1x-coin" class="importe" name="beneficiary-1x-coin" type="hidden" value="'+moneda+'." />',d+="</div>",d+='<input class="field-small monto" id="beneficiary-'+h+'-amount" maxlength="12" name="beneficiary-1x-amount" type="text" />',d+="</fieldset></div></div>",$("#tdestino").append(d),$("#beneficiary-1x").removeClass("obscure-group"),$("#content-destino").dialog("close"),$("#tdestino").children("#btn-destino").remove(),$("#tdestino").append($("#removerDestino").html()),t();var b=$(".monto").val().replace(",",".");$("#content_bank").on("keyup",".monto",function(){var a=$(this).val();"Pe"!=pais&&"Usd"!=pais||(expr=/^-?[0-9]+([\.][0-9]{0,2})?$/,saldo_imp=$("#balance-available").attr("saldo").replace(",","")),"Ve"!=pais&&"Co"!=pais||(expr=/^-?[0-9]+([\,][0-9]{0,2})?$/,saldo_imp1=$("#balance-available").attr("saldo").replace(".",""),saldo_imp=saldo_imp1.replace(",",".")),expr.test(a)||("Pe"!=pais&&"Usd"!=pais||($("#dialog-error-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido").click(function(){$("#dialog-error-monto").dialog("close")})),"Ve"!=pais&&"Co"!=pais||($("#dialog-error-monto-vc").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido_vc").click(function(){$("#dialog-error-monto-vc").dialog("close")})),$(this).val("")),b=$(this).val().replace(",","."),parseFloat(b)>saldo_imp&&($("#dialog-max-monto1").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_inv").click(function(){$("#dialog-max-monto1").dialog("close")}),$(this).val("")),parseFloat(b)>parseFloat(montoMaxOperaciones)&&($("#dialog-max-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido1").click(function(){$("#dialog-max-monto").dialog("close")}),$(this).val("")),parseFloat(b)+parseFloat(montoAcumMensual)>parseFloat(montoMaxMensual)?($("#dialog-min-monto2").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido3").click(function(){$("#dialog-min-monto2").dialog("close")}),$(this).val(""),$("#balance-debit").html(m+i().toFixed(2))):parseFloat($(this).val())+parseFloat(montoAcumDiario)>parseFloat(montoMaxDiario)?($("#dialog-min-monto3").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido4").click(function(){$("#dialog-min-monto3").dialog("close")}),$(this).val(""),$("#balance-debit").html(m+i().toFixed(2))):(m=$(".dashboard-item").attr("moneda"),$(this).parents(".group").attr("montInput",$(this).val()),$(this).val().replace(",","."),$("#balance-debit").html(m+i().toFixed(2)))}),a()>=4&&$("#tdestino").children("#btn-destino").remove(),a()>=1?$("#continuar").removeAttr("disabled"):$("#continuar").attr("disabled",""),o()}}),e()}),$("#content_bank").on("click",".modifica",function(){$(this).parents(".group").addClass("edit"),$("#content-destino").dialog({title:"Selección de Cuentas Destino",modal:"true",width:"940px",beforeClose:function(a,o){$(".group").removeClass("edit")},open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}})}),$("#content_bank").on("click",".elimina",function(){m=$(".dashboard-item").attr("moneda"),suma=i(),montoRestar=parseFloat($(this).parents(".group").attr("montInput")),saldo=suma-montoRestar,saldo<0||isNaN(saldo)?$("#balance-debit").html(m+0):$("#balance-debit").html(m+saldo),$(this).parents(".group").remove(),t(),0==$("#tdestino").find("#btn-destino").length&&($("#tdestino").append($("#removerDestino").html()),o()),a()>1?$("#continuar").removeAttr("disabled"):$("#continuar").attr("disabled","")}),o()}),$("#continuar").click(function(){var a=!0,o=0;setTimeout(function(){$("#msg").fadeOut()},5e3),$("#montoTotal").remove(),$("#tdestino").append("<input id='montoTotal' name='montoTotal' type='hidden' class='checkTotal' value='' />"),$("#montoTotal").val(i()),total=i(),saldo=saldo_imp,valor_concepto1=$("#beneficiary-1x-description").val(),valor_concepto2=$("#beneficiary-2x-description").val(),valor_concepto3=$("#beneficiary-3x-description").val(),""!=valor_concepto1&&""!=valor_concepto2&&""!=valor_concepto3||($("#campos_vacios").dialog({title:"Error Campos",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_campos").click(function(){$("#campos_vacios").dialog("close")}),a=!1),parseFloat(total)+parseFloat(montoComision)>saldo&&($("#dialog-error-monto9").dialog({title:"Error Monto",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto9").click(function(){$("#dialog-error-monto9").dialog("close")}),a=!1),parseFloat(acumCantidadOperacionesDiarias)+parseFloat(o)>=parseFloat(cantidadOperacionesDiarias)?($("#dialog-cant-ope1").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cant_ope1").click(function(){$("#dialog-cant-ope1").dialog("close")}),a=!1):parseFloat(acumCantidadOperacionesSemanales)+parseFloat(o)>=parseFloat(cantidadOperacionesSemanales)?($("#dialog-cant-ope-sm").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cant_ope_sm").click(function(){$("#dialog-cant-ope-sm").dialog("close")}),a=!1):parseFloat(acumCantidadOperacionesMensual)+parseFloat(o)>parseFloat(cantidadOperacionesMensual)&&($("#dialog-cant-ope2").dialog({title:"Cantidad de Operaciones",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#cant_ope2").click(function(){$("#dialog-cant-ope2").dialog("close")}),a=!1),valor_monto1=$("#beneficiary-1-amount").val(),valor_monto2=$("#beneficiary-2-amount").val(),valor_monto3=$("#beneficiary-3-amount").val(),(parseFloat(valor_monto1)<parseFloat(montoMinOperaciones)||parseFloat(valor_monto2)<parseFloat(montoMinOperaciones)||parseFloat(valor_monto3)<parseFloat(montoMinOperaciones))&&($("#dialog-min-monto").dialog({title:"Monto no permitido",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#monto_invalido2").click(function(){$("#dialog-min-monto").dialog("close")}),$(this).val(""),a=!1),parseFloat(total)+parseFloat(montoComision)+parseFloat(montoComision)>parseFloat(montoMaxOperaciones)&&($("#dialog-error-monto1").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto1").click(function(){$("#dialog-error-monto1").dialog("close")}),a=!1),parseFloat(total)<=0&&($("#dialog-error-monto2").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto2").click(function(){$("#dialog-error-monto2").dialog("close")}),a=!1),parseFloat(total)+parseFloat(montoAcumDiario)>parseFloat(montoMaxDiario)?($("#dialog-error-monto7").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto7").click(function(){$("#dialog-error-monto7").dialog("close")}),a=!1):parseFloat(total)+parseFloat(montoAcumSemanal)>parseFloat(montoMaxSemanal)?($("#dialog-error-monto-sm").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto_sm").click(function(){$("#dialog-error-monto-sm").dialog("close")}),a=!1):parseFloat(total)+parseFloat(montoAcumMensual)>parseFloat(montoMaxMensual)&&($("#dialog-error-monto8").dialog({title:"Error monto total",modal:"true",width:"440px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#error_monto8").click(function(){$("#dialog-error-monto8").dialog("close")}),a=!1);parseFloat(valor_monto1)+parseFloat(valor_monto2)+parseFloat(valor_monto3);if(1==a){var t,e,n;e=$("#donor").find(".product-cardholder").html(),n=$("#donor").find(".product-cardnumber").html(),numeroCtaOrigen=$("#donor").find("#donor-cardnumber-origen").attr("cardOrigen"),nombreCtaOrigen=$("#donor").find("#nombreCtaOrigen").html(),banco=$("#donor").find(".banco").html(),marca=$("#donor").find(".product-metadata").html(),comision=$("#tdestino").find(".comision").val(),t="<tr>",t+='<td class="data-label"><label>Cuenta Origen</label></td>',t+='<td class="data-reference" id="nombreOrigenTransfer" colspan="2" numeroCtaOrigen="'+numeroCtaOrigen+'" nombreCtaOrigen="'+nombreCtaOrigen+'">'+e+'<br /><span class="highlight" id="mascaraOrigenTransfer">'+n+'</span><br /><span class="lighten"> '+marca+" </span></td>",t+="</tr>",$("#cargarConfirmacion").append(t);var r;r='<td class="data-label"><label>Cuentas Destino</label></td>',$("#cargarConfirmacion").append(r);var s=0;$.each($("#tdestino").children(":not(.obscure-group, .checkTotal)"),function(a,t){var e,n,r,c;if(s+=1,n=$(t).find(".product-cardholder").html(),r=$(t).find(".product-cardnumber").html(),montodef=$(t).find("#beneficiary-"+s+"-amount").val(),c=$(t).find("#beneficiary-"+s+"x-description").val(),ctnDestino=$(t).find(".tarjetaDestino").val(),banco=$(t).find(".banco").val(),id_afil=$(t).find(".id_afiliacion").val(),moneda=$(".dashboard-item").attr("moneda"),o+=1,suma=i(),montoT=suma,"Ve"==pais||"Co"==pais){var l=$(".product-scheme").find(".debitar").html().replace(/Bs./g,"");total1=l.replace(".",",")}else{var l=$(".product-scheme").find(".debitar").html().replace(/S./g,"");total1=l}monto_t=total1.replace(",","."),e='<tr class="trdestino" card="'+ctnDestino+'" id_afil="'+id_afil+'" monto='+montodef+' concepto="'+c+'" banco="'+banco+'" comision="'+comision+'">',e+='<td class="data-label"> </td>',e+='<td class="data-reference" id="nombreDestinoTransfer">'+n+'<br /><span class="highlight" id="mascaraDestinoTransfer">'+r+'</span><br /><span class="lighten" id="bancoDestinoTransfer">'+banco+"</span></td>",e+='<td class="data-metadata data-resultado">',e+='<div class="data-indicator">',e+='<span aria-hidden="true" class="iconoTransferencia"></span>',e+='</div><span class="data-metadata" id="conceptoDestino"><strong>Concepto: </strong>'+c+'<br /><strong>Monto: </strong><span class="money-amount" monto='+monto_t+' id="montoDestinoTransfer"> '+montodef+'</span><br /><strong>Estatus: </strong><span class="money-amount" id="estatus">En espera por confirmación.</span></td>',e+="</td>",e+="</tr>",e+="<tr>",e+='<td class="data-spacing" colspan="3"></td>',e+="</tr>",$("#cargarConfirmacion").append(e)}),comision=parseFloat(comision)*o,montoT=suma+comision,montoT=montoT.toString(),montoT=montoT.replace(".",","),$("#content_bank").children().remove(),$("#content_bank").append($("#contentConfirmacion").html()),$("#contentConfirmacion").remove(),montoMasComision=montoT;var c;c="<tr>",c+='<td class="data-spacing" colspan="3"></td>',c+="</tr>",c+="<tr>",c+='<td colspan="2"></td>',c+='<td class="data-metadata">Total+Comisión ('+moneda+" "+comision+')<br /><span class="money-amount" id="montocom">'+moneda+" "+montoT+"</span></td>",c+="</tr>",$("#cargarConfirmacion").append(c).html()}}),$("#content_bank").on("click","#confirmacion_t",function(){var a;if($("#confirmacion_t").prop("disabled",!0),"S"==dobleAutenticacion)r()&&$("#dialog-confirm").dialog({modal:!0,title:"Verificación requerida.",buttons:{Cancelar:function(){$(this).dialog("close")},Aceptar:function(){var o=$("#transpwd_confirmacion").val();if(s(o)){$("#dialog-confirm").dialog("close");var t,e,i,n,r,d=$("#nombreOrigenTransfer").attr("numeroCtaOrigen"),m=$("#nombreOrigenTransfer").attr("nombreCtaOrigen");$(".data-indicator").show(),$.each($(".trdestino"),function(o,s){if(t=$(s).attr("card"),e=$(s).attr("id_afil"),i=$(s).attr("monto").replace(",","."),n=$(s).attr("concepto"),comision=$(s).attr("comision"),a=c(d,t,i,n,m,e),0!=a.status){r=!0,l(r,s,a);var p;nombre=$("#nombreOrigenTransfer").html(),mascara=$("#mascaraOrigenTransfer").html();var u=new Date;hora=u.getHours()+":"+u.getMinutes()+":"+u.getSeconds();var f=u.getDate(),h=u.getMonth()+1;u.getFullYear();f<10&&(f="0"+f),h<10&&(h="0"+h);p="<tr>",p+='<td class="data-label"><label>Cuenta Origen</label></td>',p+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>",p+="</tr>",$("#bodyConfirm").append(p),$("#progress").children().remove(),cabecera="<ul class='steps'>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>",cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>",cabecera+="</ul>",$("#progress").append(cabecera).html(),$("#titulo").children().remove(),titulo="<h2>Finalización</h2>",$("#titulo").append(titulo).html();var b;b="<tr>",b+='<td colspan="2"></td>',b+='<td class="data-metadata">',b+='Total: <span class="lighten"> ('+moneda+" "+comision+' Comisión) </span> <br /><span class="money-amount"> '+moneda+" "+montoMasComision+" </span>",b+="</td>",b+="</tr>",$("#bodyConfirm").append(b).html(),$("#confimacion_b").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_b").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else r=!1,trans="-",l(r,s,a),$("#confimacion_b").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_b").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})})}}},open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}});else{var o,t,e,i,n,d=$("#nombreOrigenTransfer").attr("numeroCtaOrigen"),m=$("#nombreOrigenTransfer").attr("nombreCtaOrigen");$(".data-indicator").show(),$.each($(".trdestino"),function(r,s){if(o=$(s).attr("card"),t=$(s).attr("id_afil"),e=$(s).attr("monto").replace(",","."),i=$(s).attr("concepto"),comision=$(s).attr("comision"),a=c(d,o,e,i,m,t),0!=a.status){n=!0,l(n,s,a);var p;nombre=$("#nombreOrigenTransfer").html(),mascara=$("#mascaraOrigenTransfer").html();var u=new Date;hora=u.getHours()+":"+u.getMinutes()+":"+u.getSeconds();var f=u.getDate(),h=u.getMonth()+1;u.getFullYear();f<10&&(f="0"+f),h<10&&(h="0"+h);p="<tr>",p+='<td class="data-label"><label>Cuenta Origen</label></td>',p+='<td class="data-reference" colspan="2"><br>'+nombre+"</td>",p+="</tr>",$("#progress").children().remove(),cabecera="<ul class='steps'>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-exchange'></span> Transferir</li>",cabecera+="<li class='step-item completed-step-item'><span aria-hidden='true' class='icon-view'></span> Confirmación</li>",cabecera+="<li class='step-item current-step-item'><span aria-hidden='true' class='icon-thumbs-up'></span> Finalización</li>",cabecera+="</ul>",$("#progress").append(cabecera).html(),$("#titulo").children().remove(),titulo="<h2>Finalización</h2>",$("#titulo").append(titulo).html(),$("#confimacion_b").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_b").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})}else n=!1,trans="-",l(n,s,a),$("#confimacion_b").children().remove(),completar1='<button id="exit">Finalizar</button>',$("#confimacion_b").append(completar1).html(),$("#exit").click(function(){$(location).attr("href",base_url+"/dashboard")})})}}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(a,o){$(".ui-dialog-titlebar-close",o.dialog).hide()}}),$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});