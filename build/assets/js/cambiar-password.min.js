var base_url,base_cdn;base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),$(function(){var max=15,old=$("#old-userpwd").val(),newC=$("#userpwd").val(),cNewC=$("#confirm-userpwd").val(),$dialogo=$(this);$("#continuar").attr("disabled","disabled"),$("#userpwd").keyup(function(){var pswd=$(this).val();pswd.length<8||pswd.length>15?($("#length").removeClass("rule-valid").addClass("rule-invalid"),longitud=!1):($("#length").removeClass("rule-invalid").addClass("rule-valid"),longitud=!0),pswd.match(/[A-z]/)?($("#letter").removeClass("rule-invalid").addClass("rule-valid"),mt=!0):($("#letter").removeClass("rule-valid").addClass("rule-invalid"),mt=!1),pswd.match(/[A-Z]/)?($("#capital").removeClass("rule-invalid").addClass("rule-valid"),cap=!0):($("#capital").removeClass("rule-valid").addClass("rule-invalid"),cap=!1),!pswd.match(/((\w|[!@#$%])*\d(\w|[!@#$%])*\d(\w|[!@#$%])*\d(\w|[!@#\$%])*\d(\w|[!@#$%])*(\d)*)/)&&pswd.match(/\d{1}/)?($("#number").removeClass("rule-invalid").addClass("rule-valid"),car=!0):($("#number").removeClass("rule-valid").addClass("rule-invalid"),car=!1),pswd.match(/(.)\1{2,}/)?($("#consecutivo").removeClass("rule-valid").addClass("rule-invalid"),cons=!1):($("#consecutivo").removeClass("rule-invalid").addClass("rule-valid"),cons=!0),pswd.match(/([!@\*\-\?¡¿+\/.,_#])/)?($("#especial").removeClass("rule-invalid").addClass("rule-valid"),esp=!0):($("#especial").removeClass("rule-valid").addClass("rule-invalid"),esp=!1),1==longitud&&1==mt&&1==cap&&1==car&&1==cons&&1==esp?$("#continuar").removeAttr("disabled"):$("#continuar").attr("disabled",!0)}).focus(function(){$("#new").showBalloon({position:"right",contents:$("#psw_info")}),$("#psw_info").show()}).blur(function(){$("#new").hideBalloon({position:"right",contents:$("#psw_info")}),$("#psw_info").hide()}),$("#cancelar").click(function(){$(location).attr("href",base_url+"/perfil")}),$(".volver").click(function(){$(location).attr("href",base_url+"/perfil")}),$("#continuar").click(function(){if($("#continuar").hide(),$("#loading").show(),old=$("#old-userpwd").val(),newC=$("#userpwd").val(),cNewC=$("#confirm-userpwd").val(),valor1=!0,valor2=!0,valor3=!0,""!=old&&""!=newC&&""!=cNewC||($("#continuar").show(),$("#loading").hide(),valor1=!1,$("#dialog-clave-inv").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#invalido").click(function(){$("#dialog-clave-inv").dialog("close")})),newC==old&&($("#continuar").show(),$("#loading").hide(),valor2=!1,$("#dialog-clave-inv1").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#invalido1").click(function(){$("#dialog-clave-inv1").dialog("close")})),newC!=cNewC&&($("#continuar").show(),$("#loading").hide(),valor3=!1,$("#dialog-clave-inv2").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#invalido2").click(function(){$("#dialog-clave-inv2").dialog("close")})),1==valor1&&1==valor2&&1==valor3){$("#continuar").hide(),$("#loading").show();var cpo_cook=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));$.post(base_url+"/users/actualizarPassword",{passwordOld:old,passwordNew:newC,cpo_name:cpo_cook},function(data){-61==data.rc&&$(location).attr("href",base_url+"/users/error_gral"),0==data.rc&&($("#content").children().remove(),$("#content").append($("#confirmacion").removeAttr("style")).html(),$("#aceptar").click(function(){$(location).attr("href",base_url+"/dashboard")})),-192==data.rc&&($("#content").children().remove(),$("#msg_pass").text("Contraseña actual incorrecta. Por favor verifique sus datos."),$("#content").append($("#sinExito").removeAttr("style")).html(),$("#regresar").click(function(){$(location).attr("href",base_url+"/users/cambiarPassword?t=t")})),-199==data.rc&&($("#content").children().remove(),$("#msg_pass").text("Su contraseña no ha sido actualizada. Por favor verifique sus datos."),$("#content").append($("#sinExito").removeAttr("style")).html(),$("#regresar").click(function(){$(location).attr("href",base_url+"/users/cambiarPassword?t=t")}))})}}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});