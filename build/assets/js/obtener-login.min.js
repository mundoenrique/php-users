var base_url,base_cdn;base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),$(function(){function validar_campos(){jQuery.validator.setDefaults({debug:!0,success:"valid"}),$("#form-validar").validate({errorElement:"label",ignore:"",errorContainer:"#msg",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg",rules:{email:{required:!0,email:!0},"card-holder-id":{required:!0,number:!0}},messages:{email:"El correo electrónico NO puede estar vacío y debe contener formato correcto. (xxxxx@ejemplo.com)","card-holder-id":"Debe introducir su número de identidad"}})}$("input[type=text], input[type=password], input[type=textarea]").attr("autocomplete","off"),$("#continuar").click(function(){$("#continuar").attr("disabled",!0),$("#loading").show(),validar_campos();var cpo_cook=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),form;if($("#form-validar").append('<input type="hidden" name="cpo_name" class="ignore" value="'+cpo_cook+'">'),$("#form-validar").submit(),setTimeout(function(){$("#msg").fadeOut()},5e3),1==$("#form-validar").valid()){var email,id_ext_per;id_ext_per=$("#card-holder-id").val(),email=$("#email").val(),id_ext_per=Base64.encode(id_ext_per),email=Base64.encode(email);var cpo_cook=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),dataRequest=JSON.stringify({id_ext_per:id_ext_per,email:email});dataRequest=CryptoJS.AES.encrypt(dataRequest,cpo_cook,{format:CryptoJSAesJson}).toString(),$consulta=$.post(base_url+"/users/obtenerlogin_call",{request:dataRequest,cpo_name:cpo_cook,plot:btoa(cpo_cook)},function(response){data=JSON.parse(CryptoJS.AES.decrypt(response.code,response.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),-61==data.rc&&$(location).attr("href",base_url+"/users/error_gral"),0==data.rc?($("#content").children().remove(),$("#content").append($("#confirmacion").removeAttr("style")).html(),$("#continuar").attr("disabled",!1),$("#loading").hide()):-187==data.rc?($("#dialog-login-error").dialog({title:"Datos Erróneos",modal:"true",width:"400px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#invalido").click(function(){$("#dialog-login-error").dialog("close")}),$("#continuar").attr("disabled",!1),$("#loading").hide()):location.assign("/personas")})}else $("#continuar").attr("disabled",!1),$("#loading").hide()}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#ok").click(function(){$("#dialog-tc").dialog("close")})});var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="",chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;for(input=Base64._utf8_encode(input);i<input.length;)enc1=(chr1=input.charCodeAt(i++))>>2,enc2=(3&chr1)<<4|(chr2=input.charCodeAt(i++))>>4,enc3=(15&chr2)<<2|(chr3=input.charCodeAt(i++))>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);return output},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext}}});