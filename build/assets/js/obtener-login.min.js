var base_url,base_cdn;base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),$(function(){function e(){jQuery.validator.setDefaults({debug:!0,success:"valid"}),$("#form-validar").validate({errorElement:"label",ignore:"",errorContainer:"#msg",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg",rules:{email:{required:!0,email:!0},"card-holder-id":{required:!0,number:!0}},messages:{email:"El correo electrónico no puede estar vacío y debe contener formato correcto. (xxxxx@ejemplo.com)","card-holder-id":"Debe introducir su número de identidad"}})}$("input[type=text], input[type=password], input[type=textarea]").attr("autocomplete","off"),$("#continuar").click(function(){$("#continuar").attr("disabled",!0),$("#loading").show(),e();var o=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));$("#form-validar").append('<input type="hidden" name="cpo_name" class="ignore" value="'+o+'">'),$("#form-validar").submit(),setTimeout(function(){$("#msg").fadeOut()},5e3);var t=$("#form-validar");if(1==t.valid()){var a,n;n=$("#card-holder-id").val(),a=$("#email").val(),n=r.encode(n),a=r.encode(a);o=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));var i=JSON.stringify({id_ext_per:n,email:a});i=CryptoJS.AES.encrypt(i,o,{format:CryptoJSAesJson}).toString(),$consulta=$.post(base_url+"/users/obtenerlogin_call",{request:i,cpo_name:o,plot:btoa(o)},function(e){data=JSON.parse(CryptoJS.AES.decrypt(e.code,e.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),-61==data.rc&&$(location).attr("href",base_url+"/users/error_gral"),0==data.rc?($("#content").children().remove(),$("#content").append($("#confirmacion").removeAttr("style")).html(),$("#continuar").attr("disabled",!1),$("#loading").hide()):-187==data.rc?($("#dialog-login-error").dialog({title:"Datos Erróneos",modal:"true",width:"400px",open:function(e,r){$(".ui-dialog-titlebar-close",r.dialog).hide()}}),$("#invalido").click(function(){$("#dialog-login-error").dialog("close")}),$("#continuar").attr("disabled",!1),$("#loading").hide()):location.assign("/personas")})}else $("#continuar").attr("disabled",!1),$("#loading").hide()});var r={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var o,t,a,n,i,d,c,l="",s=0;for(e=r._utf8_encode(e);s<e.length;)o=e.charCodeAt(s++),t=e.charCodeAt(s++),a=e.charCodeAt(s++),n=o>>2,i=(3&o)<<4|t>>4,d=(15&t)<<2|a>>6,c=63&a,isNaN(t)?d=c=64:isNaN(a)&&(c=64),l=l+this._keyStr.charAt(n)+this._keyStr.charAt(i)+this._keyStr.charAt(d)+this._keyStr.charAt(c);return l},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var r="",o=0;o<e.length;o++){var t=e.charCodeAt(o);t<128?r+=String.fromCharCode(t):t>127&&t<2048?(r+=String.fromCharCode(t>>6|192),r+=String.fromCharCode(63&t|128)):(r+=String.fromCharCode(t>>12|224),r+=String.fromCharCode(t>>6&63|128),r+=String.fromCharCode(63&t|128))}return r}}});