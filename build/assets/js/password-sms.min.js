var path,base_cdn;path=window.location.href.split("/"),base_cdn=path[0]+"//"+path[2].replace("online","cdn")+"/"+path[3],base_url=path[0]+"//"+path[2]+"/"+path[3],$(function(){function e(){jQuery.validator.setDefaults({debug:!0,success:"valid"}),$("#form-validar").validate({errorElement:"label",ignore:"",errorContainer:"#msg",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg",rules:{userpwd:{required:!0,number:!0},"confirm-userpwd":{required:!0,number:!0,minlength:4,maxlength:4,equalTo:"#userpwd"}},messages:{userpwd:"El campo Clave SMS no puede estar vacío y debe contener 4 números","confirm-userpwd":"El campo Confirmación no puede estar vacío, debe contener 4 números y coincidir con el campo Clave SMS"}})}function r(){for(var e=location.search.replace("?",""),r=e.split("&"),a={},t=0;t<r.length;t++){var n=r[t].split("=%20");a[n[0]]=n[1]}return a}var a=r()["num%20"],t=r()["disponeClaveSMS%20"],n=r()["acCodPais%20"],i=r()["id_ext_per%20"];cadena="<form accept-charset='utf-8' method='post' id='form-validar'>",cadena+="<fieldset class='fieldset-column-center'>",cadena+="<div class='field-meter' id='password-strength-meter'>",cadena+="<h4>Requerimientos de contraseña:</h4>",cadena+="<ul class='pwd-rules'>",cadena+="<li id='consecutivo' class='pwd-rules-item rule-invalid'>• Debe tener <strong>4 números</strong></li>",cadena+="</ul>",cadena+="</div>",cadena+="<label>Número de teléfono</label>",cadena+="<input class='field-medium' maxlength='15' id='num_tlf' name='num_tlf' value="+a+" disabled/>",cadena+="<label for='userpwd'>Clave SMS</label>",cadena+="<input class='field-medium' maxlength='4' id='userpwd' name='userpwd' type='password' />",cadena+="<label for='confirm-userpwd'>Confirmación</label>",cadena+="<input class='field-medium' maxlength='4' id='confirm-userpwd' name='confirm-userpwd' type='password'/>",cadena+="</fieldset>",cadena+="</form>",confirmacion="<div class='form-actions'>",confirmacion+="<button id='eliminar' type='reset'>Eliminar</button>",confirmacion+="<button id='actualizar'>Actualizar</button>",confirmacion+="</div>",confirmacion1="<div class='form-actions'>",confirmacion1+="<button id='volver' type='reset'>Volver</button>",confirmacion1+="<button id='afiliar'>Afiliar</button>",confirmacion1+="</div>",$("#content-pass").append(cadena).html(),1==t?$("#content-pass").append(confirmacion).html():0==t&&$("#content-pass").append(confirmacion1).html(),$("#volver").click(function(){$(location).attr("href",base_url+"/perfil")}),$("#actualizar").click(function(){e(),$("#form-validar").submit(),setTimeout(function(){$("#msg").fadeOut()},5e3);var r=$("#form-validar");if(1==r.valid()){$("#consecutivo").removeClass("rule-invalid").addClass("rule-valid");{var t=$("#userpwd").val();$("#confirm-userpwd").val()}$("#actualizar").removeClass("disabled-button"),("Pe"==n||"Usd"==n||"Co"==n)&&(t=hex_md5(t)),$.post(base_url+"/users/passwordSmsActualizar",{id_ext_per:i,claveSMS:t,nroMovil:a},function(e){0==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#confirmaActualizar").removeAttr("style")).html(),$("#confirmar").click(function(){$(location).attr("href",base_url+"/dashboard")})),-217==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito").removeAttr("style")).html(),$("#regresar").click(function(){$(location).attr("href",base_url+"/perfil")})),-215==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito2").removeAttr("style")).html(),$("#regresar2").click(function(){$(location).attr("href",base_url+"/perfil")}))})}}),$("#eliminar").click(function(){var e="";$.post(base_url+"/users/passwordSmsEliminar",{id_ext_per:i,claveSMS:e,nroMovil:a},function(e){0==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#confirmaEliminar").removeAttr("style")).html(),$("#confirmar-eliminar").click(function(){$(location).attr("href",base_url+"/dashboard")})),-61==e.rc&&$(location).attr("href",base_url+"/users/error_gral"),-214==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito3").removeAttr("style")).html(),$("#regresar3").click(function(){$(location).attr("href",base_url+"/perfil")})),-218==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito4").removeAttr("style")).html(),$("#regresar4").click(function(){$(location).attr("href",base_url+"/perfil")})),-215==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito2").removeAttr("style")).html(),$("#regresar2").click(function(){$(location).attr("href",base_url+"/perfil")}))})}),$("#afiliar").click(function(){e(),$("#form-validar").submit(),setTimeout(function(){$("#msg").fadeOut()},5e3);var r=$("#form-validar");if(1==r.valid()){$("#consecutivo").removeClass("rule-invalid").addClass("rule-valid");{var t=$("#userpwd").val();$("#confirm-userpwd").val()}$("#actualizar").removeClass("disabled-button"),("Pe"==n||"Usd"==n||"Co"==n)&&(t=hex_md5(t)),$.post(base_url+"/users/passwordSmsNew",{id_ext_per:i,claveSMS:t,nroMovil:a},function(e){0==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#confirmaCrear").removeAttr("style")).html(),$("#continuar").click(function(){$(location).attr("href",base_url+"/dashboard")})),-61==e.rc&&$(location).attr("href",base_url+"/users/error_gral"),-213==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito5").removeAttr("style")).html(),$("#regresar5").click(function(){$(location).attr("href",base_url+"/perfil")})),-216==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito6").removeAttr("style")).html(),$("#regresar6").click(function(){$(location).attr("href",base_url+"/perfil")})),-215==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito2").removeAttr("style")).html(),$("#regresar2").click(function(){$(location).attr("href",base_url+"/perfil")})),-20==e.rc&&($("#content-pass").children().remove(),$("#content-pass").append($("#sinExito7").removeAttr("style")).html(),$("#regresar7").click(function(){$(location).attr("href",base_url+"/perfil")}))})}}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(e,r){$(".ui-dialog-titlebar-close",r.dialog).hide()}}),$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});