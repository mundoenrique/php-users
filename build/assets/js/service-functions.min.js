function viewSelect(e){var o,r,c,n,s,a=$("#lock-acount select, #lock-acount input, #continuar"),t="block",l=$("#bloqueo-cuenta");switch("key"==e&&(a=$("#change-key input, #change-key select, #continuar"),l=$("#cambio-pin"),t="change"),"recover"==e&&(a=$("#rec-key input, #continuar"),l=$("#recover-key"),t="rec"),viewControl!=e&&(a.prop("disabled",!1),resetForms(l),cleanComplete(t),$("#sendToken").remove()),viewControl=e,e){case"lock":$("#msg-block h2").text(bloqAction+"cuenta"),o=$("#lock"),r=$("#key, #replace"),c=$("#change-key, #reason-rep"),n=$("#lock-acount, #prevent-bloq"),$("#mot-sol").prop("disabled",!0),s="lockAccoun",$("#action").text(bloqAction);break;case"key":$("#msg-change h2").text("Cambio de PIN"),o=$("#key"),r=$("#lock, #replace"),c=$("#lock-acount"),n=$("#change-key"),s="changePin";break;case"replace":$("#msg-block h2").text("Solicitud de reposición"),o=$("#replace"),r=$("#key, #lock"),c=$("#change-key, #prevent-bloq"),n=$("#lock-acount, #reason-rep"),s="lockReplace";break;case"recover":$("#msg-rec h2").text("Solicitud de reposición de PIN"),o=$("#recover"),r=$("#key, #replace"),c=$("#change-key, #reason-rep"),n=$("#rec-key, #rec-clave"),s="recoverKey"}o.removeClass("service-item-unselect").addClass("service-item-select"),r.removeClass("service-item-select").addClass("service-item-unselect"),c.hide(),n.show(950),$("#continuar").attr("data-action",s)}function lock_change(e,o,r,c){var n,s="LockAccount"==o?"block":"change",a=1,t="LockAccount"==o?"lock-acount":"change-key";"recoverKey"==c&&(s="rec",t="recoverKey"),$.ajax({url:base_url+"/servicios/modelo",type:"POST",data:{data:e,model:o},datatype:"JSON",beforeSend:function(e,o){cleanBefore(s,t)},success:function(e){switch(cleanComplete(s),e.code){case 0:notiSystem(e.title,e.msg,"success","out",r);break;case 1:notiService(e.msg,"msg-lock-error","msg-lock-success",s),"lock-acount"==t?$("#lock-acount input, #lock-acount select, #continuar").prop("disabled",!1):$("#change-key input, #change-key select, #continuar").prop("disabled",!1),"lockAccoun"==c&&$("#mot-sol").prop("disabled",!0);break;case 2:notiService(e.msg,"msg-lock-error","msg-lock-success",s),"lock-acount"==t?$("#lock-acount input, #lock-acount select, #continuar").prop("disabled",!0):$("#change-key input, #change-key select, #continuar").prop("disabled",!0);break;case 3:notiSystem(e.title,e.msg,"warning","out",r);break;case 4:n=void 0!==e.cost_repos_plas&&""!==e.cost_repos_plas?e.cost_repos_plas:"",viewToken(e.msg,s,n,a);break;case 5:notiService(e.msg,"msg-lock-error","msg-lock-success","block"),$("#msg-block div").html("Presione <strong>Aquí</strong> para recibir un nuevo código de seguridad").on("click",function(){getToken(s),$("#msg-block div").unbind("click")});break;case 6:a=0,costo=void 0!==e.cost_repos_plas&&""!==e.cost_repos_plas?e.cost_repos_plas:"",viewToken(e.msg,s,costo,a);break;default:notiSystem(e.title,e.msg,"error","close",r)}},error:function(e,o,r){console.log(e),console.log(o),console.log(r)}})}function getToken(e){var o=1;$("#carry").remove(),$.ajax({url:base_url+"/servicios/modelo",type:"POST",data:{model:"GetToken"},datatype:"json",beforeSend:function(e,o){cleanBefore("block")},success:function(r){switch(cleanComplete("block"),r.code){case 4:viewToken(r.msg,e,"",o);break;case 5:notiService(r.msg,"msg-lock-error","msg-lock-success","block"),$("#msg-block div").html("Presione <strong>Aquí</strong> para recibir un nuevo código de seguridad").on("click",function(){getToken(e),$("#msg-block div").unbind("click")});break;case 2:notiSystem(r.title,r.msg,"warning","out");break;default:notiSystem(r.title,r.msg,"error","close")}},error:function(e,o,r){console.log(e),console.log(o),console.log(r)}})}function cleanBefore(e,o){"lock-acount"==o?$("#lock-acount input, #lock-acount select, #continuar").prop("disabled",!0):$("#change-key input, #change-key select, #continuar").prop("disabled",!0),$("#msg-"+e).removeClass("msg-lock-error msg-lock-success"),$("#msg-"+e+" #result-"+e).html("").append('<span aria-hidden="true" class="icon-refresh icon-spin" style="font-size: 50px;"></span>'),$("#msg-"+e+" h3").text("Estamos procesando tu solicitud"),$("#msg-"+e).show()}function cleanComplete(e){$("#msg-"+e+" h3").text(""),$("#msg-"+e+" #result-"+e).html("")}function notiService(e,o,r,c){resetForms(),$("#msg-"+c).removeClass(r).addClass(o),$("#msg-"+c+" > h3").html(e)}function notiSystem(e,o,r,c,n){var s="lock"===n||"key"===n||"replace"===n?n:null,a="lock"!=n&&"key"!=n&&"replace"!=n?n:null;resetForms(a);var t="warning"==r?"warning":"error"==r?"cancel":"ok",l=$("#msg_system");l.dialog({title:e,modal:"true",width:"440px",draggable:!1,rezise:!1,open:function(e,n){$(".ui-dialog-titlebar-close",n.dialog).hide(),"carry"==c?($("#form-action").append('<button id="carry">Si</button>'),$("#carry").focus(),$("#close-info").text("No").attr("type","reset")):$("#close-info").text("Cerrar").removeAttr("type"),$("#msg_info").removeAttr("class").addClass("alert-simple alert-"+r),$("#msg_info span").removeAttr("class").addClass("icon-"+t+"-sign"),$("#msg_info p").empty().append(o)}}),$("#close-info").on("click",function(e){switch(e.preventDefault(),$("#msg_system").dialog("close"),c){case"out":$(location).attr("href",base_url+"/servicios");break;case"close":$(location).attr("href",base_url+"/users/closeSess")}$("#carry").remove()}),$("#carry").on("click",function(e){e.preventDefault(),$("#msg_system").dialog("close"),viewSelect(s),$("#carry").remove()})}function viewToken(e,o,r,c){var n="";notiService(e,"msg-lock-success","msg-lock-error",o),"block"==o?$("#lock-acount input, #lock-acount select, #continuar").not("#mes-exp-bloq, #anio-exp-bloq, #mot-sol").prop("disabled",!1):$("#change-key input, #change-key select, #continuar").not("#mes-exp-cambio, #anio-exp-cambio, #pin-current, #new-pin, #confirm-pin").prop("disabled",!1),1===c&&(n+='<li id="sendToken" class="col-md-3-profile">',n+='<label for="token">Código de seguridad</label>',n+='<input class="field-medium" id="token" name="token" type="text">',n+="</li>"),""!==r&&($("#montoComisionTransaccion").val(r),n+='<table class="receipt" cellspacing="0" cellpadding="0"><tr><td class="data-metadata">Comisión/Pago (S/. '+r+') <br><span class="money-amount">S/. '+r+"</span></td></tr></table>"),$("#"+o+"-ul").append(n)}function validar_campos(){jQuery.validator.setDefaults({debug:!0,success:"valid"}),jQuery.validator.addMethod("tokenValid",function(e,o){var r=/^[a-zA-Z0-9]+$/,c=o.value;return!!r.test(c)}),jQuery.validator.addMethod("pinNew1",function(e,o){return o.value.length>0&&o.value==$("#new-pin").val()},"Debe ser igual al nuevo PIN"),jQuery.validator.addMethod("pinNew2",function(e,o){return!(o.value.length>0&&o.value==$("#pin-current").val())},"El nuevo PIN no debe ser igual a su PIN anterior"),$("#bloqueo-cuenta").validate({errorElement:"label",ignore:"",errorContainer:"#msg1",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg1",rules:{token:{required:!0,tokenValid:!0},"mot-sol":{required:!0}},messages:{token:{required:"Debe colocar su código de seguridad",tokenValid:"El código de seguridad no debe tener caracteres especiales"},"mot-sol":"Debe seleccionar el motivo de la reposición"}}),$("#cambio-pin").validate({errorElement:"label",ignore:"",errorContainer:"#msg2",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg2",rules:{token:{required:!0,tokenValid:!0},"pin-current":{required:!0,number:!0},"new-pin":{number:!0,pinNew2:!0,required:!0},"confirm-pin":{number:!0,pinNew1:!0}},messages:{token:{required:"Debe colocar su código de seguridad",tokenValid:"El código de seguridad no debe tener caracteres especiales"},"pin-current":{required:"Debe colocar su PIN actual",number:"Debe ser numérico"},"new-pin":{number:"Su nuevo PIN debe ser numérico",pinNew2:"El nuevo PIN no debe ser igual a su PIN anterior",required:"Debe colocar su nuevo PIN"},"confirm-pin":{number:"La confirmación de su nuevo PIN debe ser numérico",pinNew1:"Debe ser igual a su nuevo PIN"}}}),$("#recover-key").validate({errorElement:"label",ignore:"",errorContainer:"",errorClass:"field-error",validClass:"field-success",errorLabelContainer:""})}function resetForms(e){e&&e[0].reset(),$("#msg1, #msg2").children().remove(),$("#bloqueo-cuenta *, #cambio-pin *").children().removeClass("field-success field-error")}