function carga_lista_transito(e){var a,t=0,o=0;e.pendingTransactions.length>0?($.each(e.pendingTransactions,function(e,i){a=feed_item(i),$("#list-transit-detail").append(a),"-"==i.signo?t+=parseFloat(i.monto.replace(".","").replace(",",".")):o+=parseFloat(i.monto.replace(".","").replace(",","."))}),$("#estadisticas-transit").kendoChart({legend:{position:"top",visible:!1},seriesDefaults:{labels:{template:"#= category # - #= kendo.format('{0:P}', percentage)#",position:"outsideEnd",visible:!1,background:"transparent"}},seriesColors:["#E74C3C","#2ECC71"],series:[{type:"donut",overlay:{gradient:"none"},data:[{category:"Cargos",value:parseFloat(parseFloat(t).toFixed(1))},{category:"Abonos",value:parseFloat(parseFloat(o).toFixed(1))}]}],tooltip:{visible:!0,template:"#= category # - #= kendo.format('{0:P}', percentage) #"}})):($("#estadisticas-transit").css("display","none"),cadena='<div id="empty-state" style="position: static;">',cadena+="<h2>No se encontraron movimientos en tránsito</h2>",cadena+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -260px;"></span>',cadena+="</div>",$("#list-transit-detail").append(cadena)),$("#transitoToogle").prop("disabled",!1)}function carga_lista(e){var a,t;-61==e.rc&&$(location).attr("href",base_url+"/users/error_gral"),0!=e.rc?($("#estadisticas").css("display","none"),$("#list-detail").children().remove(),a='<div id="empty-state" style="position: static;">',a+="<h2>No se encontraron movimientos</h2>",a+="<p>Vuelva a realizar la búsqueda con un filtro distinto para obtener resultados.</p>",a+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -260px;"></span>',a+="</div>",$("#list-detail").append(a),reporte=!1):(reporte=!0,$("#list-detail").children().remove(),$.each(e.movimientos,function(e,a){t=feed_item(a),$("#list-detail").append(t)}),$("#estadisticas").kendoChart({legend:{position:"top",visible:!1},seriesDefaults:{labels:{template:"#= category # - #= kendo.format('{0:P}', percentage)#",position:"outsideEnd",visible:!1,background:"transparent"}},seriesColors:["#E74C3C","#2ECC71"],series:[{type:"donut",overlay:{gradient:"none"},data:[{category:"Cargos",value:parseFloat(parseFloat(e.totalCargos).toFixed(1))},{category:"Abonos",value:parseFloat(parseFloat(e.totalAbonos).toFixed(1))}]}],tooltip:{visible:!0,template:"#= category # - #= kendo.format('{0:P}', percentage) #"}}))}function feed_item(e){var a;a="+"==e.signo?"feed-income":"feed-expense";var t,o,i=e.fecha.split("/"),r=i[0],n=i[2],s=$(".product-info-full").attr("moneda");switch(i[1]){case"01":t="Ene";break;case"02":t="Feb";break;case"03":t="Mar";break;case"04":t="Abr";break;case"05":t="May";break;case"06":t="Jun";break;case"07":t="Jul";break;case"08":t="Ago";break;case"09":t="Sep";break;case"10":t="Oct";break;case"11":t="Nov";break;case"12":t="Dic"}return o='<li class="feed-item '+a+'">',o+='<div class="feed-date">'+r+'<span class="feed-date-month">'+t+'</span><span class="feed-date-year">'+n+"</span></div>","-"==e.signo?o+=e.concepto+'<span class="money-amount"> - '+s+" "+e.monto+"</span>":o+=e.concepto+'<span class="money-amount"> '+s+" "+e.monto+"</span>",o+='<ul class="feed-metadata">',o+='<li class="feed-metadata-item"><span aria-hidden="true" class="icon-file-text"></span> '+e.referencia+"</li>",o+="</ul></li>",o}var reporte;$(function(){function e(e){var a,t,o="<h2>No se encontraron movimientos</h2>";o+="<p>Vuelva a realizar la búsqueda con un filtro distinto para obtener resultados.</p>",-61==e.rc&&$(location).attr("href",base_url+"/users/error_gral"),-9999==e.rc&&(o="<h2>Atención</h2>",o+="<p>Combinación de caracteres no válida.</p>"),0!=e.rc?($("#list-detail").children().remove(),t='<div id="empty-state" style="position: static;">',t+=o,t+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -260px;"></span>',t+="</div>",$("#list-detail").append(t),reporte=!1):(reporte=!0,$("#list-detail").children().remove(),$.each(e.movimientos,function(e,t){a="+"==t.signo?"feed-income":"feed-expense";var o,i,r=t.fecha.split("/"),n=r[0],s=r[2],l=$(".product-info-full").attr("moneda");switch(r[1]){case"01":o="Ene";break;case"02":o="Feb";break;case"03":o="Mar";break;case"04":o="Abr";break;case"05":o="May";break;case"06":o="Jun";break;case"07":o="Jul";break;case"08":o="Ago";break;case"09":o="Sep";break;case"10":o="Oct";break;case"11":o="Nov";break;case"12":o="Dic"}i='<li class="feed-item '+a+'">',i+='<div class="feed-date">'+n+'<span class="feed-date-month">'+o+'</span><span class="feed-date-year">'+s+"</span></div>","-"==t.signo?i+=t.concepto+'<span class="money-amount"> - '+l+" "+t.monto+"</span>":i+=t.concepto+'<span class="money-amount"> '+l+" "+t.monto+"</span>",i+='<ul class="feed-metadata">',i+='<li class="feed-metadata-item"><span aria-hidden="true" class="icon-file-text"></span> '+t.referencia+"</li>",i+="</ul></li>",$("#list-detail").append(i)}),$("#estadisticas").kendoChart({legend:{position:"top",visible:!1},seriesDefaults:{labels:{template:"#= category # - #= kendo.format('{0:P}', percentage)#",position:"outsideEnd",visible:!1,background:"transparent"}},seriesColors:["#E74C3C","#2ECC71"],series:[{type:"donut",overlay:{gradient:"none"},data:[{category:"Cargos",value:parseFloat(parseFloat(e.totalCargos).toFixed(1))},{category:"Abonos",value:parseFloat(parseFloat(e.totalAbonos).toFixed(1))}]}],tooltip:{visible:!0,template:"#= category # - #= kendo.format('{0:P}', percentage) #"}}))}$("#transit-datail-title").hide(),$("#list-transit-detail").hide(),$("#estadisticas-transit").css("visibility","hidden");var a=new Array("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"),t=$("body").attr("data-country");if("0"==$("#filter-month").val()&&$("#period").text("reciente"),$("#buscar").on("click",function(){"0"==$("#filter-month").val()?$("#period").text("Reciente"):"1"==$("#filter-month").val()?$("#period").text("de Enero "+$("#filter-year").val()):"2"==$("#filter-month").val()?$("#period").text("de Febrero "+$("#filter-year").val()):"3"==$("#filter-month").val()?$("#period").text("de Marzo "+$("#filter-year").val()):"4"==$("#filter-month").val()?$("#period").text("de Abril "+$("#filter-year").val()):"5"==$("#filter-month").val()?$("#period").text("de Mayo "+$("#filter-year").val()):"6"==$("#filter-month").val()?$("#period").text("de Junio "+$("#filter-year").val()):"7"==$("#filter-month").val()?$("#period").text("de Julio "+$("#filter-year").val()):"8"==$("#filter-month").val()?$("#period").text("de Agosto "+$("#filter-year").val()):"9"==$("#filter-month").val()?$("#period").text("de Septiembre "+$("#filter-year").val()):"10"==$("#filter-month").val()?$("#period").text("de Octubre "+$("#filter-year").val()):"11"==$("#filter-month").val()?$("#period").text("de Noviembre "+$("#filter-year").val()):"12"==$("#filter-month").val()&&$("#period").text("de Diciembre "+$("#filter-year").val())}),$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display: block")},function(){$(".submenu-transfer").attr("style","display: none")}),$(".user").hover(function(){$(".submenu-user").attr("style","display: block")},function(){$(".submenu-user").attr("style","display: none")}),"Ec-bp"==t){var o=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),i=JSON.stringify({tarjeta:$("#card").attr("card")});i=CryptoJS.AES.encrypt(i,o,{format:CryptoJSAesJson}).toString(),$.post(base_url+"/dashboard/saldo",{request:i,cpo_name:o,plot:btoa(o)},function(e){data=JSON.parse(CryptoJS.AES.decrypt(e.code,e.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8));var a=$(".product-info-full").attr("moneda"),t=data.actual,o=data.bloqueo,i=data.disponible;"string"!=typeof t&&(t="---"),"string"!=typeof o&&(o="---"),"string"!=typeof i&&(i="---"),$("#actual").html(a+t),$("#bloqueado").html(a+o),$("#disponible").html(a+i)})}else{o=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));$.ajax({method:"POST",url:base_url+"/detalles/enTransito",data:{tarjeta:$("#card").text().trim(),idPrograma:$("#card").attr("prefix"),cpo_name:o}}).done(function(e){if(0==e.code){e=e.msg;var a=$(".product-info-full").attr("moneda"),t=e.balance.availableBalance,o=e.balance.ledgerBalance,i=e.balance.actualBalance;"string"!=typeof t&&(t="---"),"string"!=typeof o&&(o="---"),"string"!=typeof i&&(i="---"),$("#bloqueado").html(a+" "+o),$("#disponible").html(a+" "+t),$("#actual").html(a+" "+i),carga_lista_transito(e)}else $("#estadisticas-transit").css("display","none")}).fail(function(){})}o=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),i=JSON.stringify({tarjeta:$("#card").attr("card")});i=CryptoJS.AES.encrypt(i,o,{format:CryptoJSAesJson}).toString(),$.post(base_url+"/detalles/load",{request:i,cpo_name:o,plot:btoa(o)},function(a){data=JSON.parse(CryptoJS.AES.decrypt(a.code,a.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),$("#loading").hide(),e(data)}),$("#transitoToogle").click(function(){$("#period-form").hide(),$("#download").parent().hide(),$("#downloadxls").parent().hide(),$("#period").hide(),$("#list-detail").hide(),$("#estadisticas").hide(),$("#transit-datail-title").show(),$("#list-transit-detail").fadeIn(1e3),$("#estadisticas-transit").css({opacity:0,visibility:"visible",display:"block"}).animate({opacity:1},1e3)}),$("#disponibleToogle").click(function(){$("#transit-datail-title").hide(),$("#list-transit-detail").hide(),$("#estadisticas-transit").hide(),$("#period-form").show(),$("#download").parent().show(),$("#downloadxls").parent().show(),$("#period").show(),$("#list-detail").fadeIn(1e3),$("#estadisticas").fadeIn(1e3)}),$("#download").click(function(e){if(e.preventDefault(),0==reporte)$("#list-detail").children().remove(),cadena='<div id="empty-state" style="position: static;">',cadena+="<h2>No se encontraron movimientos</h2>",cadena+="<p>Vuelva a realizar la búsqueda con un filtro distinto para obtener resultados.</p>",cadena+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -260px;"></span>',cadena+="</div>",$("#list-detail").append(cadena);else{$("#tarjeta").val($("#card").attr("card")),0==$("#filter-month").val()?($("#mes").val(""),$("#anio").val("")):($("#mes").val(("0"+$("#filter-month").val()).slice(-2)),$("#anio").val($("#filter-year").val())),document.getElementById("idOperation").value="5";var a=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));$("#form").append('<input type="hidden" name="cpo_name" value="'+a+'">'),$("#form").submit()}}),$("#downloadxls").click(function(e){if(e.preventDefault(),0==reporte)$("#list-detail").children().remove(),cadena='<div id="empty-state" style="position: static;">',cadena+="<h2>No se encontraron movimientos</h2>",cadena+="<p>Vuelva a realizar la búsqueda con un filtro distinto para obtener resultados.</p>",cadena+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -260px;"></span>',cadena+="</div>",$("#list-detail").append(cadena);else{$("#tarjeta").val($("#card").attr("card")),0==$("#filter-month").val()?($("#mes").val(""),$("#anio").val("")):($("#mes").val(("0"+$("#filter-month").val()).slice(-2)),$("#anio").val($("#filter-year").val())),document.getElementById("idOperation").value="46";var a=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));$("#form").append('<input type="hidden" name="cpo_name" value="'+a+'">'),$("#form").submit()}}),$("#mes").hover(function(){$(".sub-stack").attr("style","display:block")},function(){$(".sub-stack").attr("style","display:none")}),$.each(a,function(e,a){$(".sub-stack").append('<li class="sub-stack-item"><a href="#" rel="subsection" num="'+parseInt(e+1)+'">'+a+"</a></li>")}),$("#content").on("click","#filter-month",function(){mes=$("#filter-month").val(),0==mes?($("#filter-year").prop("disabled",!0),$("#filter-year")[0].selectedIndex=0):($("#filter-year").prop("disabled",!1),0==$("#filter-year").selectedIndex&&($("#filter-year")[0].selectedIndex=1))}),$("#content").on("click","#buscar",function(){$("#list-detail").children("li").remove(),$("#estadisticas").children().remove(),$("#loading").show(),mes=$("#filter-month").val(),anio=$("#filter-year").val();var a=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));if(0==mes){var t=JSON.stringify({tarjeta:$("#card").attr("card")});t=CryptoJS.AES.encrypt(t,a,{format:CryptoJSAesJson}).toString(),$.post(base_url+"/detalles/load",{request:t,cpo_name:a,plot:btoa(a)},function(a){data=JSON.parse(CryptoJS.AES.decrypt(a.code,a.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),$("#loading").hide(),e(data)})}else{t=JSON.stringify({tarjeta:$("#card").attr("card"),mes:mes,anio:anio});t=CryptoJS.AES.encrypt(t,a,{format:CryptoJSAesJson}).toString(),$.post(base_url+"/detail/CallWsMovimientos",{request:t,cpo_name:a,plot:btoa(a)},function(a){data=JSON.parse(CryptoJS.AES.decrypt(a.code,a.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),$("#loading").hide(),e(data)})}}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(e,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});