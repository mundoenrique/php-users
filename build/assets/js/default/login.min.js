function mostrarProcesando(o,a){var e="";switch(o){case"pichincha":e="loading-pichincha.gif";break;case"latodo":e="loading-latodo.gif"}a.attr("disabled","true"),""==e?a.html('<div id="loading" class="icono-load" style="display:flex; width:20px; margin:0 auto; padding: 0 9px;"><span aria-hidden="true" class="icon-refresh icon-spin" style="font-size: 20px"></span></div>'):a.html('<img src="'+base_cdn+"img/"+e+'">'),"pichincha"==o&&(a.css({position:"relative",height:"35px",width:"100%",opacity:"1"}),a.children(0).css({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:"25px"}),"accept"==a.attr("id")&&(a.css({height:"42px",width:"auto"}),a.children(0).css({height:"32px"})))}function ocultarProcesando(){$("#login").html("Ingresar"),$("#login").prop("disabled",!1)}function habilitar(){$("#username").removeAttr("disabled"),$("#userpwd").removeAttr("disabled")}function validateCaptcha(o,a,e){cpo_cook=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),dataRequest=JSON.stringify({token:o,user:a}),dataRequest=CryptoJS.AES.encrypt(dataRequest,cpo_cook,{format:CryptoJSAesJson}).toString(),$.post(base_url+"/users/validateRecaptcha",{request:dataRequest,cpo_name:cpo_cook,plot:btoa(cpo_cook)}).done(function(o){data=JSON.parse(CryptoJS.AES.decrypt(o.code,o.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),score=$(".widget").attr("data-score-capcha"),1==data.success&&parseFloat(data.score)>parseFloat(score)?login(a,e):(ocultarProcesando(),$("#dialog-validate").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#error-validate").click(function(){$("#dialog-validate").dialog("close"),$("#userpwd").val("").attr("placeholder","Contraseña"),habilitar()}))})}function login(o=null,a=null,e={}){cpo_cook=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),dataRequest=JSON.stringify({user_name:null===o?"--":o,user_pass:null===a?"--":hex_md5(a),codeOTP:void 0===e.valueOPT?"000":e.valueOPT,saveIP:void 0!==e.saveIP&&!1!==e.saveIP}),dataRequest=CryptoJS.AES.encrypt(dataRequest,cpo_cook,{format:CryptoJSAesJson}).toString(),$.post(base_url+"/users/login",{request:dataRequest,cpo_name:cpo_cook,plot:btoa(cpo_cook)}).done(function(t){if(data=JSON.parse(CryptoJS.AES.decrypt(t.code,t.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),$.isEmptyObject(e)||($("#codeOTPLogin").prop("disabled",!1),$("#codeOTPLogin").val(""),$("#acceptAssert").prop("disabled",!1),$("#acceptAssert").prop("checked",!1),$("#accept").attr("disabled",!1),$("#accept").html("Aceptar"),$("#novo-control-ip").dialog("close")),1==data)$("#dialog-login-ve").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}});else if(0==data.rc)1==data.passwordTemp?$(location).attr("href",base_url+"/users/cambiarPassword?t=t"):1==data.passwordVencido?$(location).attr("href",base_url+"/users/cambiarPassword?t=v"):$(location).attr("href",base_url+"/dashboard");else if(-1==data.rc)ocultarProcesando(),$("#dialog-login").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#invalido").click(function(){$("#dialog-login").dialog("close"),habilitar()});else if(-5==data.rc)ocultarProcesando(),$("#sesion-activa").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#activa").click(function(){$("#sesion-activa").dialog("close"),$(location).attr("href",base_url+"/users/closeSess"),habilitar()});else if(-194==data.rc)ocultarProcesando(),$("#dialog-overlay").dialog({title:"Password Caducado",modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#caducado").click(function(){$("#dialog-overlay").dialog("close"),habilitar()});else if(-205==data.rc)ocultarProcesando(),$("#dialog-voygo-error").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#error-voygo").click(function(){$("#dialog-voygo-error").dialog("close")});else if(-35==data.rc||-8==data.rc)ocultarProcesando(),$("#dialog-bloq").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#aceptar").click(function(){$("#dialog-bloq").dialog("close"),habilitar()});else if(-424==data.rc){ocultarProcesando();var i=o,l=a;$("#novo-control-ip #email").text(data.email),$("#novo-control-ip").dialog({title:"Conexión Personas",modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#cancel").click(function(){$("#codeOTPLogin").prop("disabled",!1),$("#codeOTPLogin").val(""),$("#acceptAssert").prop("disabled",!1),$("#acceptAssert").prop("checked",!1),$("#novo-control-ip").dialog("close"),habilitar()}),$(document).on("keypress","#novo-control-ip",function(o){var a=o.keyCode||o.which;13===a&&(o.preventDefault(),$("#accept").click())}),$("#accept").click(function(o){o.preventDefault(),o.stopImmediatePropagation();var a=$("#codeOTPLogin"),e=!0;if(a.prop("disabled",!0),$("#acceptAssert").prop("disabled",!0),mostrarProcesando(skin,$(this)),e=/^[a-z0-9]+$/i.test(a.val())&&a.val().length<16,e){var t={valueOPT:a.val(),saveIP:$("#acceptAssert").prop("checked")};login(i,l,t)}else{a.prop("disabled",!1),$("#acceptAssert").prop("disabled",!1),$(this).html("Aceptar"),$(this).attr("disabled",!1);var r=""==a.val()?"Debe introducir el código recibido.":"El código no tiene un formato válido.",c=`<label for="codeOTPLogin" class="field-error">${r}</label>`;a.removeAttr("disabled").addClass("field-error"),$("#msg").html(c),$("#msg").fadeIn(),setTimeout(function(){a.removeClass("field-error"),$("#msg").fadeOut()},5e3)}})}else-286==data.rc||-287==data.rc||-288==data.rc?(ocultarProcesando(),$("#novo-control-ip-token-auth").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#aceptarIp").click(function(){$("#novo-control-ip-token-auth").dialog("close"),ocultarProcesando(),habilitar()})):(ocultarProcesando(),$("#dialog-error").dialog({title:"Conexión Personas",modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#error").click(function(){$("#dialog-error").dialog("close"),habilitar()}));"pichincha"==skin&&$("#username").val("").attr("placeholder","Usuario"),$("#userpwd").val("").attr("placeholder","Contraseña"),o="",a=""})}var cpo_cook,dataRequest,base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),skin=$("body").attr("data-app-skin");$(function(){var o,a,e=navigator.cookieEnabled;e||($("#form-login input, #form-login button").attr("disabled",!0),$("<div><h5>La funcionalidad de cookies de su navegador se encuentra desactivada.</h5><h4>Por favor vuelva activarla.</h4></div>").dialog({title:"Conexion personas Online",modal:!0,maxWidth:700,maxHeight:300,resizable:!1,close:function(){$(this).dialog("destroy")},buttons:{Aceptar:function(){$(this).dialog("destroy"),location.reload()}}})),$("#username, #userpwd").on("focus",function(){$(this).removeAttr("class").attr("placeholder","")}),$("#login").click(function(){if($("#username").removeAttr("class"),$("#userpwd").removeAttr("class"),$("#username").val($("#username").val().replace(/[ ]/g,"")),o=$("#username").val(),o=o.toUpperCase(),a=$("#userpwd").val(),""==o||""==a)return""==o&&$("#username").addClass("field-error").attr("placeholder","Campo obligatorio"),void(""==a&&$("#userpwd").addClass("field-error").attr("placeholder","Campo obligatorio"));$("#form-login input, #form-login button").attr("disabled",!0);var e=!0,t=!0;if("pichincha"==skin&&(e=/^[\w!@\*\-\?¡¿+\/.,#]+$/i.test(a),t=/^[\wñÑ*.-]+$/i.test(o)),!t||!e)return ocultarProcesando(),$("#dialog-login").dialog({modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),void $("#invalido").click(function(){$("#dialog-login").dialog("close"),habilitar()});mostrarProcesando(skin,$(this)),grecaptcha.ready(function(){grecaptcha.execute("6LdRI6QUAAAAAEp5lA831CK33fEazexMFq8ggA4-",{action:"login"}).then(function(e){validateCaptcha(e,o,a)},function(o){o||(ocultarProcesando(),habilitar(),$("#dialog-error").dialog({title:"Conexión Personas",modal:"true",width:"440px",open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#error").click(function(){$("#dialog-error").dialog("close")}))})})}),$("#slideshow").click(function(){$("#content-product").dialog({modal:!0,buttons:{Ok:function(){$(this).dialog("close")}},open:function(o,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}})})});