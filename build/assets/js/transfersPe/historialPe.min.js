var base_url,base_cdn;base_url=$("body").attr("data-app-url");base_cdn=$("body").attr("data-app-cdn");$(function(){$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")});$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")});$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(e,f){$(".ui-dialog-titlebar-close",f.dialog).hide()}});$("#cerrar").click(function(){$("#content-product").dialog("close")});var c=$("#dashboard-donor");c.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:true}});var b=$("#filters-stack .option-set"),d=b.find("a");d.click(function(){var i=$(this);if(i.hasClass("selected")){return false}var g=i.parents(".option-set");g.find(".selected").removeClass("selected");i.addClass("selected");var e={},f=g.attr("data-option-key"),h=i.attr("data-option-value");h=h==="false"?false:h;e[f]=h;if(f==="layoutMode"&&typeof changeLayoutMode==="function"){changeLayoutMode(i,e)}else{c.isotope(e)}return false})});$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item");$(this).parents("li").addClass("current-stack-item")});$(".dashboard-item").click(function(){var i,f,d,c,j,g,e,h;i=$(this).find("img").attr("src");f=$(this).attr("card");d=$(this).attr("marca").toLowerCase();c=$(this).attr("mascara");j=$(this).attr("producto1");g=$(this).attr("empresa");h=$(this).attr("nombre");$("#donor").children().remove();e='<div class="product-presentation" producto="'+j+'">';e+='<img src="'+i+'" width="200" height="130" alt="" />';e+='<div class="product-network '+d+'"></div>';e+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" cardOrigen="'+f+'"/>';e+="</div>";e+='<div class="product-info">';e+='<p class="product-cardholder" id="nombreCtaOrigen">'+h+"</p>";e+='<p class="product-cardnumber" id="mascara">'+c+"</p>";e+='<p class="product-metadata" id="marca">'+j+"</p>";e+='<nav class="product-stack">';e+='<ul class="stack">';e+='<li class="stack-item">';e+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';e+="</li>";e+="</ul>";e+="</nav>";e+="</div>";$("#donor").append(e);$(".product-button").removeClass("disabled-button");$("#agregarCuenta").attr("href","#");$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item");$.each($(".dashboard-item"),function(l,k){if($(this).hasClass("current-dashboard-item")){$(this).removeClass("current-dashboard-item")}});$(this).addClass("current-dashboard-item");$("#content-product").dialog("close");var b=$("#donor-cardnumber-origen").attr("cardorigen");mes=$("#filter-month").val();anio=$("#filter-year").val();$("#buscar").removeClass("disabled-button");$("#list-detail").children().remove();a(b,mes,anio);$(".stack-item").click(function(){$("#tdestino").children().remove();$("#tdestino").append($("#removerDestino").html());$("#botonContinuar").attr("disabled",true);$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(k,l){$(".ui-dialog-titlebar-close",l.dialog).hide()}})})});$("#content").on("click","#buscar",function(){var b=$("#donor-cardnumber-origen").attr("cardorigen");mes=$("#filter-month").val();anio=$("#filter-year").val();$("#list-detail").children().remove();console.log(mes);a(b,mes,anio)});function a(b,g,c){var e,i="Transferencia realizada",j,f,h,d="";h='<div id ="loading" class="data-indicator" style="text-align: center;">';h+='<h3 style="border-bottom: 0px;">Cargando</h3>';h+='<span aria-hidden="true" class="icon-refresh icon-spin" style="font-size: 50px;"></span>';h+="</div>";$("#carga").append(h);$.post(base_url+"/transferencia/historialSearchPe",{noTarjeta:b,tipoOperacion:"P2P",mes:g,anio:c},function(l){switch(l.code){case 0:$("#carga").children().remove();$("#list-detail").children().remove();$.each(l.listaTransferenciasRealizadas,function(s,p){if(p.estatusOperacion=="1"){j="icon-ok-sign";f="feed-success";e="Procesado";d='<div class="verified">Verificado</div>'}else{j="icon-cancel-sign";f="feed-error";e="Rechazado";i="Transferencia rechazada"}d=(p.Autorizacion===true)?'<div class="verified">Verificado</div>':"";var m=p.fechaTransferencia.split("/");var r=m[0];var n;var o=$(".dashboard-item").attr("moneda");switch(m[1]){case"01":n="Ene";break;case"02":n="Feb";break;case"03":n="Mar";break;case"04":n="Abr";break;case"05":n="May";break;case"06":n="Jun";break;case"07":n="Jul";break;case"08":n="Ago";break;case"09":n="Sep";break;case"10":n="Oct";break;case"11":n="Nov";break;case"12":n="Dic";break}var q='<li class="feed-item '+f+'">';q+='<div class="feed-date">'+r+'<span class="feed-date-month">'+n+"</span></div>";q+='<div class="feed-status">';q+='<span aria-hidden="true" class="'+j+'" title="'+e+'"></span>';q+="</div>";q+=i+": "+p.beneficiario+'<span class="money-amount">'+d+'<div class="amount-history">'+o+" "+p.montoTransferencia+"</div> </span>";q+='<ul class="feed-metadata">';q+='<li class="feed-metadata-item"><span aria-hidden="true" class="icon-mail"></span>   '+p.concepto+"</li>";q+="</ul>";q+="</li>";$("#list-detail").append(q)});break;case 1:$(location).attr("href",base_url+"/users/error_gral");break;default:$("#carga").children().remove();var k='<div id="empty-state" style="position: static;">';k+="<h2>No se encontraron movimientos</h2>";k+="<p>Vuelva a realizar la búsqueda con un filtro distinto para obtener resultados.</p>";k+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -415px;"></span>';k+="</div>";$("#list-detail").append(k);break}})}$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(b,c){$(".ui-dialog-titlebar-close",c.dialog).hide()}});$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});