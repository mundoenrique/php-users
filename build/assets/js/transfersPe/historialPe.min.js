var base_url,base_cdn;base_url=$("body").attr("data-app-url");base_cdn=$("body").attr("data-app-cdn");$(function(){$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")});$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")});$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(e,f){$(".ui-dialog-titlebar-close",f.dialog).hide()}});$("#cerrar").click(function(){$("#content-product").dialog("close")});var c=$("#dashboard-donor");c.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:true}});var b=$("#filters-stack .option-set"),d=b.find("a");d.click(function(){var i=$(this);if(i.hasClass("selected")){return false}var g=i.parents(".option-set");g.find(".selected").removeClass("selected");i.addClass("selected");var e={},f=g.attr("data-option-key"),h=i.attr("data-option-value");h=h==="false"?false:h;e[f]=h;if(f==="layoutMode"&&typeof changeLayoutMode==="function"){changeLayoutMode(i,e)}else{c.isotope(e)}return false})});$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item");$(this).parents("li").addClass("current-stack-item")});$(".dashboard-item").click(function(){var i,f,d,c,j,g,e,h;i=$(this).find("img").attr("src");f=$(this).attr("card");d=$(this).attr("marca").toLowerCase();c=$(this).attr("mascara");j=$(this).attr("producto1");g=$(this).attr("empresa");h=$(this).attr("nombre");$("#donor").children().remove();e='<div class="product-presentation" producto="'+j+'">';e+='<img src="'+i+'" width="200" height="130" alt="" />';e+='<div class="product-network '+d+'"></div>';e+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" cardOrigen="'+f+'"/>';e+="</div>";e+='<div class="product-info">';e+='<p class="product-cardholder" id="nombreCtaOrigen">'+h+"</p>";e+='<p class="product-cardnumber" id="mascara">'+c+"</p>";e+='<p class="product-metadata" id="marca">'+j+"</p>";e+='<nav class="product-stack">';e+='<ul class="stack">';e+='<li class="stack-item">';e+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';e+="</li>";e+="</ul>";e+="</nav>";e+="</div>";$("#donor").append(e);$(".product-button").removeClass("disabled-button");$("#agregarCuenta").attr("href","#");$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item");$.each($(".dashboard-item"),function(l,k){if($(this).hasClass("current-dashboard-item")){$(this).removeClass("current-dashboard-item")}});$(this).addClass("current-dashboard-item");$("#content-product").dialog("close");var b=$("#donor-cardnumber-origen").attr("cardorigen");mes=$("#filter-month").val();anio=$("#filter-year").val();$("#buscar").removeClass("disabled-button");$("#list-detail").children().remove();a(b,mes,anio);$(".stack-item").click(function(){$("#tdestino").children().remove();$("#tdestino").append($("#removerDestino").html());$("#botonContinuar").attr("disabled",true);$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(k,l){$(".ui-dialog-titlebar-close",l.dialog).hide()}})})});$("#content").on("click","#buscar",function(){var b=$("#donor-cardnumber-origen").attr("cardorigen");mes=$("#filter-month").val();anio=$("#filter-year").val();$("#list-detail").children().remove();a(b,mes,anio)});function a(c,h,d){var f,k="Transferencia realizada",l,g,j,e="";j='<div id ="loading" class="data-indicator" style="text-align: center;">';j+='<h3 style="border-bottom: 0px;">Cargando</h3>';j+='<span aria-hidden="true" class="icon-refresh icon-spin" style="font-size: 50px;"></span>';j+="</div>";$("#carga").append(j);var i={noTarjeta:c,mes:h,anio:d};var b=$.param(i);$.ajax({url:base_url+"/transferencia/peGeneral",type:"post",data:{data:b,model:"historial_loadPe"},datatype:"JSON",success:function(n){switch(n.code){case 0:$("#carga").children().remove();$("#list-detail").children().remove();$.each(n.listaTransferenciasRealizadas,function(v,s){if(s.estatusOperacion==="1"){l="icon-ok-sign";g="feed-success";f="Procesado";k="Transferencia realizada"}else{l="icon-cancel-sign";g="feed-error";f="Rechazado";k="Transferencia rechazada"}e=(s.autorizado==="1")?'<div class="verified">Autorizada</div>':"";var q=s.fechaTransferencia.split(" ");var o=q[0].split("-");var u=o[2];var p;var r=$(".dashboard-item").attr("moneda");switch(o[1]){case"01":p="Ene";break;case"02":p="Feb";break;case"03":p="Mar";break;case"04":p="Abr";break;case"05":p="May";break;case"06":p="Jun";break;case"07":p="Jul";break;case"08":p="Ago";break;case"09":p="Sep";break;case"10":p="Oct";break;case"11":p="Nov";break;case"12":p="Dic";break}var t='<li class="feed-item '+g+'">';t+='<div class="feed-date">'+u+'<span class="feed-date-month">'+p+"</span></div>";t+='<div class="feed-status">';t+='<span aria-hidden="true" class="'+l+'" title="'+f+'"></span>';t+="</div>";t+=k+": "+s.beneficiario+'<span class="money-amount">'+e+'<div class="amount-history">'+r+" "+s.montoTransferencia+"</div> </span>";t+='<ul class="feed-metadata">';t+='<li class="feed-metadata-item"><span aria-hidden="true" class="icon-phone"></span>'+s.telefonoDestino+"</li>";t+='<li class="feed-metadata-item"><span aria-hidden="true" class="icon-card"></span>'+s.tarjetaDestinoMascara+"</li>";t+='<li class="feed-metadata-item"><span aria-hidden="true" class="icon-mail"></span>   '+s.concepto+"</li>";t+="</ul>";t+="</li>";$("#list-detail").append(t)});break;case 1:$(location).attr("href",base_url+"/users/error_gral");break;case 2:$("#carga").children().remove();var m='<div id="empty-state" style="position: static;">';m+="<h2>No se encontraron movimientos</h2>";m+="<p>Vuelva a realizar la búsqueda con un filtro distinto para obtener resultados.</p>";m+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -415px;"></span>';m+="</div>";$("#list-detail").append(m);break;default:msgService(n.title,n.msg,n.modalType,1);break}}})}$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(b,c){$(".ui-dialog-titlebar-close",c.dialog).hide()}});$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});function msgService(c,b,a,d){$("#registrar").fadeIn();$("#dialogo-movil").dialog({title:c,modal:"true",resizable:false,closeOnEscape:false,width:"440px",open:function(e,f){$(".ui-dialog-titlebar-close",f.dialog).hide();$("#modalType").addClass(a);$("#msgService").html(b)}});$("#inva5").click(function(){$("#dialogo-movil").dialog("close");if(d==1){$(location).attr("href",base_url+"/transferencia/HistorialPe")}})};