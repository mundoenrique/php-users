$(function(){operationType="P2P";var a=$("#montoLabel").val();$(".dialog").on("click",function(){modalCtasOrigen()});$("input:radio[name=tipoRef]").on("change",function(c){$("#msg-history").html("");var b=$("input:radio[name=tipoRef]:checked").val();if(b==1){$("#cardSelect").hide();$("#cardText").show();$("#telefonoDestino").attr("disabled",true);$("#form-trx").find("input, textarea, button, select").attr("disabled",false);$("#ctaDestino").addClass("ignore");$("#ctaDestinoText").removeClass("ignore");$("#telefonoDestino").val("");$("#search-cards").attr("disabled",true);$("#continuar").attr("disabled",false);$("#form-search").find("input, textarea, button, select").removeClass("field-error field-success")}else{$("#ctaDestino").removeClass("ignore");$("#ctaDestinoText").addClass("ignore");$("#cardSelect").show();$("#cardText").hide();$("#form-trx").find("input, textarea, button, select").attr("disabled",true);$("#form-search").find("input, textarea, button, select").attr("disabled",false);$("#ctaDestinoText").val("");$("#search-cards").attr("disabled",false);$("#continuar").attr("disabled",true);$("#form-trx")[0].reset();$("#form-trx").find("input, textarea, button, select").removeClass("field-error field-success")}});$(".dashboard-item").click(function(){var o,h,d,b,p,j,c,e,n,m,g;o=$(this).find("img").attr("src");h=$(this).attr("card");d=$(this).attr("marca").toLowerCase();b=$(this).attr("mascara");p=$(this).attr("producto1");j=$(this).attr("empresa");n=$(this).attr("nombre");pais=$(this).attr("pais");c=m=(pais=="Pe"||pais=="Usd")?"0.00":"0,00";$("#ctaOrigen").val(h);$("#donor").children().remove();e='<div class="product-presentation" producto="'+p+'">';e+='<img src="'+o+'" width="200" height="130" alt="" />';e+='<div class="product-network '+d.toLowerCase()+'"></div>';e+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" cardOrigen="'+h+'" />';e+="</div>";e+='<div class="product-info">';e+='<p class="product-cardholder" id="nombreCtaOrigen">'+n+"</p>";e+='<p class="product-cardnumber">'+b+"</p>";e+='<p class="product-metadata">'+p+"</p>";e+='<nav class="product-stack">';e+='<ul class="stack">';e+='<li class="stack-item">';e+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';e+="</li>";e+="</ul>";e+="</nav>";e+="</div>";e+='<div class="product-scheme">';e+='<ul class="product-balance-group" style="margin: 10px 0">';e+='<li>Disponible <span class="product-balance" id="balance-available">'+moneda+" "+m+"</span></li>";e+='<li>A debitar <span class="product-balance debitar" monto-transfer id="balance-debit">'+moneda+" "+c+"</span></li>";e+="</ul>";e+="<ul class='field-group'>";e+="<li class='field-group-item'>";e+="</li>";e+="</ul>";e+="</div>";$("#tipoRef").removeAttr("disabled");$("#tipoRef2").removeAttr("disabled");$("#telefonoDestino").removeAttr("disabled");$("#search-cards").removeAttr("disabled");$("#donor").append(e);$.post(base_url+"/dashboard/saldo",{tarjeta:$(this).attr("card")},function(q){var i=q.disponible;if(typeof i!="string"){i="---"}$("#balance-available").html(moneda+" "+i);$("#balance-available").attr("saldo",i)});$.each($(".dashboard-item"),function(q,i){if($(this).hasClass("current-dashboard-item")){$(this).removeClass("current-dashboard-item")}});$(this).addClass("current-dashboard-item");$("#content-product").dialog("close");var l=$(this).attr("card"),f=$(this).attr("prefix"),k="P2P"});$("#donor").on("click",".stack-item",function(){modalCtasOrigen()});$("#search-cards").on("click",function(){validar_campos();$("#form-search").submit();$("#form-search").valid()})});$("#continuar").on("click",function(){var b;var c=$("#continuar").attr("action");switch(c){case"form-confirm":b=$("#form-trx");break;case"form-trx":var e=($("#ctaDestinoText").val()==="")?$("#ctaDestino").val():$("#ctaDestinoText").val();var a={ctaOrigen:$("#donor-cardnumber-origen").attr("cardorigen"),ctaDestino:e,monto:$("#monto").val(),descripcion:$("#descripcion").val(),pin:""};var d=$.param(a);makeTransferPe(d);$("#progress > ul > li:nth-child(3)").addClass("current-step-item");break;case"form-pin":b=$("#form-pin");break}if(b!==""){validar_campos();b.submit();b.valid()}});function modalCtasOrigen(){$("#content-product").dialog({title:"Selecci√≥n de Cuentas Origen",modal:"true",width:"950px",open:function(a,b){$(".ui-dialog-titlebar-close",b.dialog).hide()}});$("#cerrar").click(function(){$("#content-product").dialog("close")})};