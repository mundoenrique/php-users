function modalCtasOrigen(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"950px",open:function(e,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#cerrar").click(function(){$("#content-product").dialog("close")})}function normaliza(e){for(var a="ÃÀÁÄÂÈÉËÊÌÍÏÎÒÓÖÔÙÚÜÛãàáäâèéëêìíïîòóöôùúüûÑñÇç",o="AAAAAEEEEIIIIOOOOUUUUaaaaaeeeeiiiioooouuuunncc",n=0;n<a.length;n++)e=e.replace(a.charAt(n),o.charAt(n));return e}function changeDecimals(e){var a;return a=e.toFixed(2),"Ve"!=pais&&"Co"!=pais||(a=a.replace(".",",")),a}function validar_campos(e){jQuery.validator.setDefaults({debug:!0,success:"valid"}),jQuery.validator.addMethod("tokenValid",function(e,a){var o=/^[a-zA-Z0-9]+$/,n=a.value;return!!o.test(n)}),jQuery.validator.addMethod("onlyLetters",function(e,a){var o=/^[A-Za-z0-9\s]+$/,n=a.value;return!!o.test(n)}),jQuery.validator.addMethod("amountAvailable",function(e,a){var o=parseFloat(a.value);return!(o>saldoVerifica)}),jQuery.validator.addMethod("amountsValue",function(e,a){var o=parseFloat(a.value);return!(o<montoMinOperaciones||o>=montoMaxOperaciones)}),jQuery.validator.addMethod("amountDay",function(e,a){var o=parseFloat(a.value),n=montoAcumDiario+o;return!(n>=montoMaxDiario)}),jQuery.validator.addMethod("amountWeek",function(e,a){var o=parseFloat(a.value),n=montoAcumSemanal+o;return!(n>=montoMaxSemanal)}),jQuery.validator.addMethod("amountMonth",function(e,a){var o=parseFloat(a.value),n=montoAcumMensual+o;return!(n>=montoMaxMensual)}),jQuery.validator.addMethod("trxDay",function(e,a){var o=acumCantidadOperacionesDiarias+1;return!(o>cantidadOperacionesDiarias)}),jQuery.validator.addMethod("trxWeek",function(e,a){var o=acumCantidadOperacionesSemanales+1;return!(o>cantidadOperacionesSemanales)}),jQuery.validator.addMethod("trxMonth",function(e,a){a.value;var o=acumCantidadOperacionesMensual+1;return!(o>cantidadOperacionesMensual)}),$("#form-search").validate({errorElement:"label",ignore:".ignore",errorContainer:"#msg-history",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg-history",rules:{telefonoDestino:{number:!0,required:!0,minlength:9,maxlength:9}},messages:{telefonoDestino:{required:"El número de teléfono no puede estar vacío",number:"El teléfono debe ser numérico y no debe tener caracteres especiales",minlength:"El número de teléfono debe tener un mínimo de 7 caracteres",maxlength:"El número de teléfono debe tener un máximo de 7 caracteres",numOnly:"El teléfono debe ser numérico y no debe tener caracteres especiales"}},submitHandler:function(e){var a={telefonoDestino:$("#telefonoDestino").val()},o=$.param(a),n=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),t=JSON.stringify({data:o,model:"AccountPhone"});t=CryptoJS.AES.encrypt(t,n,{format:CryptoJSAesJson}).toString(),$.ajax({url:base_url+"/transferencia/peGeneral",type:"post",data:{request:t,cpo_name:n,plot:btoa(n)},datatype:"JSON",beforeSend:function(e,a){cleanBefore($("#cargandoPhone"),$("#search-cards"))},success:function(e){switch(data=JSON.parse(CryptoJS.AES.decrypt(e.code,e.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),cleanComplete($("#cargandoPhone"),$("#search-cards")),data.code){case 0:$("select").empty(),$("#ctaDestino").append('<option value="" selected>Seleccione una cuenta</option>'),$.each(data.phone,function(e,a){$("#ctaDestino").append($("<option>",{value:a.noTarjeta,text:a.noTarjetaConMascara}))}),$("#form-trx").find("input, textarea, button, select").attr("disabled",!1),$("#continuar").attr("disabled",!1);break;case 1:$("#telefonoDestino").val(""),msgService(data.title,data.msg,"alert-warning",0)}}})}}),$("#form-trx").validate({errorElement:"label",ignore:".ignore",errorContainer:"#msg-history",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg-history",rules:{descripcion:{required:!0,minlength:4,maxlength:30,onlyLetters:!0},monto:{number:!0,required:!0,amountAvailable:!0,amountsValue:!0,amountDay:!0,amountWeek:!0,amountMonth:!0},ctaDestinoText:{number:!0,required:!0,minlength:16,maxlength:16},ctaDestino:{required:!0},opeMax:{required:!0,trxDay:!0,trxWeek:!0,trxMonth:!0}},messages:{descripcion:{required:"El campo descripción no puede estar vacio",minlength:"El campo descripción debe contener mínimo 4 caracteres",maxlength:"El campo descripción debe contener máximo 30 caracteres",onlyLetters:"Este campo no puede contener caracteres especiales."},opeMax:{trxDay:"Se ha superado la cantidad máxima de transacciones diarias, ha realizado: "+acumCantidadOperacionesDiarias+" transacciones",trxWeek:"Se ha superado la cantidad máxima de transacciones semanales, ha realizado: "+acumCantidadOperacionesSemanales+" transacciones",trxMonth:"Se ha superado la cantidad máxima de transacciones mensuales, ha realizado: "+acumCantidadOperacionesMensual+" transacciones"},monto:{required:"El campo monto no puede estar vacio",amountAvailable:"El monto de la transferencia excede su saldo disponible",number:"El campo monto debe ser numérico y no debe tener caracteres especiales",amountsValue:"El monto mínimo de la transacción debe ser "+moneda+". "+montoMinOperaciones+" y el máximo "+moneda+". "+montoMaxOperaciones,amountDay:"El monto máximo diario que puede transferir es: "+moneda+". "+montoMaxDiario+",  hoy a transferido: "+moneda+". "+montoAcumDiario,amountWeek:"El monto máximo semanal que puede transferir es: "+moneda+". "+montoMaxSemanal+", esta semana a transferido: "+moneda+". "+montoAcumSemanal,amountMonth:"El monto máximo mensual que puede transferir es: "+moneda+". "+montoMaxMensual+", este mes a transferido: "+moneda+". "+montoAcumMensual},ctaDestinoText:{required:"El campo tarjeta no puede estar vacio",number:"El campo tarjeta debe ser numérico y no debe tener caracteres especiales",minlength:"El campo tarjeta debe contener 16 dígitos",maxlength:"El campo tarjeta debe contener 16 dígitos"},ctaDestino:{required:"El campo tarjeta no puede estar vacio"}},submitHandler:function(e){$("#progress > ul > li\t:nth-child(2)").removeClass("current-step-item").addClass("completed-step-item");var a=""===$("#ctaDestinoText").val()?$("#ctaDestino").val():$("#ctaDestinoText").val(),o=a.substring(0,6),n=a.substring(12,16);a=o+"******"+n,$("#conDescripcion").html($("#descripcion").val()),$("#conMonto, #conMonto2").html($("#monto").val()),$("#conCtaOrigen").html($("#donor").find(".product-cardnumber").html()),$("#conCtaDestino").html(a),$("#progress > ul > li:nth-child(1)").addClass("completed-step-item"),$("#progress > ul > li:nth-child(2)").addClass("current-step-item"),$("#confirmTrxValues").show(),$("#transfer-date").hide(),$("#continuar").attr("action","form-trx")}}),$("#form-pin").validate({errorElement:"label",ignore:"",errorContainer:"#msg-history2",errorClass:"field-error",validClass:"field-success",errorLabelContainer:"#msg-history2",rules:{pin:{required:!0,tokenValid:!0}},messages:{pin:{required:"Debe colocar su código de seguridad",tokenValid:"El código de seguridad no puede tener caracteres especiales"}},submitHandler:function(e){var a=""===$("#ctaDestinoText").val()?$("#ctaDestino").val():$("#ctaDestinoText").val(),o={ctaOrigen:$("#ctaOrigen").val(),ctaDestino:a,monto:$("#monto").val(),descripcion:$("#descripcion").val(),pin:$("#pin").val()},n=$.param(o);makeTransferPe(n,1)}})}function makeTransferPe(e,a){var o=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),n=JSON.stringify({data:e,token:a});n=CryptoJS.AES.encrypt(n,o,{format:CryptoJSAesJson}).toString(),$.ajax({url:base_url+"/transfererencia/transferPe",type:"post",data:{request:n,cpo_name:o,plot:btoa(o)},dataType:"json",beforeSend:function(e,a){cleanBefore($("#cargandoInfo"),$("#continuar"))},success:function(e){switch(data=JSON.parse(CryptoJS.AES.decrypt(e.code,e.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),cleanComplete($("#cargandoInfo"),$("#continuar")),data.code){case 0:$("#progress > ul > li:nth-child(3)").removeClass("current-step-item").addClass("completed-step-item"),$("#transfer-date").hide(),$("#confirmTrxValues").hide(),$("#pinDiv").hide(),$("#confirmacion").show(),$("#conCtaOrigenTrx").html(data.ctaOrigenMascara),$("#conCtaDestinoTrx").html(data.ctaDestinoMascara),$("#montoConfirm").html(data.monto),$("#conNombreOrigen").html(data.nombreCuentaOrigen),$("#conNombreDestino").html(data.nombreCuentaDestino),$("#conDescripcionTrx").html(data.descripcion),$("#finalTrx").show(),$("#buttonTrx").hide();break;case 1:$("#pinDiv").show(),$("#transfer-date").hide(),$("#confirmTrxValues").hide(),$("#continuar").attr("action","form-pin"),$("#ctaOrigen").val(),$("#ctaDestino").val(),$("#monto").val(),$("#descripcion").val();break;case 2:$("#msgInfoPin").addClass("pinError"),$("#msgInfoPin").html("El PIN ingresado no coincide, verifique e intente nuevamente."),$("#pin").addClass("field-error").removeClass("field-success"),$("#pin").val("");break;case 3:msgService(data.title,data.msg,"alert-error",1);break;case 4:$(location).attr("href",base_url+"/users/error_gral");break;default:msgService(data.title,data.msg,"alert-error",1)}}})}function msgService(e,a,o,n){$("#registrar").fadeIn(),$("#dialogo-movil").dialog({title:e,modal:"true",resizable:!1,closeOnEscape:!1,draggable:!1,width:"440px",open:function(e,n){$(".ui-dialog-titlebar-close",n.dialog).hide(),$("#modalType").addClass(o),$("#msgService").html(a)}}),$("#inva5").click(function(){$("#dialogo-movil").dialog("close"),1==n&&$(location).attr("href",base_url+"/transferencia/pe")})}function cleanBefore(e,a){e.show(),a.hide()}function cleanComplete(e,a){e.hide(),a.show()}var base_url,base_cdn,ctasDestino,moneda,pais,editCard,totalTrans,saldoDisp,transferNumber,montoMinOperaciones,montoMaxOperaciones,montoAcumMensual,montoMaxMensual,montoAcumSemanal,montoMaxSemanal,montoAcumDiario,montoMaxDiario,acumCantidadOperacionesMensual,cantidadOperacionesMensual,acumCantidadOperacionesSemanales,cantidadOperacionesSemanales,acumCantidadOperacionesDiarias,cantidadOperacionesDiarias,montoComision,nameSource,maskSource,sourceNumber,brand,dobleAutenticacion,operationType,expDate,country,numberBeneficiary=[3,2,1],destination={};$("#cargandoInfo").hide(),$("#cargandoPhone").hide(),base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),country=$("body").data("country"),$(function(){$("#tabs-menu").show(),$("#content_plata").show(),moneda=$("#donor").attr("moneda"),$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")})});