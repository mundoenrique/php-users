var base_url,base_cdn,skin;base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),skin=$("body").attr("data-app-skin"),$(function(){var user,pass;function mostrarProcesando(skin){var imagen="";switch(skin){case"pichincha":imagen="loading-pichincha.gif";break;case"latodo":imagen="loading-latodo.gif"}$("#login").attr("disabled","true"),""==imagen?$("#login").html('<div id="loading" class="icono-load" style="display:flex; width:20px; margin:0 auto;"><span aria-hidden="true" class="icon-refresh icon-spin" style="font-size: 20px"></span></div>'):$("#login").html('<img src="'+base_cdn+"img/"+imagen+'">'),"pichincha"==skin&&($("#login").css({position:"relative",height:"35px",width:"100%",opacity:"1"}),$("#login").children(0).css({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:"25px"}))}function ocultarProcesando(){$("#login").html("Ingresar"),$("#login").prop("disabled",!1)}function validateCaptcha(token,user,pass){var cpo_cook=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),dataRequest=JSON.stringify({token:token,user:user});dataRequest=CryptoJS.AES.encrypt(dataRequest,cpo_cook,{format:CryptoJSAesJson}).toString(),$consulta=$.post(base_url+"/users/validateRecaptcha",{request:dataRequest,cpo_name:cpo_cook,plot:btoa(cpo_cook)}),$consulta.done(function(response){data=JSON.parse(CryptoJS.AES.decrypt(response.code,response.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),1==data.success&&parseFloat(data.score)>=parseFloat("0.7")?login(user,pass):(ocultarProcesando(),$("#dialog-validate").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#error-validate").click(function(){$("#dialog-validate").dialog("close"),habilitar()}))})}function login(user,pass){var hasCookie=navigator.cookieEnabled;if(!/^[\wñ]+$/i.test(user)||!/^[\w!@\*\-\?¡¿+\/.,#]+$/i.test(pass))return ocultarProcesando(),$("#dialog-login").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),void $("#invalido").click(function(){$("#dialog-login").dialog("close"),habilitar()});if(""!=user&&""!=pass&&hasCookie){$("#username").attr("disabled","true"),$("#userpwd").attr("disabled","true"),$(".ju-sliderbutton-text").html("Verificando..."),$(".ju-sliderbutton .ju-sliderbutton-slider .ui-slider-handle").hide(),mostrarProcesando(skin);var cpo_cook=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),dataRequest=JSON.stringify({user_name:user,user_pass:hex_md5(pass)});dataRequest=CryptoJS.AES.encrypt(dataRequest,cpo_cook,{format:CryptoJSAesJson}).toString(),$consulta=$.post(base_url+"/users/login",{request:dataRequest,cpo_name:cpo_cook,plot:btoa(cpo_cook)}),$consulta.done(function(response){data=JSON.parse(CryptoJS.AES.decrypt(response.code,response.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),1==data?$("#dialog-login-ve").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}):0==data.rc?1==data.passwordTemp?$(location).attr("href",base_url+"/users/cambiarPassword?t=t"):1==data.passwordVencido?$(location).attr("href",base_url+"/users/cambiarPassword?t=v"):$(location).attr("href",base_url+"/dashboard"):-1==data.rc?(ocultarProcesando(),$("#dialog-login").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#invalido").click(function(){$("#dialog-login").dialog("close"),habilitar()})):-5==data.rc?(ocultarProcesando(),$("#sesion-activa").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#activa").click(function(){$("#sesion-activa").dialog("close"),$(location).attr("href",base_url+"/users/closeSess"),habilitar()})):-194==data.rc?(ocultarProcesando(),$("#dialog-overlay").dialog({title:"Password Caducado",modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#caducado").click(function(){$("#dialog-overlay").dialog("close"),habilitar()})):-205==data.rc?(ocultarProcesando(),$("#dialog-voygo-error").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#error-voygo").click(function(){$("#dialog-voygo-error").dialog("close")})):-35==data.rc||-8==data.rc?(ocultarProcesando(),$("#dialog-bloq").dialog({modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#aceptar").click(function(){$("#dialog-bloq").dialog("close"),habilitar()})):(ocultarProcesando(),$("#dialog-error").dialog({title:"Error en el sistema",modal:"true",width:"440px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#error").click(function(){$("#dialog-error").dialog("close"),habilitar()}))})}else hasCookie?""!=user&&""!=pass||(""==user&&$("#username").addClass("field-error"),""==pass&&$("#userpwd").addClass("field-error")):$("<div><h5>La funcionalidad de cookies de su navegador se encuentra desactivada.</h5><h4>Por favor vuelva activarla.</h4></div>").dialog({title:"Conexion personas Online",modal:!0,maxWidth:700,maxHeight:300,resizable:!1,close:function(){$(this).dialog("destroy")},buttons:{Aceptar:function(){$(this).dialog("destroy")}}})}function habilitar(){$("#username").removeAttr("disabled"),$("#userpwd").removeAttr("disabled"),$(".ju-sliderbutton-text").html("Desliza para ingresar"),$(".ju-sliderbutton .ju-sliderbutton-slider .ui-slider-handle").show()}$("#slideUnlock").sliderbutton({text:"Desliza para ingresar",activate:function(){$("#username").removeAttr("class"),$("#userpwd").removeAttr("class"),$("#username").val($("#username").val().replace(/[ ]/g,"")),user=(user=$("#username").val()).toUpperCase(),pass=$("#userpwd").val(),$("#userpwd").val(""),login(user,pass)}}),$(".ui-slider-handle.ui-state-default.ui-corner-all").append('<a class="unlock-knob" title="Desliza para ingresar"><span aria-hidden="true" class="icon-arrow-right"></span></a>'),$("#login").click(function(){$("#username").removeAttr("class"),$("#userpwd").removeAttr("class"),$("#username").val($("#username").val().replace(/[ ]/g,"")),user=(user=$("#username").val()).toUpperCase(),pass=$("#userpwd").val(),grecaptcha.ready(function(){mostrarProcesando(skin),grecaptcha.execute("6LdRI6QUAAAAAEp5lA831CK33fEazexMFq8ggA4-",{action:"login"}).then(function(token){validateCaptcha(token,user,pass)})})}),$("#slideshow").click(function(){$("#content-product").dialog({modal:!0,buttons:{Ok:function(){$(this).dialog("close")}},open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}})}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({modal:"true",width:"940px",open:function(event,ui){$(".ui-dialog-titlebar-close",ui.dialog).hide()}}),$("#ok").click(function(){$("#dialog-tc").dialog("close")})})});