var base_url,base_cdn;base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),$(function(){function a(a,e,t){var r,i,n,s,o="Transferencia realizada";s='<div id ="loading" class="data-indicator" style="text-align: center;">',s+='<h3 style="border-bottom: 0px;">Cargando</h3>',s+='<span aria-hidden="true" class="icon-refresh icon-spin" style="font-size: 50px;"></span>',s+="</div>",$("#carga").append(s);var c=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1")),d=JSON.stringify({noTarjeta:a,tipoOperacion:"P2P",mes:e,anio:t});d=CryptoJS.AES.encrypt(d,c,{format:CryptoJSAesJson}).toString(),$.post(base_url+"/historial/historial",{request:d,cpo_name:c,plot:btoa(c)},function(a){if(data=JSON.parse(CryptoJS.AES.decrypt(a.code,a.plot,{format:CryptoJSAesJson}).toString(CryptoJS.enc.Utf8)),-61==data.rc&&$(location).attr("href",base_url+"/users/error_gral"),0==data.rc)$("#carga").children().remove(),$("#list-detail").children().remove(),$.each(data.listaTransferenciasRealizadas,function(a,e){"0"==e.estatusOperacion?(i="icon-ok-sign",n="feed-success",r="Procesado"):(i="icon-cancel-sign",n="feed-error",r="Rechazado");var t,s=e.fechaTransferencia.split("/"),c=s[0],d=$(".dashboard-item").attr("moneda");switch(s[1]){case"01":t="Ene";break;case"02":t="Feb";break;case"03":t="Mar";break;case"04":t="Abr";break;case"05":t="May";break;case"06":t="Jun";break;case"07":t="Jul";break;case"08":t="Ago";break;case"09":t="Sep";break;case"10":t="Oct";break;case"11":t="Nov";break;case"12":t="Dic"}var l='<li class="feed-item '+n+'">';l+='<div class="feed-date">'+c+'<span class="feed-date-month">'+t+"</span></div>",l+='<div class="feed-status">',l+='<span aria-hidden="true" class="'+i+'" title="'+r+'"></span>',l+="</div>",l+=o+": "+e.beneficiario+'<span class="money-amount"> '+d+" "+e.montoTransferencia+" </span>",l+='<ul class="feed-metadata">',l+='<li class="feed-metadata-item"><span aria-hidden="true" class="icon-info-sign"></span>'+e.referencia+"</li>",l+="</ul>",l+="</li>",$("#list-detail").append(l)});else{$("#carga").children().remove();var e='<div id="empty-state" style="position: static;">';e+="<h2>No se encontraron movimientos</h2>",e+="<p>Vuelva a realizar la búsqueda con un filtro distinto para obtener resultados.</p>",e+='<span aria-hidden="true" class="icon-cancel-sign" style="position: relative;right: -415px;"></span>',e+="</div>",$("#list-detail").append(e)}})}$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")}),$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")}),$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(a,e){$(".ui-dialog-titlebar-close",e.dialog).hide()}}),$("#cerrar").click(function(){$("#content-product").dialog("close")});var a=$("#dashboard-donor");a.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:!0}});var e=$("#filters-stack .option-set"),t=e.find("a");t.click(function(){var e=$(this);if(e.hasClass("selected"))return!1;var t=e.parents(".option-set");t.find(".selected").removeClass("selected"),e.addClass("selected");var r={},i=t.attr("data-option-key"),n=e.attr("data-option-value");return n="false"!==n&&n,r[i]=n,"layoutMode"===i&&"function"==typeof changeLayoutMode?changeLayoutMode(e,r):a.isotope(r),!1})}),$("li.stack-item a").click(function(){$(".stack").find(".current-stack-item").removeClass("current-stack-item"),$(this).parents("li").addClass("current-stack-item")}),$(".dashboard-item").click(function(){var e,t,r,i,n,s,o;e=$(this).find("img").attr("src"),t=$(this).attr("card"),r=$(this).attr("marca").toLowerCase(),i=$(this).attr("mascara"),n=$(this).attr("producto1"),$(this).attr("empresa"),o=$(this).attr("nombre"),$("#donor").children().remove(),s='<div class="product-presentation" producto="'+n+'">',s+='<img src="'+e+'" width="200" height="130" alt="" />',s+='<div class="product-network '+r+'"></div>',s+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" cardOrigen="'+t+'" />',s+="</div>",s+='<div class="product-info-full">',s+='<p class="product-cardholder" id="nombreCtaOrigen">'+o+"</p>",s+='<p class="product-cardnumber" id="mascara">'+i+"</p>",s+='<p class="product-metadata" id="marca">'+n+"</p>",s+='<nav class="product-stack">',s+='<ul class="stack">',s+='<li class="stack-item">',s+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>',s+="</li>",s+="</ul>",s+="</nav>",s+="</div>",$("#donor").append(s),$(".product-button").removeClass("disabled-button"),$("#agregarCuenta").attr("href","#"),$("#agregarCuenta").parents("li").removeClass("disabled-group-action-item"),$(this).addClass("current-dashboard-item"),$("#content-product").dialog("close");var c=$("#donor-cardnumber-origen").attr("cardorigen");mes=$("#filter-month").val(),anio=$("#filter-year").val(),$("#buscar").removeClass("disabled-button"),$("#list-detail").children().remove(),a(c,mes,anio),$(".stack-item").click(function(){$("#tdestino").children().remove(),$("#tdestino").append($("#removerDestino").html()),$("#botonContinuar").attr("disabled",!0),$("#content-product").dialog({title:"Selección de Cuentas Origen",modal:"true",width:"940px",open:function(a,e){$(".ui-dialog-titlebar-close",e.dialog).hide()}})})}),$("#content").on("click","#buscar",function(){var e=$("#donor-cardnumber-origen").attr("cardorigen");mes=$("#filter-month").val(),anio=$("#filter-year").val(),$("#list-detail").children().remove(),a(e,mes,anio)})});