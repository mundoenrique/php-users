var base_url,base_cdn,moneda,pais,viewControl="",bloqAction="Bloquear ";const operaciones={111:{id:"replace",icon:"spinner",msn:"Solicitud <br>de reposición"},112:{id:"key",icon:"key",msn:"Cambio <br>de PIN"},117:{id:"recover",icon:"key",msn:"Solicitud <br>de PIN"},110:{id:"lock",icon:"lock",msn:"Bloqueo de <br>cuenta"}};base_url=$("body").attr("data-app-url"),base_cdn=$("body").attr("data-app-cdn"),$(function(){$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")}),$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")}),$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({dialogClass:"cond-serv",modal:"true",width:"940px",draggable:!1,open:function(e,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$(".cond-serv").css("top","50px"),$("#ok").click(function(){$("#dialog-tc").dialog("close")})}),$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de cuenta",modal:"true",width:"940px",open:function(e,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}}),$("#cerrar").click(function(){$("#content-product").dialog("close")});var e=$("#dashboard-donor");e.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:!0}});var a=$("#filters-stack .option-set"),t=a.find("a");t.click(function(){var a=$(this);if(a.hasClass("selected"))return!1;var t=a.parents(".option-set");t.find(".selected").removeClass("selected"),a.addClass("selected");var o={},i=t.attr("data-option-key"),n=a.attr("data-option-value");return n="false"!==n&&n,o[i]=n,"layoutMode"===i&&"function"==typeof changeLayoutMode?changeLayoutMode(a,o):e.isotope(o),!1})}),$(".dashboard-item").click(function(){var e,a=$(this).find("img").attr("src"),t=$(this).attr("card"),o=$(this).attr("marca").toLowerCase(),i=$(this).attr("mascara"),n=$(this).attr("producto1"),r=($(this).attr("empresa"),$(this).attr("nombre")),c=($(this).attr("moneda"),$(this).attr("prefix")),s=$(this).attr("bloqueo"),l=($(this).attr("condition"),$(this).attr("fe")),d=!0,u='<p class="field-tip" style="margin-left: 10px;">Selecciona la operación que deseas realizar</p>',p=$(this).attr("permisos").split(",");for(var v in bloqAction="Bloquear ",pais=$(this).attr("pais"),u="Ve"==pais?"Haz click aquí para solicitar la reposición de PIN para acceso a operaciones en comercios y cajeros automáticos":u,u+='<ul class="product-balance-group services-content">',p.sort(),p){var m=$.extend({},operaciones[p[v]]);110==p[v]&&"PB"==s?(m.icon="unlock",m.msn="Desbloqueo<br> de cuenta",bloqAction="Desbloquear ",p.splice(p.indexOf("112"),1)):"N"!=s&&"PB"!=s&&(d=!1),u+='<li id="'+m.id+'" class="service-item-unselect"><span class="icon-'+m.icon+' services-item"></span>'+m.msn+"</li>"}u+="</ul>",1==d?($("#donor").children().remove(),e='<div class="product-presentation" producto="'+n+'">',e+='<img src="'+a+'" width="200" height="130" alt="" />',e+='<div class="product-network '+o+'"></div>',e+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" prefix="'+c+'" cardOrigen="'+t+'" stat-bloq="'+s+'" fe="'+l+'"/>',e+="</div>",e+='<div class="product-info">',e+='<p class="product-cardholder" id="nombreCtaOrigen">'+r+"</p>",e+='<p class="product-cardnumber">'+i+"</p>",e+='<p class="product-metadata">'+n+"</p>",e+='<nav class="product-stack">',e+='<ul class="stack">',e+='<li class="stack-item">',e+='<a dialog button product-button rel="section" title="Selecciona otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>',e+="</li>",e+="</ul>",e+="</nav>",e+="</div>",e+='<div class="product-scheme">',e+=u,e+="</div>",$("#donor").append(e)):notiSystem("Servicios","No es posible realizar esta acción, la tarjeta se encuentra bloqueada permanentemente","warning").delay(10),$("#content-product").dialog("close"),$(".stack-item").click(function(){viewControl="",$("#lock-acount").hide(),$("#change-key").hide(),$("#rec-key").hide(),$("#tdestino").children().remove(),$("#tdestino").append($("#removerDestino").html()),$("#continuar").prop("disabled",!0),$("#content-product").dialog({title:"Modificación de Cuentas",modal:"true",width:"940px",open:function(e,a){$(".ui-dialog-titlebar-close",a.dialog).hide()}})})}),$("#donor").on("click","#lock, #key, #replace, #recover",function(e){var a,t=e.target.id,o=e.target.parentNode.id;switch(a=t||o,a){case"lock":viewControl!=a&&""!=viewControl?notiSystem(bloqAction+"cuenta","¿Realmente deseas realizar esta acción?","warning","carry",a):viewSelect(a);break;case"key":viewControl!=a&&""!=viewControl?notiSystem("Cambio de PIN","¿Realmente deseas realizar esta acción?","warning","carry",a):viewSelect(a);break;case"replace":viewControl!=a&&""!=viewControl?notiSystem("Reposición de tarjeta","¿Realmente deseas realizar esta acción?","warning","carry",a):viewSelect(a);break;case"recover":viewControl!=a&&""!=viewControl?notiSystem("Recuperar cuenta","¿Realmente deseas realizar esta acción?","warning","carry",a):viewSelect(a)}}),$("#continuar").on("click",function(){var e,a,t,o,i,n,r,c=$("#continuar").attr("data-action"),s=$("#donor-cardnumber-origen").attr("fe"),l=$("#donor-cardnumber-origen").attr("cardorigen"),d=$("#donor-cardnumber-origen").attr("prefix");switch("changePin"!=c&&(e=$("#donor-cardnumber-origen").attr("stat-bloq"),a=$("#bloqueo-cuenta"),$("#fecha-exp-bloq").val(s),$("#card-bloq").val(l),$("#status").val(e),$("#prefix-bloq").val(d)),c){case"lockAccoun":$("#lock-type").val("temporary"),$("#prevent-bloq").hide(),r="LockAccount";break;case"changePin":o=$("#pin-current").val(),i=$("#new-pin").val(),$("#fecha-exp-cambio").val(s),$("#card-cambio").val(l),$("#pin-current-now").val(o),$("#new-pin-now").val(i),$("#prefix-cambio").val(d),a=$("#cambio-pin"),r="changePin";break;case"lockReplace":$("#lock-type").val("final"),n=$("#mot-sol").val(),$("#mot-sol-now").val(n),r="LockAccount";break;case"recoverKey":$("#rec-clave").hide(),$("#fecha-exp-rec").val(s),$("#card-rec").val(l),$("#prefix-rec").val(d),a=$("#recover-key"),r="recoverKey"}validar_campos();var u=decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)cpo_cook\s*\=\s*([^;]*).*$)|^.*$/,"$1"));$(a).append('<input type="hidden" name="cpo_name" class="ignore" value="'+u+'">'),a.submit(),1==a.valid()&&(t=a.serialize(),lock_change(t,r,a,c))})});