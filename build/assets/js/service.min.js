var base_url,base_cdn,viewControl="",bloqAction="Bloquear ",moneda,pais;const operaciones={"111":{id:"replace",icon:"spinner",msn:"Solicitud <br>de reposición"},"112":{id:"key",icon:"key",msn:"Cambio <br>de PIN"},"117":{id:"recover",icon:"key",msn:"Solicitud <br>de PIN"},"110":{id:"lock",icon:"lock",msn:"Bloquear <br>cuenta"}};base_url=$("body").attr("data-app-url");base_cdn=$("body").attr("data-app-cdn");$(function(){$(".transfers").hover(function(){$(".submenu-transfer").attr("style","display:block")},function(){$(".submenu-transfer").attr("style","display:none")});$(".user").hover(function(){$(".submenu-user").attr("style","display:block")},function(){$(".submenu-user").attr("style","display:none")});$(".label-inline").on("click","a",function(){$("#dialog-tc").dialog({dialogClass:"cond-serv",modal:"true",width:"940px",draggable:false,open:function(a,b){$(".ui-dialog-titlebar-close",b.dialog).hide()}});$(".cond-serv").css("top","50px");$("#ok").click(function(){$("#dialog-tc").dialog("close")})});$(".dialog").click(function(){$("#content-product").dialog({title:"Selección de Cuentas",modal:"true",width:"940px",open:function(d,e){$(".ui-dialog-titlebar-close",e.dialog).hide()}});$("#cerrar").click(function(){$("#content-product").dialog("close")});var b=$("#dashboard-donor");b.isotope({itemSelector:".dashboard-item",animationEngine:"jQuery",animationOptions:{duration:800,easing:"easeOutBack",queue:true}});var a=$("#filters-stack .option-set"),c=a.find("a");c.click(function(){var h=$(this);if(h.hasClass("selected")){return false}var f=h.parents(".option-set");f.find(".selected").removeClass("selected");h.addClass("selected");var d={},e=f.attr("data-option-key"),g=h.attr("data-option-value");g=g==="false"?false:g;d[e]=g;if(e==="layoutMode"&&typeof changeLayoutMode==="function"){changeLayoutMode(h,d)}else{b.isotope(d)}return false})});$(".dashboard-item").click(function(){var k=$(this).find("img").attr("src"),o=$(this).attr("card"),g=$(this).attr("marca").toLowerCase(),h=$(this).attr("mascara"),f=$(this).attr("producto1"),r=$(this).attr("empresa"),b=$(this).attr("nombre"),d=$(this).attr("moneda"),m=$(this).attr("prefix"),s=$(this).attr("bloqueo"),p=$(this).attr("condition"),l=$(this).attr("fe"),a=true,q,e='<p class="field-tip" style="margin-left: 10px;">Indique la operación que desea realizar</p>',c,n=$(this).attr("permisos").split(",");bloqAction="Bloquear ";pais=$(this).attr("pais");e=(pais=="Ve")?"Haga clic aquí para solicitar su reposición de PIN para acceso a operaciones en comercios y cajeros automáticos":e;e+='<ul class="product-balance-group services-content">';n.sort();for(var j in n){var i=Object.assign({},operaciones[n[j]]);if(n[j]==110&&s=="PB"){i.icon="unlock";i.msn="Desbloquear <br>cuenta";bloqAction="Desbloquear ";n.splice(n.indexOf("112"),1)}else{if(s!="N"&&s!="PB"){a=false}}e+='<li id="'+i.id+'" class="service-item-unselect"><span class="icon-'+i.icon+' services-item"></span>'+i.msn+"</li>"}e+="</ul>";if(a==true){$("#donor").children().remove();c='<div class="product-presentation" producto="'+f+'">';c+='<img src="'+k+'" width="200" height="130" alt="" />';c+='<div class="product-network '+g+'"></div>';c+='<input id="donor-cardnumber-origen" name="donor-cardnumber" type="hidden" prefix="'+m+'" cardOrigen="'+o+'" stat-bloq="'+s+'" fe="'+l+'"/>';c+="</div>";c+='<div class="product-info">';c+='<p class="product-cardholder" id="nombreCtaOrigen">'+b+"</p>";c+='<p class="product-cardnumber">'+h+"</p>";c+='<p class="product-metadata">'+f+"</p>";c+='<nav class="product-stack">';c+='<ul class="stack">';c+='<li class="stack-item">';c+='<a dialog button product-button rel="section" title="Seleccionar otra cuenta"><span aria-hidden="true" class="icon-edit"></span></a>';c+="</li>";c+="</ul>";c+="</nav>";c+="</div>";c+='<div class="product-scheme">';c+=e;c+="</div>";$("#donor").append(c)}else{notiSystem("Servicios","No es posible realizar esta acción, la tarjeta se encuentra bloqueada permanentemente","warning").delay(10)}$("#content-product").dialog("close");$(".stack-item").click(function(){viewControl="";$("#lock-acount").hide();$("#change-key").hide();$("#rec-key").hide();$("#tdestino").children().remove();$("#tdestino").append($("#removerDestino").html());$("#continuar").prop("disabled",true);$("#content-product").dialog({title:"Modificación de Cuentas",modal:"true",width:"940px",open:function(t,u){$(".ui-dialog-titlebar-close",u.dialog).hide()}})})});$("#donor").on("click","#lock, #key, #replace, #recover",function(b){var a=b.target.id,d=b.target.parentNode.id,c;c=(a)?a:d;switch(c){case"lock":(viewControl!=c&&viewControl!="")?notiSystem(bloqAction+"cuenta","¿Realmente desea realizar esta acción?","warning","carry",c):viewSelect(c);break;case"key":(viewControl!=c&&viewControl!="")?notiSystem("Cambio de PIN","¿Realmente desea realizar esta acción?","warning","carry",c):viewSelect(c);break;case"replace":(viewControl!=c&&viewControl!="")?notiSystem("Reposición de tarjeta","¿Realmente desea realizar esta acción?","warning","carry",c):viewSelect(c);break;case"recover":(viewControl!=c&&viewControl!="")?notiSystem("Recuperar cuenta","¿Realmente desea realizar esta acción?","warning","carry",c):viewSelect(c);break}});$("#continuar").on("click",function(){var e=$("#continuar").attr("data-action"),b=$("#donor-cardnumber-origen").attr("fe"),k=$("#donor-cardnumber-origen").attr("cardorigen"),h,i=$("#donor-cardnumber-origen").attr("prefix"),a,d,j,c,g,f;if(e!="changePin"){h=$("#donor-cardnumber-origen").attr("stat-bloq");a=$("#bloqueo-cuenta");$("#fecha-exp-bloq").val(b);$("#card-bloq").val(k);$("#status").val(h);$("#prefix-bloq").val(i)}switch(e){case"lockAccoun":$("#lock-type").val("temporary");$("#prevent-bloq").hide();f="LockAccount";break;case"changePin":j=$("#pin-current").val();c=$("#new-pin").val();$("#fecha-exp-cambio").val(b);$("#card-cambio").val(k);$("#pin-current-now").val(j);$("#new-pin-now").val(c);$("#prefix-cambio").val(i);a=$("#cambio-pin");f="changePin";break;case"lockReplace":$("#lock-type").val("final");g=$("#mot-sol").val();$("#mot-sol-now").val(g);f="LockAccount";break;case"recoverKey":$("#rec-clave").hide();$("#fecha-exp-rec").val(b);$("#card-rec").val(k);$("#prefix-rec").val(i);a=$("#recover-key");f="recoverKey";break}validar_campos();a.submit();if(a.valid()==true){d=a.serialize();lock_change(d,f,a,e)}})});